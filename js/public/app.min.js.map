{"version":3,"sources":["app.js","controllers/appcontroller.js","controllers/detailscontroller.js","controllers/listcontroller.js","controllers/settingscontroller.js","controllers/taskscontroller.js","directives/appnavigationentryutils.js","directives/autofocusoninsert.js","directives/avatar.js","directives/colorpickerDirective.js","directives/confirmation.js","directives/datepicker.js","directives/occlickfocus.js","directives/timepicker.js","directives/watchtop.js","filters/counterFormatter.js","filters/dateDetails.js","filters/dateDetailsShort.js","filters/dateFromNow.js","filters/dateTaskList.js","filters/day.js","filters/dayTaskList.js","filters/percentDetails.js","filters/priorityDetails.js","filters/reminderDetails.js","filters/startDetails.js","filters/timeTaskList.js","services/calendarservice.js","services/davclient.js","services/icalfactory.js","services/loading.js","services/model.js","services/persistence.js","services/publisher.js","services/randomstringservice.js","services/request.js","services/status.js","services/vtodoservice.js","services/businesslayer/listsbusinesslayer.js","services/businesslayer/searchbusinesslayer.js","services/businesslayer/settingsbusinesslayer.js","services/businesslayer/tasksbusinesslayer.js","services/models/calendar.js","services/models/collectionsmodel.js","services/models/listsmodel.js","services/models/settingsmodel.js","services/models/tasksmodel.js","services/models/vtodo.js"],"names":["$","oc_requesttoken","undefined","config","$provide","$routeProvider","$interpolateProvider","$httpProvider","value","defaults","headers","common","requesttoken","when","otherwise","_update","run","$document","$rootScope","Config","$timeout","TasksBusinessLayer","ListsBusinessLayer","SearchBusinessLayer","timeOutUpdate","init","taskUpdateInterval","OCA","Search","tasks","moment","locale","event","calendar","$broadcast","sameDay","lastWeek","t","nextWeek","sameElse","diff","this","m","mm","h","hh","d","dd","M","MM","y","yy","AppController","controller","$scope","$route","status","$location","$routeParams","Loading","SettingsModel","Persistence","_$listsbusinesslayer","_$route","_$scope","_$status","_$timeout","_$location","_$routeparams","_Loading","_$settingsmodel","_persistence","newListName","settingsmodel","then","Promise","results","all","target","listparameter","length","route","calendarID","is","$event","closest","angular","isUndefined","path","collectionID","focusTaskInput","addingList","addSubtaskTo","isLoading","DetailsController","$window","TasksModel","ListsModel","_$window","_$tasksmodel","_tasksbusinesslayer","_$listsmodel","task","getById","taskID","getByUri","cats","categories","found","add","id","isAddingComment","names","timers","durations","name","loadTask","TaskState","related","params","invert","slice","start","deleteTask","$apply","editName","writable","setEditRoute","currentTarget","initDueDate","initStartDate","initReminder","endEdit","resetRoute","keyCode","type","deletePercent","deleteReminder","deleteReminderDate","toggleCompleted","setPercentComplete","toggleStarred","complete","setPriority","isDue","date","isOverDue","overdue","setstartday","setstarttime","setStart","deleteStartDate","setdueday","setduetime","setDue","deleteDueDate","isAllDayPossible","toggleAllDay","setAllDay","allDay","due","setreminderday","setremindertime","setReminderDate","reminderType","reminder","isValid","setReminder","addComment","comment","CommentContent","tmpID","time","Date","now","data","sendComment","deleteComment","commentStrings","commentID","input","button","addCategory","default_categories","indexOf","category","model","doUpdate","push","removeCategory","ListController","CollectionsModel","CalendarService","_$routeParams","_$tasksbusinesslayer","_$collectionsmodel","_$searchbusinesslayer","_$calendarservice","collections","draggedTasks","nameError","getAll","color","deleteMessage","replace","displayname","getStandardList","uri","startCreate","tooltip","isAddingList","startEdit","prepareUpdate","download","url","open","checkNew","checkEdit","cancelEdit","checkName","allowed","$input","isNameAllowed","check","preventDefault","msg","placement","trigger","$on","s","calendarUri","resetToPreviousState","saveEdit","rename","isNameAlreadyTaken","getCount","filter","hideCollection","collection","show","getFilter","dragoverList","listID","index","attr","dropList","item","changeCalendar","dragoverCollection","effectAllowed","dataTransfer","ctrlKey","dropCollection","changeCollection","dropEffect","SettingsController","Status","SettingsBusinessLayer","_$settingsbusinesslayer","collectionOptions","getStatus","startOfWeekOptions","setVisibility","setStartOfWeek","set","__indexOf","i","l","module","TasksController","_settingsbusinesslayer","_searchbusinesslayer","VTodo","vtodo","_vtodo","calendars","days","isAddingTask","focusInputField","addTask","taskName","_ref","parent","summary","priority","completed","note","startOf","format","openDetails","focusSubtaskInput","subtaskName","getAddString","isDefined","showSubtaskInput","taskname","hideSubtasks","uid","descendantIDs","loadedCompleted","toggle","filterTasks","getSubTasks","_i","_len","hideCompletedSubtasks","ret","hasNoParent","hasCompletedSubtasks","toggleSubtasks","toggleCompletedSubtasks","filterTasksByString","filteredTasks","dayHasEntry","taskAtDay","day","filterLists","getCountString","checkTaskInput","setLoadedCompleted","sortDue","sortStart","sortOrder","getSortOrderIcon","order","sortDirection","dropAsSubtask","parentID","changeParent","removeClass","newCalendar","queries","makeRootTask","children","addClass","allow","dragStart","dragEnd","directive","elm","find","menu","toggleClass","scope","focus","avatar","userid","$observe","size","saturation","hue","isArray","lightness","huePrime","red","chroma","Math","abs","floor","blue","secondComponent","green","lightnessAdjustment","rgbToHex","round","r","g","b","Array","listofcolours","toString","parseInt","randColour","String","random","hslToRgb","toHsl","prototype","forEach","hsl","hash","hslcolour","restrict","templateUrl","filePath","colors","selected","element","randomizeColour","pick","confirmationFunction","confirmationMessage","ConfirmationController","$element","$attrs","$compile","countdown","message","hasClass","stopPropagation","activate","bind","e","html","documentClick","unbind","onSelect","datepicker","inst","beforeShow","marginLeft","outerWidth","dp","css","margin-left","left","startOfWeek","minDate","options","selector","click","timeout","timepicker","atPosition","myPosition","minuteText","hourText","$watch","divTop","prev","outerHeight","count","isDate","fromNow","percent","string","ds","duration","token","_this","service","DavClient","Calendar","discoverHome","callback","propFind","buildUrl","OC","linkToRemoteBase","NS_DAV","requestToken","response","props","propStat","wasRequestSuccessful","textContent","_currentUserPrincipal","NS_IETF","body","properties","_CALENDAR_HOME","split","_PROPERTIES","NS_APPLE","NS_OWNCLOUD","responseCode","getResponseCodeFromHTTPResponse","doesSupportVTodo","components","attributes","getNamedItem","j","toLowerCase","get","href","substr","create","document","cMkcalendar","setAttribute","createDocument","createElement","xmlDoc","appendChild","dProp","dSet","_createXMLForProperty","outerHTML","_suggestUri","request","enabled","_takenUrls","update","dPropUpdate","updatedProperties","resetUpdatedProperties","delete","oShare","shareType","shareWith","existingShare","implementation","oSet","dHref","Share","SHARE_TYPE_USER","SHARE_TYPE_GROUP","oSummary","owner","oRW","Content-Type","users","sharedWith","oRemove","user","groups","propName","oEnabled","dDisplayname","aOrder","aColor","cComponents","cComp","toUpperCase","acl","canWrite","getElementsByTagNameNS","k","writeNode","_isUriAlreadyTaken","lastPart","positionLastDash","match","firstPart","client","xmlNamespaces","dav","Client","linkToRemote","DAV:","urn:ietf:params:xml:ns:caldav","http://apple.com/ns/ical/","http://owncloud.org/ns","http://nextcloud.com/ns","NS_NEXTCLOUD","NS_CALENDARSERVER","location","protocol","window","host","root","updatePropertyWithValue","version","factory","decrease","Model","_dataMap","_filterCache","_data","_results","clearCache","_invalidateCache","entry","key","removeById","counter","splice","query","hashCode","exec","Request","$q","_$rootScope","_CalendarService","deferred","defer","successCallback","getCollections","getSettings","resolve","successCallbackWrapper","onSuccess","showLoading","failureCallbackWrapper","_request","onFailure","visibility","routeParams","setting","post","Publisher","_subscriptions","subscribeObjectTo","object","base","publishDataTo","ref","subscriber","handle","generate","$http","publisher","initialized","shelvedRequests","_executeShelvedRequests","defaultConfig","defaultData","extend","method","catch","put","_shelveRequest","RandomStringService","cCalQuery","dGetEtag","cCalendarData","cFilter","cCompFilterVCal","cCompFilterVTodo","cPropFilterCompleted","cIsNotDefined","cTextMatch","cPropFilterRelated","cTextMatchValue","createTextNode","Depth","vTodos","lastIndexOf","vTodo","{urn:ietf:params:xml:ns:caldav}calendar-data","{DAV:}getetag","xhr","getResponseHeader","returnTodo","_generateRandomUri","console","log","cancel","etag","__bind","fn","me","setFilter","attach","initialize","_$searchString","search","setRenderer","result","renderTaskResult","$row","$template","calendarid","isLoaded","clone","append","text","width","background-color","getColor","success","updateModel","VTodoService","_$vtodoservice","_$vtodo","ad","getTask","uncompleteParents","percentComplete","triggerUpdate","completeChildren","child","getChildren","getByUid","setHideSubtasks","hide","setHideCompletedSubtasks","momentToICALTime","asDate","ICAL","Time","fromDateString","reference","isAfter","olddue","year","month","hour","minute","isBefore","isSame","subtract","oldstart","checkReminderDate","second","p","newreminder","reminderdate","action","rel","seg","week","secondsToSegments","w","newTask","newVTodo","requests","$filter","vjournal","vevent","shareable","_updatedProperties","_properties","hasOwnProperty","shares","access","readWrite","startsWith","origin","_setUpdated","c","regex","_generateTextColor","_propertiesBackup","copy","dropPreviousState","toggleSharesEditor","list","brightness","editingShares","__hasProp","call","__extends","ctor","constructor","_Model","__super__","_super","_nameCache","updateByUri","tmplist","_tmpIdCache","calendarcolor","getName","removeByList","_len1","taskIDs","_j","startdiff","duediff","getDescendantIDs","concat","current","today","needle","ancestors","objectExists","getAncestor","re","keys","_ref1","comments","updateComment","com","icalfactory","loaded","jCal","Component","getAllSubcomponents","getFirstPropertyValue","updateLastModified","vtodos","removeProperty","completed_date","toJSDate","comp","getFirstProperty","getValues","setValues","prop","Property","addProperty","addSubcomponent"],"mappings":"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","file":"app.min.js","sourcesContent":["'use strict';\n\nangular.module('Tasks', ['ngRoute', 'ngAnimate', 'ui.select', 'ngSanitize', 'dndLists']).config(['$provide', '$routeProvider', '$interpolateProvider', '$httpProvider', function ($provide, $routeProvider, $interpolateProvider, $httpProvider) {\n\t'use strict';\n\n\tvar config;\n\t$provide.value('Config', config = {\n\t\tmarkReadTimeout: 500,\n\t\ttaskUpdateInterval: 1000 * 600\n\t});\n\t$httpProvider.defaults.headers.common.requesttoken = oc_requesttoken;\n\t$routeProvider.when('/calendars/:calendarID', {}).when('/calendars/:calendarID/edit/:listparameter', {}).when('/calendars/:calendarID/tasks/:taskID', {}).when('/calendars/:calendarID/tasks/:taskID/settings', {}).when('/calendars/:calendarID/tasks/:taskID/edit/:parameter', {}).when('/collections/:collectionID/tasks/:taskID', {}).when('/collections/:collectionID/tasks/:taskID/settings', {}).when('/collections/:collectionID/tasks/:taskID/edit/:parameter', {}).when('/collections/:collectionID', {}).when('/search/:searchString', {}).when('/search/:searchString/tasks/:taskID', {}).when('/search/:searchString/tasks/:taskID/edit/:parameter', {}).otherwise({\n\t\tredirectTo: '/collections/all'\n\t});\n}]);\n\nangular.module('Tasks').run(['$document', '$rootScope', 'Config', '$timeout', 'ListsBusinessLayer', 'TasksBusinessLayer', 'SearchBusinessLayer', function ($document, $rootScope, Config, $timeout, TasksBusinessLayer, ListsBusinessLayer, SearchBusinessLayer) {\n\t'use strict';\n\n\tvar _update;\n\tvar init = false;\n\t(_update = function update() {\n\t\tvar timeOutUpdate;\n\t\ttimeOutUpdate = function timeOutUpdate() {\n\t\t\treturn $timeout(_update, Config.taskUpdateInterval);\n\t\t};\n\t\tinit = true;\n\t\treturn timeOutUpdate();\n\t}).call();\n\tOCA.Search.tasks = SearchBusinessLayer;\n\t$document.click(function (event) {\n\t\t$rootScope.$broadcast('documentClicked', event);\n\t});\n\tmoment.locale('details', {\n\t\tcalendar: {\n\t\t\tlastDay: '[' + t('tasks', 'Due yesterday') + '], HH:mm',\n\t\t\tsameDay: '[' + t('tasks', 'Due today') + '], HH:mm',\n\t\t\tnextDay: '[' + t('tasks', 'Due tomorrow') + '], HH:mm',\n\t\t\tlastWeek: '[' + t('tasks', 'Due on') + '] MMM DD, YYYY, HH:mm',\n\t\t\tnextWeek: '[' + t('tasks', 'Due on') + '] MMM DD, YYYY, HH:mm',\n\t\t\tsameElse: '[' + t('tasks', 'Due on') + '] MMM DD, YYYY, HH:mm'\n\t\t}\n\t});\n\tmoment.locale('details_allday', {\n\t\tcalendar: {\n\t\t\tlastDay: '[' + t('tasks', 'Due yesterday') + ']',\n\t\t\tsameDay: '[' + t('tasks', 'Due today') + ']',\n\t\t\tnextDay: '[' + t('tasks', 'Due tomorrow') + ']',\n\t\t\tlastWeek: '[' + t('tasks', 'Due on') + '] MMM DD, YYYY',\n\t\t\tnextWeek: '[' + t('tasks', 'Due on') + '] MMM DD, YYYY',\n\t\t\tsameElse: '[' + t('tasks', 'Due on') + '] MMM DD, YYYY'\n\t\t}\n\t});\n\tmoment.locale('start', {\n\t\tcalendar: {\n\t\t\tlastDay: '[' + t('tasks', 'Started yesterday') + '], HH:mm',\n\t\t\tsameDay: '[' + t('tasks', 'Starts today') + '], HH:mm',\n\t\t\tnextDay: '[' + t('tasks', 'Starts tomorrow') + '], HH:mm',\n\t\t\tlastWeek: '[' + t('tasks', 'Started on') + '] MMM DD, YYYY, HH:mm',\n\t\t\tnextWeek: '[' + t('tasks', 'Starts on') + '] MMM DD, YYYY, HH:mm',\n\t\t\tsameElse: function sameElse() {\n\t\t\t\tif (this.diff(moment()) > 0) {\n\t\t\t\t\treturn '[' + t('tasks', 'Starts on') + '] MMM DD, YYYY, HH:mm';\n\t\t\t\t} else {\n\t\t\t\t\treturn '[' + t('tasks', 'Started on') + '] MMM DD, YYYY, HH:mm';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\tmoment.locale('start_allday', {\n\t\tcalendar: {\n\t\t\tlastDay: '[' + t('tasks', 'Started yesterday') + ']',\n\t\t\tsameDay: '[' + t('tasks', 'Starts today') + ']',\n\t\t\tnextDay: '[' + t('tasks', 'Starts tomorrow') + ']',\n\t\t\tlastWeek: '[' + t('tasks', 'Started on') + '] MMM DD, YYYY',\n\t\t\tnextWeek: '[' + t('tasks', 'Starts on') + '] MMM DD, YYYY',\n\t\t\tsameElse: function sameElse() {\n\t\t\t\tif (this.diff(moment()) > 0) {\n\t\t\t\t\treturn '[' + t('tasks', 'Starts on') + '] MMM DD, YYYY';\n\t\t\t\t} else {\n\t\t\t\t\treturn '[' + t('tasks', 'Started on') + '] MMM DD, YYYY';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\tmoment.locale('reminder', {\n\t\tcalendar: {\n\t\t\tlastDay: t('tasks', '[Remind me yesterday at ]HH:mm'),\n\t\t\tsameDay: t('tasks', '[Remind me today at ]HH:mm'),\n\t\t\tnextDay: t('tasks', '[Remind me tomorrow at ]HH:mm'),\n\t\t\tlastWeek: t('tasks', '[Remind me on ]MMM DD, YYYY,[ at ]HH:mm'),\n\t\t\tnextWeek: t('tasks', '[Remind me on ]MMM DD, YYYY,[ at ]HH:mm'),\n\t\t\tsameElse: t('tasks', '[Remind me on ]MMM DD, YYYY,[ at ]HH:mm')\n\t\t}\n\t});\n\tmoment.locale('tasks', {\n\t\tcalendar: {\n\t\t\tlastDay: '[' + t('tasks', 'Yesterday') + ']',\n\t\t\tsameDay: '[' + t('tasks', 'Today') + ']',\n\t\t\tnextDay: '[' + t('tasks', 'Tomorrow') + ']',\n\t\t\tlastWeek: 'DD.MM.YYYY',\n\t\t\tnextWeek: 'DD.MM.YYYY',\n\t\t\tsameElse: 'DD.MM.YYYY'\n\t\t}\n\t});\n\tmoment.locale('details_short', {\n\t\tcalendar: {\n\t\t\tlastDay: '[' + t('tasks', 'Yesterday') + ']',\n\t\t\tsameDay: '[' + t('tasks', 'Today') + ']',\n\t\t\tnextDay: '[' + t('tasks', 'Tomorrow') + ']',\n\t\t\tlastWeek: 'MMM DD, YYYY',\n\t\t\tnextWeek: 'MMM DD, YYYY',\n\t\t\tsameElse: 'MMM DD, YYYY'\n\t\t}\n\t});\n\tmoment.locale('list_week', {\n\t\tcalendar: {\n\t\t\tlastDay: '[' + t('tasks', 'Yesterday') + ']',\n\t\t\tsameDay: '[' + t('tasks', 'Today') + '], MMM. DD',\n\t\t\tnextDay: '[' + t('tasks', 'Tomorrow') + '], MMM. DD',\n\t\t\tlastWeek: 'ddd, MMM. DD',\n\t\t\tnextWeek: 'ddd, MMM. DD',\n\t\t\tsameElse: 'ddd, MMM. DD'\n\t\t}\n\t});\n\treturn moment.locale('en', {\n\t\trelativeTime: {\n\t\t\tfuture: t('tasks', \"in %s\"),\n\t\t\tpast: t('tasks', \"%s ago\"),\n\t\t\ts: t('tasks', \"seconds\"),\n\t\t\tm: t('tasks', \"a minute\"),\n\t\t\tmm: t('tasks', \"%d minutes\"),\n\t\t\th: t('tasks', \"an hour\"),\n\t\t\thh: t('tasks', \"%d hours\"),\n\t\t\td: t('tasks', \"a day\"),\n\t\t\tdd: t('tasks', \"%d days\"),\n\t\t\tM: t('tasks', \"a month\"),\n\t\t\tMM: t('tasks', \"%d months\"),\n\t\t\ty: t('tasks', \"a year\"),\n\t\t\tyy: t('tasks', \"%d years\")\n\t\t}\n\t});\n}]);","'use strict';\n\nangular.module('Tasks').controller('AppController', ['$scope', '$rootScope', 'ListsBusinessLayer', '$route', 'Status', '$timeout', '$location', '$routeParams', 'Loading', 'SettingsModel', 'Persistence', function ($scope, $rootScope, ListsBusinessLayer, $route, status, $timeout, $location, $routeParams, Loading, SettingsModel, Persistence) {\n\t'use strict';\n\n\tvar AppController = function () {\n\t\tfunction AppController(_$scope, $rootScope, _$listsbusinesslayer, _$route, _$status, _$timeout, _$location, _$routeparams, _Loading, _$settingsmodel, _persistence) {\n\t\t\tthis._$scope = _$scope;\n\t\t\tthis._$listsbusinesslayer = _$listsbusinesslayer;\n\t\t\tthis._$route = _$route;\n\t\t\tthis._$status = _$status;\n\t\t\tthis._$timeout = _$timeout;\n\t\t\tthis._$location = _$location;\n\t\t\tthis._$routeparams = _$routeparams;\n\t\t\tthis._Loading = _Loading;\n\t\t\tthis._$settingsmodel = _$settingsmodel;\n\t\t\tthis._persistence = _persistence;\n\t\t\tthis._$scope.status = this._$status.getStatus();\n\t\t\tthis._$scope.route = this._$routeparams;\n\t\t\tthis._$scope.status.newListName = \"\";\n\t\t\tthis._$scope.settingsmodel = this._$settingsmodel;\n\n\t\t\tthis._$listsbusinesslayer.init().then(function (results) {\n\t\t\t\tPromise.all(results).then(function () {\n\t\t\t\t\t$scope.$apply();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis._persistence.init();\n\n\t\t\tthis._$scope.closeAll = function ($event) {\n\t\t\t\tif ($($event.target).closest('.close-all').length || $($event.currentTarget).is($($event.target).closest('.handler'))) {\n\t\t\t\t\tif (!angular.isUndefined(_$scope.route.calendarID)) {\n\t\t\t\t\t\tif (_$scope.route.listparameter === 'name') {\n\t\t\t\t\t\t\t$rootScope.$broadcast('cancelEditCalendar', _$scope.route.calendarID);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_$location.path('/calendars/' + _$scope.route.calendarID);\n\t\t\t\t\t} else if (!angular.isUndefined(_$scope.route.collectionID)) {\n\t\t\t\t\t\t_$location.path('/collections/' + _$scope.route.collectionID);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_$location.path('/collections/all');\n\t\t\t\t\t}\n\t\t\t\t\t_$scope.status.addingList = false;\n\t\t\t\t\t_$scope.status.focusTaskInput = false;\n\t\t\t\t\t_$scope.status.newListName = \"\";\n\t\t\t\t}\n\t\t\t\tif (!$($event.target).closest('.newList').length) {\n\t\t\t\t\t_$scope.status.addingList = false;\n\t\t\t\t\t_$scope.status.newListName = \"\";\n\t\t\t\t}\n\t\t\t\tif (!$($event.target).closest('.add-subtask').length) {\n\t\t\t\t\t_$scope.status.addSubtaskTo = null;\n\t\t\t\t\t_$scope.status.focusSubtaskInput = false;\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.isLoading = function () {\n\t\t\t\treturn _Loading.isLoading();\n\t\t\t};\n\t\t}\n\t\treturn AppController;\n\t}();\n\treturn new AppController($scope, $rootScope, ListsBusinessLayer, $route, status, $timeout, $location, $routeParams, Loading, SettingsModel, Persistence);\n}]);","'use strict';\n\nangular.module('Tasks').controller('DetailsController', ['$scope', '$window', 'TasksModel', 'TasksBusinessLayer', '$route', '$location', '$timeout', '$routeParams', 'SettingsModel', 'Loading', 'ListsModel', function ($scope, $window, TasksModel, TasksBusinessLayer, $route, $location, $timeout, $routeParams, SettingsModel, Loading, ListsModel) {\n\t'use strict';\n\n\tvar DetailsController = function () {\n\t\tfunction DetailsController(_$scope, _$window, _$tasksmodel, _tasksbusinesslayer, _$route, _$location, _$timeout, _$routeparams, _$settingsmodel, _Loading, _$listsmodel) {\n\t\t\tthis._$scope = _$scope;\n\t\t\tthis._$window = _$window;\n\t\t\tthis._$tasksmodel = _$tasksmodel;\n\t\t\tthis._$listsmodel = _$listsmodel;\n\t\t\tthis._tasksbusinesslayer = _tasksbusinesslayer;\n\t\t\tthis._$route = _$route;\n\t\t\tthis._$location = _$location;\n\t\t\tthis._$timeout = _$timeout;\n\t\t\tthis._$routeparams = _$routeparams;\n\t\t\tthis._$settingsmodel = _$settingsmodel;\n\t\t\tthis._Loading = _Loading;\n\t\t\tthis._$scope.task = _$tasksmodel.getById(_$scope.route.taskID);\n\t\t\tthis._$scope.found = true;\n\t\t\tthis._$scope.$on('$routeChangeSuccess', function () {\n\t\t\t\tvar task = _$tasksmodel.getByUri(_$scope.route.taskID);\n\n\t\t\t\tif (!(angular.isUndefined(task) || task === null)) {\n\t\t\t\t\t_$scope.task = task;\n\t\t\t\t\t// Bind categories to task.cats as angular.ui/ui-select seems to have problems with Getter/Setter\n\t\t\t\t\t_$scope.task.cats = task.categories;\n\t\t\t\t\t_$scope.found = true;\n\t\t\t\t} else if (_$scope.route.taskID !== void 0) {\n\t\t\t\t\t_$scope.found = false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis._$scope.settingsmodel = this._$settingsmodel;\n\t\t\tthis._$scope.settingsmodel.add({\n\t\t\t\t'id': 'various',\n\t\t\t\t'categories': []\n\t\t\t});\n\t\t\tthis._$scope.isAddingComment = false;\n\t\t\tthis._$scope.timers = [];\n\t\t\tthis._$scope.durations = [{\n\t\t\t\tname: t('tasks', 'week'),\n\t\t\t\tnames: t('tasks', 'weeks'),\n\t\t\t\tid: 'week'\n\t\t\t}, {\n\t\t\t\tname: t('tasks', 'day'),\n\t\t\t\tnames: t('tasks', 'days'),\n\t\t\t\tid: 'day'\n\t\t\t}, {\n\t\t\t\tname: t('tasks', 'hour'),\n\t\t\t\tnames: t('tasks', 'hours'),\n\t\t\t\tid: 'hour'\n\t\t\t}, {\n\t\t\t\tname: t('tasks', 'minute'),\n\t\t\t\tnames: t('tasks', 'minutes'),\n\t\t\t\tid: 'minute'\n\t\t\t}, {\n\t\t\t\tname: t('tasks', 'second'),\n\t\t\t\tnames: t('tasks', 'seconds'),\n\t\t\t\tid: 'second'\n\t\t\t}];\n\t\t\tthis._$scope.loadTask = function (taskID) {\n\t\t\t\tvar task = _$tasksmodel.getByUri(_$scope.route.taskID);\n\t\t\t\tif (!(angular.isUndefined(task) || task === null)) {\n\t\t\t\t\t_$scope.task = task;\n\t\t\t\t\t_$scope.found = true;\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.TaskState = function () {\n\t\t\t\tif (_$scope.found) {\n\t\t\t\t\treturn 'found';\n\t\t\t\t} else {\n\t\t\t\t\tif (_Loading.isLoading()) {\n\t\t\t\t\t\treturn 'loading';\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.params = [{\n\t\t\t\tname: t('tasks', 'before beginning'),\n\t\t\t\tinvert: true,\n\t\t\t\trelated: 'START',\n\t\t\t\tid: \"10\"\n\t\t\t}, {\n\t\t\t\tname: t('tasks', 'after beginning'),\n\t\t\t\tinvert: false,\n\t\t\t\trelated: 'START',\n\t\t\t\tid: \"00\"\n\t\t\t}, {\n\t\t\t\tname: t('tasks', 'before end'),\n\t\t\t\tinvert: true,\n\t\t\t\trelated: 'END',\n\t\t\t\tid: \"11\"\n\t\t\t}, {\n\t\t\t\tname: t('tasks', 'after end'),\n\t\t\t\tinvert: false,\n\t\t\t\trelated: 'END',\n\t\t\t\tid: \"01\"\n\t\t\t}];\n\t\t\tthis._$scope.filterParams = function (params) {\n\t\t\t\tvar task;\n\t\t\t\ttask = _$tasksmodel.getById(_$scope.route.taskID);\n\t\t\t\tif (!(angular.isUndefined(task) || task === null)) {\n\t\t\t\t\tif (task.due && task.start) {\n\t\t\t\t\t\treturn params;\n\t\t\t\t\t} else if (task.start) {\n\t\t\t\t\t\treturn params.slice(0, 2);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn params.slice(2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.deleteTask = function (task) {\n\t\t\t\treturn _$timeout(function () {\n\t\t\t\t\treturn _tasksbusinesslayer.deleteTask(task).then(function () {\n\t\t\t\t\t\treturn $scope.$apply();\n\t\t\t\t\t});\n\t\t\t\t}, 500);\n\t\t\t};\n\t\t\tthis._$scope.triggerUpdate = function (task) {\n\t\t\t\t_tasksbusinesslayer.triggerUpdate(task);\n\t\t\t};\n\t\t\tthis._$scope.editName = function ($event, task) {\n\t\t\t\tif (task.calendar.writable) {\n\t\t\t\t\tif (!$($event.target).is('a')) {\n\t\t\t\t\t\t_$scope.setEditRoute('name');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.editDueDate = function ($event, task) {\n\t\t\t\tif (task.calendar.writable) {\n\t\t\t\t\tif ($($event.currentTarget).is($($event.target).closest('.handler'))) {\n\t\t\t\t\t\t_$scope.setEditRoute('duedate');\n\t\t\t\t\t\t_tasksbusinesslayer.initDueDate(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.editStart = function ($event, task) {\n\t\t\t\tif (task.calendar.writable) {\n\t\t\t\t\tif ($($event.currentTarget).is($($event.target).closest('.handler'))) {\n\t\t\t\t\t\t_$scope.setEditRoute('startdate');\n\t\t\t\t\t\t_tasksbusinesslayer.initStartDate(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.editReminder = function ($event, task) {\n\t\t\t\tif (task.calendar.writable) {\n\t\t\t\t\tif ($($event.currentTarget).is($($event.target).closest('.handler'))) {\n\t\t\t\t\t\t_$scope.setEditRoute('reminer');\n\t\t\t\t\t\treturn _tasksbusinesslayer.initReminder(_$scope.route.taskID);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.editNote = function ($event, task) {\n\t\t\t\tif (task.calendar.writable) {\n\t\t\t\t\tif ($($event.currentTarget).is($($event.target).closest('.handler'))) {\n\t\t\t\t\t\tif (!$($event.target).is('a')) {\n\t\t\t\t\t\t\t_$scope.setEditRoute('note');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.editPriority = function ($event, task) {\n\t\t\t\tif (task.calendar.writable) {\n\t\t\t\t\tif ($($event.currentTarget).is($($event.target).closest('.handler'))) {\n\t\t\t\t\t\t_$scope.setEditRoute('priority');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.editPercent = function ($event, task) {\n\t\t\t\tif (task.calendar.writable) {\n\t\t\t\t\tif ($($event.currentTarget).is($($event.target).closest('.handler'))) {\n\t\t\t\t\t\t_$scope.setEditRoute('percent');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.endEdit = function ($event) {\n\t\t\t\tif ($($event.target).closest('.end-edit').length || $($event.currentTarget).is($($event.target).closest('.handler'))) {\n\t\t\t\t\t_$scope.resetRoute();\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.endName = function ($event) {\n\t\t\t\tif ($event.keyCode === 13) {\n\t\t\t\t\t$event.preventDefault();\n\t\t\t\t\t_$scope.resetRoute();\n\t\t\t\t}\n\t\t\t\tif ($event.keyCode === 27) {\n\t\t\t\t\treturn _$scope.resetRoute();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._$scope.setEditRoute = function (type) {\n\t\t\t\tvar calendarID = _$scope.route.calendarID;\n\t\t\t\tvar collectionID = _$scope.route.collectionID;\n\t\t\t\tif (calendarID) {\n\t\t\t\t\t$location.path('/calendars/' + calendarID + '/tasks/' + _$scope.route.taskID + '/edit/' + type);\n\t\t\t\t} else if (collectionID) {\n\t\t\t\t\t$location.path('/collections/' + collectionID + '/tasks/' + _$scope.route.taskID + '/edit/' + type);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._$scope.resetRoute = function () {\n\t\t\t\tvar calendarID = _$scope.route.calendarID;\n\t\t\t\tvar collectionID = _$scope.route.collectionID;\n\t\t\t\tif (calendarID) {\n\t\t\t\t\t$location.path('/calendars/' + calendarID + '/tasks/' + _$scope.route.taskID);\n\t\t\t\t} else if (collectionID) {\n\t\t\t\t\t$location.path('/collections/' + collectionID + '/tasks/' + _$scope.route.taskID);\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.deletePercent = function (task) {\n\t\t\t\treturn _tasksbusinesslayer.setPercentComplete(task, 0);\n\t\t\t};\n\t\t\tthis._$scope.deleteReminder = function () {\n\t\t\t\treturn _tasksbusinesslayer.deleteReminderDate(_$scope.route.taskID);\n\t\t\t};\n\n\t\t\tthis._$scope.toggleCompleted = function (task) {\n\t\t\t\tif (task.completed) {\n\t\t\t\t\t_tasksbusinesslayer.setPercentComplete(task, 0);\n\t\t\t\t} else {\n\t\t\t\t\t_tasksbusinesslayer.setPercentComplete(task, 100);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._$scope.setPercentComplete = function (task, complete) {\n\t\t\t\t_tasksbusinesslayer.setPercentComplete(task, complete);\n\t\t\t};\n\n\t\t\tthis._$scope.toggleStarred = function (task) {\n\t\t\t\tif (task.priority > 5) {\n\t\t\t\t\t_tasksbusinesslayer.setPriority(task, 0);\n\t\t\t\t} else {\n\t\t\t\t\t_tasksbusinesslayer.setPriority(task, 9);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._$scope.deletePriority = function (task) {\n\t\t\t\treturn _tasksbusinesslayer.setPriority(task, 0);\n\t\t\t};\n\t\t\tthis._$scope.isDue = function (date) {\n\t\t\t\treturn _$tasksmodel.due(date);\n\t\t\t};\n\t\t\tthis._$scope.isOverDue = function (date) {\n\t\t\t\treturn _$tasksmodel.overdue(date);\n\t\t\t};\n\n\t\t\tthis._$scope.setstartday = function (date) {\n\t\t\t\treturn _tasksbusinesslayer.setStart(_$scope.task, moment(date, 'MM/DD/YYYY'), 'day');\n\t\t\t};\n\t\t\tthis._$scope.setstarttime = function (date) {\n\t\t\t\treturn _tasksbusinesslayer.setStart(_$scope.task, moment(date, 'HH:mm'), 'time');\n\t\t\t};\n\t\t\tthis._$scope.deleteStartDate = function (task) {\n\t\t\t\t_tasksbusinesslayer.deleteStartDate(task);\n\t\t\t};\n\n\t\t\tthis._$scope.setdueday = function (date) {\n\t\t\t\treturn _tasksbusinesslayer.setDue(_$scope.task, moment(date, 'MM/DD/YYYY'), 'day');\n\t\t\t};\n\t\t\tthis._$scope.setduetime = function (date) {\n\t\t\t\treturn _tasksbusinesslayer.setDue(_$scope.task, moment(date, 'HH:mm'), 'time');\n\t\t\t};\n\t\t\tthis._$scope.deleteDueDate = function (task) {\n\t\t\t\t_tasksbusinesslayer.deleteDueDate(task);\n\t\t\t};\n\n\t\t\tthis._$scope.isAllDayPossible = function (task) {\n\t\t\t\treturn !angular.isUndefined(task) && task.calendar.writable && (task.due || task.start);\n\t\t\t};\n\t\t\tthis._$scope.toggleAllDay = function (task) {\n\t\t\t\t_tasksbusinesslayer.setAllDay(task, !task.allDay);\n\t\t\t};\n\n\t\t\tthis._$scope.setreminderday = function (date) {\n\t\t\t\treturn _tasksbusinesslayer.setReminderDate(_$scope.route.taskID, moment(date, 'MM/DD/YYYY'), 'day');\n\t\t\t};\n\t\t\tthis._$scope.setremindertime = function (date) {\n\t\t\t\treturn _tasksbusinesslayer.setReminderDate(_$scope.route.taskID, moment(date, 'HH:mm'), 'time');\n\t\t\t};\n\t\t\tthis._$scope.reminderType = function (task) {\n\t\t\t\tif (!angular.isUndefined(task)) {\n\t\t\t\t\tif (task.reminder === null) {\n\t\t\t\t\t\tif (moment(task.start, \"YYYYMMDDTHHmmss\").isValid() || moment(task.due, \"YYYYMMDDTHHmmss\").isValid()) {\n\t\t\t\t\t\t\treturn 'DURATION';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn 'DATE-TIME';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn task.reminder.type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.changeReminderType = function (task) {\n\t\t\t\t_tasksbusinesslayer.checkReminderDate(task.id);\n\t\t\t\tif (this.reminderType(task) === 'DURATION') {\n\t\t\t\t\tif (task.reminder) {\n\t\t\t\t\t\ttask.reminder.type = 'DATE-TIME';\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask.reminder = {\n\t\t\t\t\t\t\ttype: 'DATE-TIME'\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (task.reminder) {\n\t\t\t\t\t\ttask.reminder.type = 'DURATION';\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask.reminder = {\n\t\t\t\t\t\t\ttype: 'DURATION'\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn _tasksbusinesslayer.setReminder(task.id);\n\t\t\t};\n\t\t\tthis._$scope.setReminderDuration = function (taskID) {\n\t\t\t\treturn _tasksbusinesslayer.setReminder(_$scope.route.taskID);\n\t\t\t};\n\t\t\tthis._$scope.addComment = function () {\n\t\t\t\tvar comment,\n\t\t\t\t    _this = this;\n\t\t\t\tif (_$scope.CommentContent) {\n\t\t\t\t\t_$scope.isAddingComment = true;\n\t\t\t\t\tcomment = {\n\t\t\t\t\t\ttmpID: 'newComment' + Date.now(),\n\t\t\t\t\t\tcomment: _$scope.CommentContent,\n\t\t\t\t\t\ttaskID: _$scope.route.taskID,\n\t\t\t\t\t\ttime: moment().format('YYYYMMDDTHHmmss'),\n\t\t\t\t\t\tname: $('#expandDisplayName').text()\n\t\t\t\t\t};\n\t\t\t\t\t_tasksbusinesslayer.addComment(comment, function (data) {\n\t\t\t\t\t\t_$tasksmodel.updateComment(data);\n\t\t\t\t\t\t_$scope.isAddingComment = false;\n\t\t\t\t\t}, function () {\n\t\t\t\t\t\t_$scope.isAddingComment = false;\n\t\t\t\t\t});\n\t\t\t\t\t_$scope.CommentContent = '';\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.sendComment = function (event) {\n\t\t\t\tif (event.keyCode === 13) {\n\t\t\t\t\treturn _$scope.addComment();\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._$scope.deleteComment = function (commentID) {\n\t\t\t\treturn _tasksbusinesslayer.deleteComment(_$scope.route.taskID, commentID);\n\t\t\t};\n\t\t\tthis._$scope.commentStrings = function () {\n\t\t\t\treturn {\n\t\t\t\t\tbutton: t('tasks', 'Comment'),\n\t\t\t\t\tinput: t('tasks', 'Add a comment')\n\t\t\t\t};\n\t\t\t};\n\t\t\tthis._$scope.addCategory = function (category, model) {\n\t\t\t\t_$scope.task.categories = _$scope.task.cats;\n\t\t\t\tvar default_categories = _$scope.settingsmodel.getById('various').categories;\n\t\t\t\tif (default_categories.indexOf(category) < 0) {\n\t\t\t\t\tdefault_categories.push(category);\n\t\t\t\t}\n\t\t\t\t_tasksbusinesslayer.doUpdate(_$scope.task);\n\t\t\t};\n\t\t\tthis._$scope.removeCategory = function (category, model) {\n\t\t\t\t_$scope.task.categories = _$scope.task.cats;\n\t\t\t\t_tasksbusinesslayer.doUpdate(_$scope.task);\n\t\t\t};\n\t\t}\n\n\t\treturn DetailsController;\n\t}();\n\treturn new DetailsController($scope, $window, TasksModel, TasksBusinessLayer, $route, $location, $timeout, $routeParams, SettingsModel, Loading, ListsModel);\n}]);","'use strict';\n\nangular.module('Tasks').controller('ListController', ['$scope', '$rootScope', '$window', '$routeParams', 'ListsModel', 'TasksBusinessLayer', 'CollectionsModel', 'ListsBusinessLayer', '$location', 'SearchBusinessLayer', 'CalendarService', 'TasksModel', '$timeout', function ($scope, $rootScope, $window, $routeParams, ListsModel, TasksBusinessLayer, CollectionsModel, ListsBusinessLayer, $location, SearchBusinessLayer, CalendarService, TasksModel, $timeout) {\n\t'use strict';\n\n\tvar ListController;\n\tListController = function () {\n\t\tfunction ListController(_$scope, $rootScope, _$window, _$routeParams, _$listsmodel, _$tasksbusinesslayer, _$collectionsmodel, _$listsbusinesslayer, $location, _$searchbusinesslayer, _$calendarservice, _$tasksmodel, _$timeout) {\n\n\t\t\tthis._$scope = _$scope;\n\t\t\tthis._$window = _$window;\n\t\t\tthis._$routeParams = _$routeParams;\n\t\t\tthis._$listsmodel = _$listsmodel;\n\t\t\tthis._$tasksmodel = _$tasksmodel;\n\t\t\tthis._$tasksbusinesslayer = _$tasksbusinesslayer;\n\t\t\tthis._$collectionsmodel = _$collectionsmodel;\n\t\t\tthis._$listsbusinesslayer = _$listsbusinesslayer;\n\t\t\tthis.$location = $location;\n\t\t\tthis._$timeout = _$timeout;\n\t\t\tthis._$searchbusinesslayer = _$searchbusinesslayer;\n\t\t\tthis._$calendarservice = _$calendarservice;\n\t\t\tthis._$scope.collections = this._$collectionsmodel.getAll();\n\t\t\tthis._$scope.calendars = this._$listsmodel.getAll();\n\t\t\tthis._$scope.draggedTasks = [];\n\t\t\tthis._$scope.TasksBusinessLayer = this._$tasksbusinesslayer;\n\t\t\tthis._$scope.nameError = false;\n\t\t\tthis._$scope.color = '#31CC7C';\n\n\t\t\tthis._$scope.deleteMessage = function (calendar) {\n\t\t\t\treturn t('tasks', 'This will delete the Calendar \"%s\" and all of its entries.').replace('%s', calendar.displayname);\n\t\t\t};\n\n\t\t\tthis._$scope[\"delete\"] = function (calendar) {\n\t\t\t\treturn _$listsbusinesslayer[\"delete\"](calendar).then(function () {\n\t\t\t\t\t$location.path('/calendars/' + _$listsmodel.getStandardList().uri);\n\t\t\t\t\treturn $scope.$apply();\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tthis._$scope.startCreate = function () {\n\t\t\t\t_$scope.status.addingList = true;\n\t\t\t\t_$scope.nameError = false;\n\t\t\t\t$('.hasTooltip').tooltip('hide');\n\t\t\t\t_$timeout(function () {\n\t\t\t\t\t$('#newList').focus();\n\t\t\t\t}, 50);\n\t\t\t};\n\n\t\t\tthis._$scope.create = function () {\n\t\t\t\tvar check = _$scope.isNameAllowed(_$scope.status.newListName);\n\t\t\t\tif (check.allowed) {\n\t\t\t\t\t_$scope.status.addingList = false;\n\t\t\t\t\t_$scope.isAddingList = true;\n\t\t\t\t\t_$listsbusinesslayer.add(_$scope.status.newListName, _$scope.color).then(function (calendar) {\n\t\t\t\t\t\t$location.path('/calendars/' + calendar.uri);\n\t\t\t\t\t\treturn $scope.$apply();\n\t\t\t\t\t});\n\t\t\t\t\t_$scope.status.newListName = '';\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._$scope.cancelCreate = function () {\n\t\t\t\t$('.hasTooltip').tooltip('hide');\n\t\t\t\t_$scope.nameError = false;\n\t\t\t\t_$scope.status.addingList = false;\n\t\t\t\t_$scope.status.newListName = \"\";\n\t\t\t};\n\n\t\t\tthis._$scope.startEdit = function (calendar) {\n\t\t\t\t_$scope.status.addingList = false;\n\t\t\t\t_$scope.nameError = false;\n\t\t\t\t$('.hasTooltip').tooltip('hide');\n\t\t\t\tcalendar.prepareUpdate();\n\t\t\t\t$location.path('/calendars/' + _$scope.route.calendarID + '/edit/name');\n\t\t\t\t_$timeout(function () {\n\t\t\t\t\t$('#list_' + calendar.uri + ' input.edit').focus();\n\t\t\t\t}, 50);\n\t\t\t};\n\n\t\t\tthis._$scope.showCalDAVUrl = function (calendar) {\n\t\t\t\t_$scope.status.addingList = false;\n\t\t\t\t_$scope.nameError = false;\n\t\t\t\t$location.path('/calendars/' + _$scope.route.calendarID + '/edit/caldav');\n\t\t\t\t_$timeout(function () {\n\t\t\t\t\t$('#list_' + calendar.uri + ' input.caldav').focus();\n\t\t\t\t}, 50);\n\t\t\t};\n\n\t\t\tthis._$scope.hideCalDAVUrl = function () {\n\t\t\t\t$location.path('/calendars/' + _$scope.route.calendarID);\n\t\t\t};\n\n\t\t\tthis._$scope.download = function (calendar) {\n\t\t\t\tvar url = calendar.url;\n\t\t\t\t// cut off last slash to have a fancy name for the ics\n\t\t\t\tif (url.slice(url.length - 1) === '/') {\n\t\t\t\t\turl = url.slice(0, url.length - 1);\n\t\t\t\t}\n\t\t\t\turl += '?export';\n\t\t\t\t$window.open(url);\n\t\t\t};\n\n\t\t\tthis._$scope.checkNew = function (event, name) {\n\t\t\t\t_$scope.checkName(event, name);\n\t\t\t};\n\n\t\t\tthis._$scope.checkEdit = function (event, calendar) {\n\t\t\t\t_$scope.checkName(event, calendar.displayname, calendar.uri);\n\t\t\t\tif (event.keyCode === 27) {\n\t\t\t\t\t_$scope.cancelEdit(calendar);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._$scope.checkName = function (event, name, uri) {\n\t\t\t\tvar check = _$scope.isNameAllowed(name, uri);\n\t\t\t\tvar $input = $(event.currentTarget);\n\t\t\t\tif (!check.allowed) {\n\t\t\t\t\t$input.attr('title', check.msg).tooltip({ placement: 'bottom', trigger: 'manual' }).tooltip('fixTitle').tooltip('show');\n\t\t\t\t\t_$scope.nameError = true;\n\t\t\t\t} else {\n\t\t\t\t\t$input.tooltip('hide');\n\t\t\t\t\t_$scope.nameError = false;\n\t\t\t\t}\n\t\t\t\tif (event.keyCode === 27) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t$input.tooltip('hide');\n\t\t\t\t\t_$scope.status.addingList = false;\n\t\t\t\t\t_$scope.status.newListName = \"\";\n\t\t\t\t\t_$scope.nameError = false;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$rootScope.$on('cancelEditCalendar', function (s, calendarUri) {\n\t\t\t\tvar calendar = _$listsmodel.getByUri(calendarUri);\n\t\t\t\t_$scope.cancelEdit(calendar);\n\t\t\t});\n\n\t\t\tthis._$scope.cancelEdit = function (calendar) {\n\t\t\t\tcalendar.resetToPreviousState();\n\t\t\t\t$('.hasTooltip').tooltip('hide');\n\t\t\t\t_$scope.nameError = false;\n\t\t\t\t$location.path('/calendars/' + _$scope.route.calendarID);\n\t\t\t};\n\n\t\t\tthis._$scope.saveEdit = function (calendar) {\n\t\t\t\tvar check = _$scope.isNameAllowed(calendar.displayname, calendar.uri);\n\t\t\t\tif (check.allowed) {\n\t\t\t\t\t_$listsbusinesslayer.rename(calendar);\n\t\t\t\t\t$location.path('/calendars/' + _$scope.route.calendarID);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._$scope.isNameAllowed = function (name, uri) {\n\t\t\t\tvar check = {\n\t\t\t\t\tallowed: false,\n\t\t\t\t\tmsg: ''\n\t\t\t\t};\n\t\t\t\tif (_$listsmodel.isNameAlreadyTaken(name, uri)) {\n\t\t\t\t\tcheck.msg = t('tasks', 'The name \"%s\" is already used.').replace('%s', name);\n\t\t\t\t} else if (!name) {\n\t\t\t\t\tcheck.msg = t('tasks', 'An empty name is not allowed.');\n\t\t\t\t} else {\n\t\t\t\t\tcheck.allowed = true;\n\t\t\t\t}\n\t\t\t\treturn check;\n\t\t\t};\n\n\t\t\tthis._$scope.getCollectionCount = function (collectionID) {\n\t\t\t\tvar filter;\n\t\t\t\tfilter = _$searchbusinesslayer.getFilter();\n\t\t\t\treturn _$collectionsmodel.getCount(collectionID, filter);\n\t\t\t};\n\n\t\t\tthis._$scope.hideCollection = function (collectionID) {\n\t\t\t\tvar collection;\n\t\t\t\tcollection = _$collectionsmodel.getById(collectionID);\n\t\t\t\tswitch (collection.show) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\treturn this.getCollectionCount(collectionID) < 1;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._$scope.getCollectionString = function (collectionID) {\n\t\t\t\tvar filter;\n\t\t\t\tif (collectionID !== 'completed') {\n\t\t\t\t\tfilter = _$searchbusinesslayer.getFilter();\n\t\t\t\t\treturn _$collectionsmodel.getCount(collectionID, filter);\n\t\t\t\t} else {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._$scope.getListCount = function (listID, type) {\n\t\t\t\tvar filter;\n\t\t\t\tfilter = _$searchbusinesslayer.getFilter();\n\t\t\t\treturn _$listsmodel.getCount(listID, type, filter);\n\t\t\t};\n\n\t\t\tthis._$scope.dragoverList = function ($event, index) {\n\t\t\t\tvar calendarID = $($event.target).closest('li.list').attr('calendarID');\n\t\t\t\tvar calendar = _$listsmodel.getByUri(calendarID);\n\t\t\t\treturn calendar.writable;\n\t\t\t};\n\n\t\t\tthis._$scope.dropList = function ($event, index, item) {\n\t\t\t\tif ($event.dataTransfer.dropEffect === 'move') {\n\t\t\t\t\t// we can't simply use item as task, since the directive seems to not copy all properties --> task.calendar.uri == undefined\n\t\t\t\t\tvar task = _$tasksmodel.getByUri(item.uri);\n\t\t\t\t\tvar calendarID = $($event.target).closest('li.list').attr('calendarID');\n\t\t\t\t\tvar calendar = _$listsmodel.getByUri(calendarID);\n\t\t\t\t\t_$tasksbusinesslayer.changeCalendar(task, calendar).then(function () {\n\t\t\t\t\t\t_$scope.$apply();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\tthis._$scope.dragoverCollection = function ($event, index) {\n\t\t\t\tif ($event.dataTransfer.effectAllowed === 'copy' || $event.dataTransfer.effectAllowed === 'copyMove' && $event.ctrlKey) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar collectionID;\n\t\t\t\tcollectionID = $($event.target).closest('li.collection').attr('collectionID');\n\t\t\t\treturn collectionID === 'starred' || collectionID === 'completed' || collectionID === 'today';\n\t\t\t};\n\n\t\t\tthis._$scope.dropCollection = function ($event, index, item) {\n\t\t\t\tif ($event.dataTransfer.dropEffect === 'move') {\n\t\t\t\t\tvar collectionID = $($event.target).closest('li.collection').attr('collectionID');\n\t\t\t\t\t_$tasksbusinesslayer.changeCollection(item.uri, collectionID);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t};\n\t\t}\n\n\t\treturn ListController;\n\t}();\n\treturn new ListController($scope, $rootScope, $window, $routeParams, ListsModel, TasksBusinessLayer, CollectionsModel, ListsBusinessLayer, $location, SearchBusinessLayer, CalendarService, TasksModel, $timeout);\n}]);","'use strict';\n\nangular.module('Tasks').controller('SettingsController', ['$scope', '$window', 'Status', '$location', 'CollectionsModel', 'SettingsBusinessLayer', 'SettingsModel', function ($scope, $window, Status, $location, CollectionsModel, SettingsBusinessLayer, SettingsModel) {\n  'use strict';\n\n  var SettingsController;\n  SettingsController = function () {\n    function SettingsController(_$scope, _$window, _$status, _$location, _$collectionsmodel, _$settingsbusinesslayer, _$settingsmodel) {\n      var _this = this;\n      this._$scope = _$scope;\n      this._$window = _$window;\n      this._$status = _$status;\n      this._$location = _$location;\n      this._$collectionsmodel = _$collectionsmodel;\n      this._$settingsbusinesslayer = _$settingsbusinesslayer;\n      this._$settingsmodel = _$settingsmodel;\n      this._$scope.status = this._$status.getStatus();\n      this._$scope.collections = this._$collectionsmodel.getAll();\n      this._$scope.settingsmodel = this._$settingsmodel;\n      this._$scope.collectionOptions = [{\n        id: 0,\n        name: t('tasks', 'Hidden')\n      }, {\n        id: 1,\n        name: t('tasks', 'Visible')\n      }, {\n        id: 2,\n        name: t('tasks', 'Automatic')\n      }];\n      this._$scope.startOfWeekOptions = [{\n        id: 0,\n        name: t('tasks', 'Sunday')\n      }, {\n        id: 1,\n        name: t('tasks', 'Monday')\n      }, {\n        id: 2,\n        name: t('tasks', 'Tuesday')\n      }, {\n        id: 3,\n        name: t('tasks', 'Wednesday')\n      }, {\n        id: 4,\n        name: t('tasks', 'Thursday')\n      }, {\n        id: 5,\n        name: t('tasks', 'Friday')\n      }, {\n        id: 6,\n        name: t('tasks', 'Saturday')\n      }];\n      this._$scope.setVisibility = function (collectionID) {\n        var collection;\n        collection = _$collectionsmodel.getById(collectionID);\n        return _$settingsbusinesslayer.setVisibility(collectionID, collection.show);\n      };\n      this._$scope.setStartOfWeek = function () {\n        return _$settingsbusinesslayer.set('various', 'startOfWeek', _$settingsmodel.getById('various').startOfWeek);\n      };\n    }\n\n    return SettingsController;\n  }();\n  return new SettingsController($scope, $window, Status, $location, CollectionsModel, SettingsBusinessLayer, SettingsModel);\n}]);","'use strict';\n\n(function () {\n\t'use strict';\n\n\tvar __indexOf = [].indexOf || function (item) {\n\t\tfor (var i = 0, l = this.length; i < l; i++) {\n\t\t\tif (i in this && this[i] === item) return i;\n\t\t}return -1;\n\t};\n\n\tangular.module('Tasks').controller('TasksController', ['$scope', '$window', '$routeParams', 'TasksModel', 'ListsModel', 'CollectionsModel', 'TasksBusinessLayer', '$location', 'SettingsBusinessLayer', 'SearchBusinessLayer', 'VTodo', 'SettingsModel', function ($scope, $window, $routeParams, TasksModel, ListsModel, CollectionsModel, TasksBusinessLayer, $location, SettingsBusinessLayer, SearchBusinessLayer, VTodo, SettingsModel) {\n\t\tvar TasksController;\n\t\tTasksController = function () {\n\t\t\tfunction TasksController(_$scope, _$window, _$routeParams, _$tasksmodel, _$listsmodel, _$collectionsmodel, _tasksbusinesslayer, $location, _settingsbusinesslayer, _searchbusinesslayer, vtodo, _$settingsmodel) {\n\t\t\t\tvar _this = this;\n\t\t\t\tthis._$scope = _$scope;\n\t\t\t\tthis._$window = _$window;\n\t\t\t\tthis._$routeParams = _$routeParams;\n\t\t\t\tthis._$tasksmodel = _$tasksmodel;\n\t\t\t\tthis._$listsmodel = _$listsmodel;\n\t\t\t\tthis._$collectionsmodel = _$collectionsmodel;\n\t\t\t\tthis._tasksbusinesslayer = _tasksbusinesslayer;\n\t\t\t\tthis.$location = $location;\n\t\t\t\tthis._settingsbusinesslayer = _settingsbusinesslayer;\n\t\t\t\tthis._searchbusinesslayer = _searchbusinesslayer;\n\t\t\t\tthis._vtodo = vtodo;\n\t\t\t\tthis._$scope.tasks = this._$tasksmodel.getAll();\n\t\t\t\tthis._$scope.draggedTasks = [];\n\t\t\t\tthis._$scope.calendars = this._$listsmodel.getAll();\n\t\t\t\tthis._$scope.days = [0, 1, 2, 3, 4, 5, 6];\n\t\t\t\tthis._$scope.isAddingTask = false;\n\t\t\t\tthis._$scope.focusInputField = false;\n\t\t\t\tthis._$scope.TasksModel = this._$tasksmodel;\n\t\t\t\tthis._$scope.TasksBusinessLayer = this._tasksbusinesslayer;\n\t\t\t\tthis._$settingsmodel = _$settingsmodel;\n\n\t\t\t\tthis._$scope.addTask = function (taskName, related, calendar, parent) {\n\t\t\t\t\tvar _ref,\n\t\t\t\t\t    _this = this;\n\t\t\t\t\tif (calendar === null) {\n\t\t\t\t\t\tcalendar = '';\n\t\t\t\t\t}\n\t\t\t\t\t_$scope.isAddingTask = true;\n\t\t\t\t\tvar task = {\n\t\t\t\t\t\tcalendar: null,\n\t\t\t\t\t\trelated: related,\n\t\t\t\t\t\tsummary: taskName,\n\t\t\t\t\t\tpriority: '0',\n\t\t\t\t\t\tdue: false,\n\t\t\t\t\t\tstart: false,\n\t\t\t\t\t\treminder: null,\n\t\t\t\t\t\tcompleted: false,\n\t\t\t\t\t\tcomplete: '0',\n\t\t\t\t\t\tnote: ''\n\t\t\t\t\t};\n\t\t\t\t\tif ((_ref = _$scope.route.collectionID) === 'starred' || _ref === 'today' || _ref === 'week' || _ref === 'all' || _ref === 'completed' || _ref === 'current') {\n\t\t\t\t\t\tif (related) {\n\t\t\t\t\t\t\ttask.calendar = calendar;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttask.calendar = _$listsmodel.getStandardList();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (_$scope.route.collectionID === 'starred') {\n\t\t\t\t\t\t\ttask.priority = '1';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (_$scope.route.collectionID === 'today') {\n\t\t\t\t\t\t\ttask.due = moment().startOf('day').format(\"YYYY-MM-DDTHH:mm:ss\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (_$scope.route.collectionID === 'current') {\n\t\t\t\t\t\t\ttask.start = moment().format(\"YYYY-MM-DDTHH:mm:ss\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask.calendar = _$listsmodel.getByUri(_$scope.route.calendarID);\n\t\t\t\t\t}\n\t\t\t\t\ttask = VTodo.create(task);\n\t\t\t\t\t_tasksbusinesslayer.add(task).then(function (task) {\n\t\t\t\t\t\t_$scope.isAddingTask = false;\n\t\t\t\t\t\t_$scope.openDetails(task.uri, null);\n\t\t\t\t\t\treturn $scope.$apply();\n\t\t\t\t\t});\n\t\t\t\t\tif (parent) {\n\t\t\t\t\t\t_tasksbusinesslayer.setHideSubtasks(parent, 0);\n\t\t\t\t\t}\n\t\t\t\t\t_$scope.status.focusTaskInput = false;\n\t\t\t\t\t_$scope.status.focusSubtaskInput = false;\n\t\t\t\t\t_$scope.status.addSubtaskTo = null;\n\t\t\t\t\t_$scope.status.taskName = '';\n\t\t\t\t\t_$scope.status.subtaskName = '';\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.getAddString = function () {\n\t\t\t\t\tvar calendar = _$listsmodel.getStandardList();\n\t\t\t\t\tif (angular.isDefined(calendar)) {\n\t\t\t\t\t\tif (angular.isDefined(_$scope.route.collectionID)) {\n\t\t\t\t\t\t\tswitch (_$scope.route.collectionID) {\n\t\t\t\t\t\t\t\tcase 'starred':\n\t\t\t\t\t\t\t\t\treturn t('tasks', 'Add an important item in \"%s\"...').replace('%s', calendar.displayname);\n\t\t\t\t\t\t\t\tcase 'today':\n\t\t\t\t\t\t\t\t\treturn t('tasks', 'Add an item due today in \"%s\"...').replace('%s', calendar.displayname);\n\t\t\t\t\t\t\t\tcase 'all':\n\t\t\t\t\t\t\t\t\treturn t('tasks', 'Add an item in \"%s\"...').replace('%s', calendar.displayname);\n\t\t\t\t\t\t\t\tcase 'current':\n\t\t\t\t\t\t\t\t\treturn t('tasks', 'Add a current item in \"%s\"...').replace('%s', calendar.displayname);\n\t\t\t\t\t\t\t\tcase 'completed':\n\t\t\t\t\t\t\t\tcase 'week':\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (angular.isDefined(_$listsmodel.getByUri(_$scope.route.calendarID))) {\n\t\t\t\t\t\t\t\treturn t('tasks', 'Add an item in \"%s\"...').replace('%s', _$listsmodel.getByUri(_$scope.route.calendarID).displayname);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.getSubAddString = function (taskname) {\n\t\t\t\t\treturn t('tasks', 'Add a subtask to \"%s\"...').replace('%s', taskname);\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.showSubtaskInput = function (uid) {\n\t\t\t\t\t_$scope.status.addSubtaskTo = uid;\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.hideSubtasks = function (task) {\n\t\t\t\t\tvar taskID = _$scope.route.taskID;\n\t\t\t\t\tvar descendantIDs = _$tasksmodel.getDescendantIDs(task);\n\t\t\t\t\tif (task.uri === taskID) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (__indexOf.call(descendantIDs, taskID) >= 0) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn task.hideSubtasks;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.showInput = function () {\n\t\t\t\t\tvar collectionID = _$scope.route.collectionID;\n\t\t\t\t\tvar calendar = _$listsmodel.getByUri(_$scope.route.calendarID);\n\t\t\t\t\tif (collectionID === 'completed' || collectionID === 'week') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif (angular.isDefined(calendar)) {\n\t\t\t\t\t\treturn calendar.writable;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.focusTaskInput = function () {\n\t\t\t\t\t_$scope.status.focusTaskInput = true;\n\t\t\t\t};\n\t\t\t\tthis._$scope.focusSubtaskInput = function () {\n\t\t\t\t\t_$scope.status.focusSubtaskInput = true;\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.openDetails = function (id, $event) {\n\t\t\t\t\tvar calendarID = _$scope.route.calendarID;\n\t\t\t\t\tvar collectionID = _$scope.route.collectionID;\n\t\t\t\t\tif ($event === null || $($event.currentTarget).is($($event.target).closest('.handler'))) {\n\t\t\t\t\t\tvar parent = _$tasksmodel.getByUri(id);\n\t\t\t\t\t\tif (!parent.loadedCompleted) {\n\t\t\t\t\t\t\t_tasksbusinesslayer.getAll(parent.calendar, true, parent).then(function () {\n\t\t\t\t\t\t\t\tparent.loadedCompleted = true;\n\t\t\t\t\t\t\t\t$scope.$apply();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (calendarID) {\n\t\t\t\t\t\t\t$location.path('/calendars/' + calendarID + '/tasks/' + id);\n\t\t\t\t\t\t} else if (collectionID) {\n\t\t\t\t\t\t\t$location.path('/collections/' + collectionID + '/tasks/' + id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.toggleCompleted = function (task) {\n\t\t\t\t\tif (task.completed) {\n\t\t\t\t\t\t_tasksbusinesslayer.setPercentComplete(task, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_tasksbusinesslayer.setPercentComplete(task, 100);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.toggleStarred = function (task) {\n\t\t\t\t\tif (task.priority > 5) {\n\t\t\t\t\t\t_tasksbusinesslayer.setPriority(task, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_tasksbusinesslayer.setPriority(task, 9);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.toggleHidden = function () {\n\t\t\t\t\treturn _settingsbusinesslayer.toggle('various', 'showHidden');\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.filterTasks = function (task, filter) {\n\t\t\t\t\treturn function (task) {\n\t\t\t\t\t\treturn _$tasksmodel.filterTasks(task, filter);\n\t\t\t\t\t};\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.getSubTasks = function (tasks, parent) {\n\t\t\t\t\tvar ret, task, _i, _len;\n\t\t\t\t\tret = [];\n\t\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\t\tif (task.related === parent.uid && task !== parent && !(parent.hideCompletedSubtasks && task.completed)) {\n\t\t\t\t\t\t\tret.push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn ret;\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.hasNoParent = function (task) {\n\t\t\t\t\treturn function (task) {\n\t\t\t\t\t\treturn _$tasksmodel.hasNoParent(task);\n\t\t\t\t\t};\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.hasSubtasks = function (task) {\n\t\t\t\t\treturn _$tasksmodel.hasSubtasks(task.uid);\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.hasCompletedSubtasks = function (task) {\n\t\t\t\t\treturn _$tasksmodel.hasCompletedSubtasks(task.uid);\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.toggleSubtasks = function (task) {\n\t\t\t\t\t_tasksbusinesslayer.setHideSubtasks(task, !task.hideSubtasks);\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.toggleCompletedSubtasks = function (task) {\n\t\t\t\t\t_tasksbusinesslayer.setHideCompletedSubtasks(task, !task.hideCompletedSubtasks);\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.filterTasksByString = function (task) {\n\t\t\t\t\treturn function (task) {\n\t\t\t\t\t\tvar filter = _searchbusinesslayer.getFilter();\n\t\t\t\t\t\treturn _$tasksmodel.filterTasksByString(task, filter);\n\t\t\t\t\t};\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.filteredTasks = function () {\n\t\t\t\t\tvar filter;\n\t\t\t\t\tfilter = _searchbusinesslayer.getFilter();\n\t\t\t\t\treturn _$tasksmodel.filteredTasks(filter);\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.dayHasEntry = function () {\n\t\t\t\t\treturn function (date) {\n\t\t\t\t\t\tvar filter, task, tasks, _i, _len;\n\t\t\t\t\t\tfilter = _searchbusinesslayer.getFilter();\n\t\t\t\t\t\ttasks = _$tasksmodel.filteredTasks(filter);\n\t\t\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\t\t\tif (task.completed || !_$tasksmodel.hasNoParent(task)) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (_$tasksmodel.taskAtDay(task, date)) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t\tthis._$scope.taskAtDay = function (task, day) {\n\t\t\t\t\treturn function (task) {\n\t\t\t\t\t\treturn _$tasksmodel.taskAtDay(task, day);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t\tthis._$scope.filterLists = function () {\n\t\t\t\t\treturn function (calendar) {\n\t\t\t\t\t\treturn _$scope.getCount(calendar.uri, _$scope.route.collectionID);\n\t\t\t\t\t};\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.getCount = function (calendarID, type) {\n\t\t\t\t\tvar filter = _searchbusinesslayer.getFilter();\n\t\t\t\t\treturn _$listsmodel.getCount(calendarID, type, filter);\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.getCountString = function (calendarID, type) {\n\t\t\t\t\tvar filter = _searchbusinesslayer.getFilter();\n\t\t\t\t\treturn n('tasks', '%n Completed Task', '%n Completed Tasks', _$listsmodel.getCount(calendarID, type, filter));\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.checkTaskInput = function ($event) {\n\t\t\t\t\tif ($event.keyCode === 27) {\n\t\t\t\t\t\t$($event.currentTarget).blur();\n\t\t\t\t\t\t_$scope.status.taskName = '';\n\t\t\t\t\t\t_$scope.status.subtaskName = '';\n\t\t\t\t\t\t_$scope.status.addSubtaskTo = null;\n\t\t\t\t\t\t_$scope.status.focusTaskInput = false;\n\t\t\t\t\t\t_$scope.status.focusSubtaskInput = false;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.getCompletedTasks = function (calendarID) {\n\t\t\t\t\tvar calendar = _$listsmodel.getById(calendarID);\n\t\t\t\t\t_tasksbusinesslayer.getAll(calendar, true).then(function () {\n\t\t\t\t\t\t_$listsmodel.setLoadedCompleted(calendarID);\n\t\t\t\t\t\t$scope.$apply();\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.loadedCompleted = function (calendarID) {\n\t\t\t\t\treturn _$listsmodel.loadedCompleted(calendarID);\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.sortDue = function (task) {\n\t\t\t\t\tif (task.due === null) {\n\t\t\t\t\t\treturn 'last';\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn task.due;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.sortStart = function (task) {\n\t\t\t\t\tif (task.start === null) {\n\t\t\t\t\t\treturn 'last';\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn task.start;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.getSortOrder = function () {\n\t\t\t\t\tswitch (_$scope.settingsmodel.getById('various').sortOrder) {\n\t\t\t\t\t\tcase 'due':\n\t\t\t\t\t\t\treturn _$scope.sortDue;\n\t\t\t\t\t\tcase 'start':\n\t\t\t\t\t\t\treturn _$scope.sortStart;\n\t\t\t\t\t\tcase 'priority':\n\t\t\t\t\t\t\treturn '-priority';\n\t\t\t\t\t\tcase 'alphabetically':\n\t\t\t\t\t\t\treturn 'summary';\n\t\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\t\treturn 'manual';\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treturn ['completed', _$scope.sortDue, '-priority', _$scope.sortStart, 'summary'];\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.getSortOrderIcon = function () {\n\t\t\t\t\tswitch (_$scope.settingsmodel.getById('various').sortOrder) {\n\t\t\t\t\t\tcase 'due':\n\t\t\t\t\t\tcase 'start':\n\t\t\t\t\t\t\treturn 'ico-calendar';\n\t\t\t\t\t\tcase 'priority':\n\t\t\t\t\t\t\treturn 'ico-star';\n\t\t\t\t\t\tcase 'alphabetically':\n\t\t\t\t\t\t\treturn 'ico-alphabetically';\n\t\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\t\treturn 'ico-manual';\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treturn 'ico-menu';\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.setSortOrder = function ($event, order) {\n\t\t\t\t\t_$scope.settingsmodel.getById('various').sortDirection = _$scope.settingsmodel.getById('various').sortOrder === order ? +!_$scope.settingsmodel.getById('various').sortDirection : 0;\n\t\t\t\t\t_$scope.settingsmodel.getById('various').sortOrder = order;\n\t\t\t\t\t_settingsbusinesslayer.set('various', 'sortOrder', order);\n\t\t\t\t\t_settingsbusinesslayer.set('various', 'sortDirection', _$scope.settingsmodel.getById('various').sortDirection);\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.dropAsSubtask = function ($event, item, index) {\n\t\t\t\t\tif ($event.dataTransfer.dropEffect === 'move') {\n\t\t\t\t\t\tvar parentID = $($event.target).closest('.task-item').attr('taskID');\n\t\t\t\t\t\tvar task = _$tasksmodel.getByUri(item.uri);\n\t\t\t\t\t\tvar parent = _$tasksmodel.getByUri(parentID);\n\t\t\t\t\t\t_tasksbusinesslayer.changeParent(task, parent);\n\t\t\t\t\t}\n\t\t\t\t\t$('.subtasks-container').removeClass('dropzone-visible');\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.dropAsRootTask = function ($event, item, index) {\n\t\t\t\t\tif ($event.dataTransfer.dropEffect === 'move') {\n\t\t\t\t\t\tvar task = _$tasksmodel.getByUri(item.uri);\n\t\t\t\t\t\tvar collectionID = $($event.target).closest('ol[dnd-list]').attr('collectionID');\n\t\t\t\t\t\tvar calendarID = $($event.target).closest('ol[dnd-list]').attr('calendarID');\n\t\t\t\t\t\tvar newCalendar = _$listsmodel.getByUri(calendarID);\n\t\t\t\t\t\tvar queries = _tasksbusinesslayer.makeRootTask(task, newCalendar, collectionID);\n\t\t\t\t\t\tPromise.all(queries).then(function () {\n\t\t\t\t\t\t\t$scope.$apply();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t$('.subtasks-container').removeClass('dropzone-visible');\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.dragover = function ($event, item, index) {\n\t\t\t\t\t$('.subtasks-container').removeClass('dropzone-visible');\n\t\t\t\t\tvar calendarID = $($event.target).closest('ol[dnd-list]').attr('calendarID');\n\t\t\t\t\tvar calendar = _$listsmodel.getByUri(calendarID);\n\t\t\t\t\tif (calendar.writable) {\n\t\t\t\t\t\t$($event.target).closest('.task-item').children('.subtasks-container').addClass('dropzone-visible');\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.allow = function (task) {\n\t\t\t\t\tif (task.calendar.writable) {\n\t\t\t\t\t\treturn \"copyMove\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn \"copy\";\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.dragStart = function ($event) {\n\t\t\t\t\tif ($event.dataTransfer.effectAllowed === 'copy' || $event.dataTransfer.effectAllowed === 'copyMove' && $event.ctrlKey) {\n\t\t\t\t\t\t$($event.target).addClass('copy');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis._$scope.dragEnd = function ($event) {\n\t\t\t\t\t$($event.target).removeClass('copy');\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn TasksController;\n\t\t}();\n\t\treturn new TasksController($scope, $window, $routeParams, TasksModel, ListsModel, CollectionsModel, TasksBusinessLayer, $location, SettingsBusinessLayer, SearchBusinessLayer, VTodo, SettingsModel);\n\t}]);\n}).call(undefined);","'use strict';\n\nangular.module('Tasks').directive('appNavigationEntryUtils', function () {\n  'use strict';\n\n  return {\n    restrict: 'C',\n    link: function link(scope, elm) {\n      var button, menu;\n      menu = elm.siblings('.app-navigation-entry-menu');\n      button = $(elm).find('.app-navigation-entry-utils-menu-button button');\n      button.click(function () {\n        menu.toggleClass('open');\n      });\n      scope.$on('documentClicked', function (scope, event) {\n        if (event.target !== button[0]) {\n          menu.removeClass('open');\n        }\n      });\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').directive('autofocusOnInsert', function () {\n  'use strict';\n\n  return function (scope, elm) {\n    return elm.focus();\n  };\n});","'use strict';\n\nangular.module('Tasks').directive('avatar', function () {\n  'use strict';\n\n  return {\n    restrict: 'A',\n    scope: false,\n    link: function link(scope, elm, attr) {\n      return attr.$observe('userid', function () {\n        if (attr.userid) {\n          return elm.avatar(attr.userid, attr.size);\n        }\n      });\n    }\n  };\n});","'use strict';\n\nvar hslToRgb = function hslToRgb(hue, saturation, lightness) {\n\t'use strict';\n\t// based on algorithm from http://en.wikipedia.org/wiki/HSL_and_HSV#Converting_to_RGB\n\n\tif (Array.isArray(hue)) {\n\t\tsaturation = hue[1];\n\t\tlightness = hue[2];\n\t\thue = hue[0];\n\t}\n\tif (hue === undefined) {\n\t\treturn [0, 0, 0];\n\t}\n\tsaturation /= 100;\n\tlightness /= 100;\n\n\tvar chroma = (1 - Math.abs(2 * lightness - 1)) * saturation;\n\tvar huePrime = hue / 60;\n\tvar secondComponent = chroma * (1 - Math.abs(huePrime % 2 - 1));\n\n\thuePrime = Math.floor(huePrime);\n\tvar red;\n\tvar green;\n\tvar blue;\n\n\tif (huePrime === 0) {\n\t\tred = chroma;\n\t\tgreen = secondComponent;\n\t\tblue = 0;\n\t} else if (huePrime === 1) {\n\t\tred = secondComponent;\n\t\tgreen = chroma;\n\t\tblue = 0;\n\t} else if (huePrime === 2) {\n\t\tred = 0;\n\t\tgreen = chroma;\n\t\tblue = secondComponent;\n\t} else if (huePrime === 3) {\n\t\tred = 0;\n\t\tgreen = secondComponent;\n\t\tblue = chroma;\n\t} else if (huePrime === 4) {\n\t\tred = secondComponent;\n\t\tgreen = 0;\n\t\tblue = chroma;\n\t} else if (huePrime === 5) {\n\t\tred = chroma;\n\t\tgreen = 0;\n\t\tblue = secondComponent;\n\t}\n\n\tvar lightnessAdjustment = lightness - chroma / 2;\n\tred += lightnessAdjustment;\n\tgreen += lightnessAdjustment;\n\tblue += lightnessAdjustment;\n\n\treturn [Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255)];\n};\n\nvar rgbToHex = function rgbToHex(r, g, b) {\n\t'use strict';\n\n\tif (Array.isArray(r)) {\n\t\tg = r[1];\n\t\tb = r[2];\n\t\tr = r[0];\n\t}\n\treturn '#' + parseInt(r, 10).toString(16) + parseInt(g, 10).toString(16) + parseInt(b, 10).toString(16);\n};\n\nvar listofcolours = ['#31CC7C', '#317CCC', '#FF7A66', '#F1DB50', '#7C31CC', '#CC317C', '#3A3B3D', '#CACBCD'];\n\nvar randColour = function randColour() {\n\t'use strict';\n\n\tif (typeof String.prototype.toHsl === 'function') {\n\t\treturn rgbToHex(hslToRgb(Math.random().toString().toHsl()));\n\t} else {\n\t\treturn listofcolours[Math.floor(Math.random() * listofcolours.length)];\n\t}\n};\n\nangular.module('Tasks').directive('colorpicker', function () {\n\t'use strict';\n\n\tif (typeof String.prototype.toHsl === 'function') {\n\t\tvar hsl = \"\";\n\t\tvar hslcolour = \"\";\n\t\t//\t\t  0    40   80   120  160  200   240  280  320\n\t\tlistofcolours = [\"15\", \"9\", \"4\", \"b\", \"6\", \"11\", \"74\", \"f\", \"57\"];\n\t\tlistofcolours.forEach(function (hash, index) {\n\t\t\thsl = hash.toHsl();\n\t\t\thslcolour = hslToRgb(hsl);\n\t\t\tlistofcolours[index] = rgbToHex(hslcolour);\n\t\t});\n\t}\n\treturn {\n\t\tscope: {\n\t\t\tselected: '=',\n\t\t\tcustomizedColors: '=colors'\n\t\t},\n\t\trestrict: 'AE',\n\t\ttemplateUrl: OC.filePath('tasks', 'templates', 'colorpicker.html'),\n\t\tlink: function link(scope, element, attr) {\n\t\t\tscope.colors = scope.customizedColors || listofcolours;\n\t\t\tscope.selected = scope.selected || scope.colors[0];\n\t\t\tscope.random = \"#000000\";\n\n\t\t\tscope.randomizeColour = function () {\n\t\t\t\tscope.random = randColour();\n\t\t\t\tscope.pick(scope.random);\n\t\t\t};\n\n\t\t\tscope.pick = function (color) {\n\t\t\t\tscope.selected = color;\n\t\t\t};\n\t\t}\n\t};\n});","'use strict';\n\nangular.module('Tasks').directive('confirmation', function () {\n\t'use strict';\n\n\treturn {\n\t\tpriority: -1,\n\t\trestrict: 'A',\n\t\ttemplateUrl: OC.generateUrl('/apps/tasks/templates/confirmation', {}),\n\t\tscope: {\n\t\t\tconfirmationFunction: \"&confirmation\",\n\t\t\tconfirmationMessage: \"&confirmationMessage\"\n\n\t\t},\n\t\tcontroller: 'ConfirmationController'\n\t};\n});\n\nangular.module('Tasks').controller('ConfirmationController', ['$scope', '$rootScope', '$element', '$attrs', '$compile', '$document', '$window', '$timeout', function ($scope, $rootScope, $element, $attrs, $compile, $document, $window, $timeout) {\n\t'use strict';\n\n\tvar ConfirmationController = function () {\n\t\tfunction ConfirmationController(_$scope, $rootScope, $element, $attrs, $compile, $document, $window, $timeout) {\n\t\t\tthis._$scope = _$scope;\n\t\t\tthis._$scope.countdown = 3;\n\n\t\t\t$element.bind('click', function (e) {\n\t\t\t\t_$scope.countdown = 3;\n\t\t\t\t$element.removeClass('active');\n\t\t\t\tvar message = _$scope.confirmationMessage() ? _$scope.confirmationMessage() : \"Are you sure?\";\n\t\t\t\tif ($element.hasClass('confirmed')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\te.stopPropagation();\n\t\t\t\t_$scope.activate();\n\t\t\t\t$element.children('.confirmation-confirm').tooltip({ title: message, container: 'body', placement: 'right' });\n\t\t\t\t$element.addClass(\"confirmed\");\n\t\t\t});\n\n\t\t\t$element.children('.confirmation-confirm').bind('click', function (e) {\n\t\t\t\tif ($element.hasClass('confirmed active')) {\n\t\t\t\t\t_$scope.confirmationFunction();\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis._$scope.documentClick = function () {\n\t\t\t\t$element.removeClass(\"confirmed\");\n\t\t\t};\n\n\t\t\tthis._$scope.activate = function () {\n\t\t\t\tif (_$scope.countdown) {\n\t\t\t\t\t$element.find('.countdown').html(_$scope.countdown + ' s');\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\t_$scope.activate();\n\t\t\t\t\t}, 1000);\n\t\t\t\t\t_$scope.countdown--;\n\t\t\t\t} else {\n\t\t\t\t\t$element.addClass('active');\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$document.bind('click', _$scope.documentClick);\n\t\t\t$document.bind('touchend', _$scope.documentClick);\n\n\t\t\t$scope.$on('$destroy', function () {\n\t\t\t\t$document.unbind('click', _$scope.documentClick);\n\t\t\t\t$document.unbind('touchend', _$scope.documentClick);\n\t\t\t});\n\t\t}\n\t\treturn ConfirmationController;\n\t}();\n\treturn new ConfirmationController($scope, $rootScope, $element, $attrs, $compile, $document, $window, $timeout);\n}]);","'use strict';\n\nangular.module('Tasks').directive('datepicker', function () {\n\t'use strict';\n\n\treturn {\n\t\trestrict: 'A',\n\t\tscope: false,\n\t\tlink: function link(scope, elm, attr) {\n\t\t\treturn elm.datepicker({\n\t\t\t\tonSelect: function onSelect(date, inst) {\n\t\t\t\t\tscope['set' + attr.datepicker + 'day'](date);\n\t\t\t\t\treturn scope.$apply();\n\t\t\t\t},\n\t\t\t\tbeforeShow: function beforeShow(input, inst) {\n\t\t\t\t\tvar dp, marginLeft;\n\t\t\t\t\tdp = $(inst).datepicker('widget');\n\t\t\t\t\tmarginLeft = -Math.abs($(input).outerWidth() - dp.outerWidth()) / 2 + 'px';\n\t\t\t\t\tdp.css({\n\t\t\t\t\t\t'margin-left': marginLeft\n\t\t\t\t\t});\n\t\t\t\t\t$(\"div.ui-datepicker:before\").css({\n\t\t\t\t\t\t'left': 100 + 'px'\n\t\t\t\t\t});\n\t\t\t\t\treturn $('.hasDatepicker').datepicker(\"option\", \"firstDay\", scope.settingsmodel.getById('various').startOfWeek);\n\t\t\t\t},\n\t\t\t\tbeforeShowDay: function beforeShowDay(date) {\n\t\t\t\t\tif (moment(date).startOf('day').diff(moment(scope.task[attr.datepicker], \"YYYYMMDDTHHmmss\").startOf('day'), 'days') === 0) {\n\t\t\t\t\t\treturn [1, \"selected\"];\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn [1, \"\"];\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tminDate: null\n\t\t\t});\n\t\t}\n\t};\n});","'use strict';\n\nangular.module('Tasks').directive('ocClickFocus', ['$timeout', function ($timeout) {\n  'use strict';\n\n  return function (scope, elm, attr) {\n    var options;\n    options = scope.$eval(attr.ocClickFocus);\n    if (angular.isDefined(options) && angular.isDefined(options.selector)) {\n      return elm.click(function () {\n        if (angular.isDefined(options.timeout)) {\n          return $timeout(function () {\n            return $(options.selector).focus();\n          }, options.timeout);\n        } else {\n          return $(options.selector).focus();\n        }\n      });\n    }\n  };\n}]);","'use strict';\n\nangular.module('Tasks').directive('timepicker', function () {\n  'use strict';\n\n  return {\n    restrict: 'A',\n    link: function link(scope, elm, attr) {\n      return elm.timepicker({\n        onSelect: function onSelect(date, inst) {\n          scope['set' + attr.timepicker + 'time'](date);\n          return scope.$apply();\n        },\n        myPosition: 'center top',\n        atPosition: 'center bottom',\n        hourText: t('tasks', 'Hours'),\n        minuteText: t('tasks', 'Minutes')\n      });\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').directive('watchTop', function () {\n  'use strict';\n\n  return {\n    restrict: 'A',\n    link: function link(scope, element, attr) {\n      ({\n        scope: {\n          \"divTop\": \"=\"\n        }\n      });\n      return scope.$watch(function () {\n        scope.divTop = element.prev().outerHeight(true);\n      });\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('counterFormatter', function () {\n  'use strict';\n\n  return function (count) {\n    switch (false) {\n      case count !== 0:\n        return '';\n      case count < 999:\n        return '999+';\n      default:\n        return count;\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('dateDetails', function () {\n  'use strict';\n\n  return function (due) {\n    if (moment(due, \"YYYYMMDDTHHmmss\").isValid()) {\n      return moment(due, \"YYYYMMDDTHHmmss\").locale(due.isDate ? 'details_allday' : 'details').calendar();\n    } else {\n      return t('tasks', 'Set due date');\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('dateDetailsShort', function () {\n  'use strict';\n\n  return function (reminder) {\n    if (moment(reminder, \"YYYYMMDDTHHmmss\").isValid()) {\n      return moment(reminder, \"YYYYMMDDTHHmmss\").locale('details_short').calendar();\n    } else {\n      return '';\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('dateFromNow', function () {\n  'use strict';\n\n  return function (due) {\n    if (moment(due, \"YYYYMMDDTHHmmss\").isValid()) {\n      return moment(due, \"YYYYMMDDTHHmmss\").fromNow();\n    } else {\n      return '';\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('dateTaskList', function () {\n  'use strict';\n\n  return function (due) {\n    if (moment(due, \"YYYYMMDDTHHmmss\").isValid()) {\n      return moment(due, \"YYYYMMDDTHHmmss\").locale('tasks').calendar();\n    } else {\n      return '';\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('day', function () {\n  'use strict';\n\n  return function (i) {\n    return moment().add('days', i).locale('list_week').calendar();\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('dayTaskList', function () {\n  'use strict';\n\n  return function (due) {\n    if (moment(due, \"YYYYMMDDTHHmmss\").isValid()) {\n      return moment(due, \"YYYYMMDDTHHmmss\").locale('tasks').calendar();\n    } else {\n      return '';\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('percentDetails', function () {\n  'use strict';\n\n  return function (percent) {\n    return t('tasks', '%s %% completed').replace('%s', percent).replace('%%', '%');\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('priorityDetails', function () {\n  'use strict';\n\n  return function (priority) {\n    var string;\n    string = t('tasks', 'priority %s: ').replace('%s', priority);\n    if (+priority === 6 || +priority === 7 || +priority === 8 || +priority === 9) {\n      return string + ' ' + t('tasks', 'high');\n    } else if (+priority === 5) {\n      return string + ' ' + t('tasks', 'medium');\n    } else if (+priority === 1 || +priority === 2 || +priority === 3 || +priority === 4) {\n      return string + ' ' + t('tasks', 'low');\n    } else {\n      return t('tasks', 'no priority assigned');\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('reminderDetails', function () {\n\t'use strict';\n\n\treturn function (reminder, scope) {\n\t\tvar ds, time, token, _i, _len, _ref;\n\t\tif (!(angular.isUndefined(reminder) || reminder === null)) {\n\t\t\tif (reminder.type === 'DATE-TIME' && moment(reminder.date, \"YYYYMMDDTHHmmss\").isValid()) {\n\t\t\t\treturn moment(reminder.date, \"YYYYMMDDTHHmmss\").locale('reminder').calendar();\n\t\t\t} else if (reminder.type === 'DURATION' && reminder.duration) {\n\t\t\t\tds = t('tasks', 'Remind me');\n\t\t\t\t_ref = scope.durations;\n\t\t\t\tfor (_i = 0, _len = _ref.length; _i < _len; _i++) {\n\t\t\t\t\ttoken = _ref[_i];\n\t\t\t\t\tif (+reminder.duration[token.id]) {\n\t\t\t\t\t\ttime = 1;\n\t\t\t\t\t\tds += ' ' + reminder.duration[token.id] + ' ';\n\t\t\t\t\t\tif (+reminder.duration[token.id] === 1) {\n\t\t\t\t\t\t\tds += token.name;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tds += token.names;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!time) {\n\t\t\t\t\tif (reminder.duration.params.related === 'END') {\n\t\t\t\t\t\tds += ' ' + t('tasks', 'at the end');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tds += ' ' + t('tasks', 'at the beginning');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (reminder.duration.params.invert) {\n\t\t\t\t\t\tif (reminder.duration.params.related === 'END') {\n\t\t\t\t\t\t\tds += ' ' + t('tasks', 'before end');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tds += ' ' + t('tasks', 'before beginning');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (reminder.duration.params.related === 'END') {\n\t\t\t\t\t\t\tds += ' ' + t('tasks', 'after end');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tds += ' ' + t('tasks', 'after beginning');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn ds;\n\t\t\t} else {\n\t\t\t\treturn t('tasks', 'Remind me');\n\t\t\t}\n\t\t} else {\n\t\t\treturn t('tasks', 'Remind me');\n\t\t}\n\t};\n});","'use strict';\n\nangular.module('Tasks').filter('startDetails', function () {\n  'use strict';\n\n  return function (due) {\n    if (moment(due, \"YYYYMMDDTHHmmss\").isValid()) {\n      return moment(due, \"YYYYMMDDTHHmmss\").locale(due.isDate ? 'start_allday' : 'start').calendar();\n    } else {\n      return t('tasks', 'Set start date');\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').filter('timeTaskList', function () {\n  'use strict';\n\n  return function (due) {\n    if (moment(due, \"YYYYMMDDTHHmmss\").isValid()) {\n      return moment(due, \"YYYYMMDDTHHmmss\").format('HH:mm');\n    } else {\n      return '';\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').service('CalendarService', ['DavClient', 'Calendar', function (DavClient, Calendar) {\n\t'use strict';\n\n\tvar _this = this;\n\n\tthis._CALENDAR_HOME = null;\n\n\tthis._currentUserPrincipal = null;\n\n\tthis._takenUrls = [];\n\n\tthis._PROPERTIES = ['{' + DavClient.NS_DAV + '}displayname', '{' + DavClient.NS_IETF + '}calendar-description', '{' + DavClient.NS_IETF + '}calendar-timezone', '{' + DavClient.NS_APPLE + '}calendar-order', '{' + DavClient.NS_APPLE + '}calendar-color', '{' + DavClient.NS_IETF + '}supported-calendar-component-set', '{' + DavClient.NS_OWNCLOUD + '}calendar-enabled', '{' + DavClient.NS_DAV + '}acl', '{' + DavClient.NS_DAV + '}owner', '{' + DavClient.NS_OWNCLOUD + '}invite'];\n\n\tfunction discoverHome(callback) {\n\t\treturn DavClient.propFind(DavClient.buildUrl(OC.linkToRemoteBase('dav')), ['{' + DavClient.NS_DAV + '}current-user-principal'], 0, { 'requesttoken': OC.requestToken }).then(function (response) {\n\t\t\tif (!DavClient.wasRequestSuccessful(response.status)) {\n\t\t\t\tthrow \"CalDAV client could not be initialized - Querying current-user-principal failed\";\n\t\t\t}\n\n\t\t\tif (response.body.propStat.length < 1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar props = response.body.propStat[0].properties;\n\t\t\t_this._currentUserPrincipal = props['{' + DavClient.NS_DAV + '}current-user-principal'][0].textContent;\n\n\t\t\treturn DavClient.propFind(DavClient.buildUrl(_this._currentUserPrincipal), ['{' + DavClient.NS_IETF + '}calendar-home-set'], 0, { 'requesttoken': OC.requestToken }).then(function (response) {\n\t\t\t\tif (!DavClient.wasRequestSuccessful(response.status)) {\n\t\t\t\t\tthrow \"CalDAV client could not be initialized - Querying calendar-home-set failed\";\n\t\t\t\t}\n\n\t\t\t\tif (response.body.propStat.length < 1) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar props = response.body.propStat[0].properties;\n\t\t\t\t_this._CALENDAR_HOME = props['{' + DavClient.NS_IETF + '}calendar-home-set'][0].textContent;\n\n\t\t\t\treturn callback();\n\t\t\t});\n\t\t});\n\t}\n\n\tfunction getResponseCodeFromHTTPResponse(t) {\n\t\treturn parseInt(t.split(' ')[1]);\n\t}\n\n\tthis.getAll = function () {\n\t\tif (this._CALENDAR_HOME === null) {\n\t\t\treturn discoverHome(function () {\n\t\t\t\treturn _this.getAll();\n\t\t\t});\n\t\t}\n\n\t\tvar prom = DavClient.propFind(DavClient.buildUrl(this._CALENDAR_HOME), this._PROPERTIES, 1, { 'requesttoken': OC.requestToken }).then(function (response) {\n\t\t\tvar calendars = [];\n\n\t\t\tif (!DavClient.wasRequestSuccessful(response.status)) {\n\t\t\t\tthrow \"CalDAV client could not be initialized - Querying calendars failed\";\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < response.body.length; i++) {\n\t\t\t\tvar body = response.body[i];\n\t\t\t\tif (body.propStat.length < 1) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t_this._takenUrls.push(body.href);\n\n\t\t\t\tvar responseCode = getResponseCodeFromHTTPResponse(body.propStat[0].status);\n\t\t\t\tif (!DavClient.wasRequestSuccessful(responseCode)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvar doesSupportVTodo = false;\n\t\t\t\tvar components = body.propStat[0].properties['{urn:ietf:params:xml:ns:caldav}supported-calendar-component-set'];\n\t\t\t\tif (components) {\n\t\t\t\t\tfor (var j = 0; j < components.length; j++) {\n\t\t\t\t\t\tvar name = components[j].attributes.getNamedItem('name').textContent.toLowerCase();\n\t\t\t\t\t\tif (name === 'vtodo') {\n\t\t\t\t\t\t\tdoesSupportVTodo = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!doesSupportVTodo) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t_this._getACLFromResponse(body);\n\n\t\t\t\tvar uri = body.href.substr(_this._CALENDAR_HOME.length).replace(/[^\\w\\-]+/g, '');\n\n\t\t\t\tvar calendar = new Calendar(body.href, body.propStat[0].properties, uri);\n\t\t\t\tcalendars.push(calendar);\n\t\t\t}\n\n\t\t\treturn calendars;\n\t\t});\n\t\treturn prom;\n\t};\n\n\tthis.get = function (url) {\n\t\tif (this._CALENDAR_HOME === null) {\n\t\t\treturn discoverHome(function () {\n\t\t\t\treturn _this.get(url);\n\t\t\t});\n\t\t}\n\n\t\treturn DavClient.propFind(DavClient.buildUrl(url), this._PROPERTIES, 0, { 'requesttoken': OC.requestToken }).then(function (response) {\n\t\t\tvar body = response.body;\n\t\t\tif (body.propStat.length < 1) {\n\t\t\t\t//TODO - something went wrong\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar responseCode = getResponseCodeFromHTTPResponse(body.propStat[0].status);\n\t\t\tif (!DavClient.wasRequestSuccessful(responseCode)) {\n\t\t\t\t//TODO - something went wrong\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_this._getACLFromResponse(body);\n\n\t\t\tvar uri = body.href.substr(_this._CALENDAR_HOME.length).replace(/[^\\w\\-]+/g, '');\n\n\t\t\treturn new Calendar(body.href, body.propStat[0].properties, uri);\n\t\t});\n\t};\n\n\tthis.create = function (name, color, components) {\n\t\tif (this._CALENDAR_HOME === null) {\n\t\t\treturn discoverHome(function () {\n\t\t\t\treturn _this.create(name, color);\n\t\t\t});\n\t\t}\n\n\t\tif (typeof components === 'undefined') {\n\t\t\tcomponents = ['vtodo'];\n\t\t}\n\n\t\tvar xmlDoc = document.implementation.createDocument('', '', null);\n\t\tvar cMkcalendar = xmlDoc.createElement('c:mkcalendar');\n\t\tcMkcalendar.setAttribute('xmlns:c', 'urn:ietf:params:xml:ns:caldav');\n\t\tcMkcalendar.setAttribute('xmlns:d', 'DAV:');\n\t\tcMkcalendar.setAttribute('xmlns:a', 'http://apple.com/ns/ical/');\n\t\tcMkcalendar.setAttribute('xmlns:o', 'http://owncloud.org/ns');\n\t\txmlDoc.appendChild(cMkcalendar);\n\n\t\tvar dSet = xmlDoc.createElement('d:set');\n\t\tcMkcalendar.appendChild(dSet);\n\n\t\tvar dProp = xmlDoc.createElement('d:prop');\n\t\tdSet.appendChild(dProp);\n\n\t\tdProp.appendChild(this._createXMLForProperty(xmlDoc, 'displayname', name));\n\t\tdProp.appendChild(this._createXMLForProperty(xmlDoc, 'enabled', true));\n\t\tdProp.appendChild(this._createXMLForProperty(xmlDoc, 'color', color));\n\t\tdProp.appendChild(this._createXMLForProperty(xmlDoc, 'components', components));\n\n\t\tvar body = cMkcalendar.outerHTML;\n\n\t\tvar uri = this._suggestUri(name);\n\t\tvar url = this._CALENDAR_HOME + uri + '/';\n\t\tvar headers = {\n\t\t\t'Content-Type': 'application/xml; charset=utf-8',\n\t\t\t'requesttoken': OC.requestToken\n\t\t};\n\n\t\treturn DavClient.request('MKCALENDAR', url, headers, body).then(function (response) {\n\t\t\tif (response.status === 201) {\n\t\t\t\t_this._takenUrls.push(url);\n\t\t\t\treturn _this.get(url).then(function (calendar) {\n\t\t\t\t\tcalendar.enabled = true;\n\t\t\t\t\treturn _this.update(calendar);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\tthis.update = function (calendar) {\n\t\tvar xmlDoc = document.implementation.createDocument('', '', null);\n\t\tvar dPropUpdate = xmlDoc.createElement('d:propertyupdate');\n\t\tdPropUpdate.setAttribute('xmlns:c', 'urn:ietf:params:xml:ns:caldav');\n\t\tdPropUpdate.setAttribute('xmlns:d', 'DAV:');\n\t\tdPropUpdate.setAttribute('xmlns:a', 'http://apple.com/ns/ical/');\n\t\tdPropUpdate.setAttribute('xmlns:o', 'http://owncloud.org/ns');\n\t\txmlDoc.appendChild(dPropUpdate);\n\n\t\tvar dSet = xmlDoc.createElement('d:set');\n\t\tdPropUpdate.appendChild(dSet);\n\n\t\tvar dProp = xmlDoc.createElement('d:prop');\n\t\tdSet.appendChild(dProp);\n\n\t\tvar updatedProperties = calendar.updatedProperties;\n\t\tcalendar.resetUpdatedProperties();\n\t\tfor (var i = 0; i < updatedProperties.length; i++) {\n\t\t\tdProp.appendChild(this._createXMLForProperty(xmlDoc, updatedProperties[i], calendar[updatedProperties[i]]));\n\t\t}\n\n\t\tvar url = calendar.url;\n\t\tvar body = dPropUpdate.outerHTML;\n\t\tvar headers = {\n\t\t\t'Content-Type': 'application/xml; charset=utf-8',\n\t\t\t'requesttoken': OC.requestToken\n\t\t};\n\n\t\treturn DavClient.request('PROPPATCH', url, headers, body).then(function (response) {\n\t\t\treturn calendar;\n\t\t});\n\t};\n\n\tthis.delete = function (calendar) {\n\t\treturn DavClient.request('DELETE', calendar.url, { 'requesttoken': OC.requestToken }, '').then(function (response) {\n\t\t\tif (response.status === 204) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\t// TODO - handle error case\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t};\n\n\tthis.share = function (calendar, shareType, shareWith, writable, existingShare) {\n\t\tvar xmlDoc = document.implementation.createDocument('', '', null);\n\t\tvar oShare = xmlDoc.createElement('o:share');\n\t\toShare.setAttribute('xmlns:d', 'DAV:');\n\t\toShare.setAttribute('xmlns:o', 'http://owncloud.org/ns');\n\t\txmlDoc.appendChild(oShare);\n\n\t\tvar oSet = xmlDoc.createElement('o:set');\n\t\toShare.appendChild(oSet);\n\n\t\tvar dHref = xmlDoc.createElement('d:href');\n\t\tif (shareType === OC.Share.SHARE_TYPE_USER) {\n\t\t\tdHref.textContent = 'principal:principals/users/';\n\t\t} else if (shareType === OC.Share.SHARE_TYPE_GROUP) {\n\t\t\tdHref.textContent = 'principal:principals/groups/';\n\t\t}\n\t\tdHref.textContent += shareWith;\n\t\toSet.appendChild(dHref);\n\n\t\tvar oSummary = xmlDoc.createElement('o:summary');\n\t\toSummary.textContent = t('calendar', '{calendar} shared by {owner}', {\n\t\t\tcalendar: calendar.displayname,\n\t\t\towner: calendar.owner\n\t\t});\n\t\toSet.appendChild(oSummary);\n\n\t\tif (writable) {\n\t\t\tvar oRW = xmlDoc.createElement('o:read-write');\n\t\t\toSet.appendChild(oRW);\n\t\t}\n\n\t\tvar headers = {\n\t\t\t'Content-Type': 'application/xml; charset=utf-8',\n\t\t\trequesttoken: oc_requesttoken\n\t\t};\n\t\tvar body = oShare.outerHTML;\n\t\treturn DavClient.request('POST', calendar.url, headers, body).then(function (response) {\n\t\t\tif (response.status === 200) {\n\t\t\t\tif (!existingShare) {\n\t\t\t\t\tif (shareType === OC.Share.SHARE_TYPE_USER) {\n\t\t\t\t\t\tcalendar.sharedWith.users.push({\n\t\t\t\t\t\t\tid: shareWith,\n\t\t\t\t\t\t\tdisplayname: shareWith,\n\t\t\t\t\t\t\twritable: writable\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if (shareType === OC.Share.SHARE_TYPE_GROUP) {\n\t\t\t\t\t\tcalendar.sharedWith.groups.push({\n\t\t\t\t\t\t\tid: shareWith,\n\t\t\t\t\t\t\tdisplayname: shareWith,\n\t\t\t\t\t\t\twritable: writable\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\tthis.unshare = function (calendar, shareType, shareWith) {\n\t\tvar xmlDoc = document.implementation.createDocument('', '', null);\n\t\tvar oShare = xmlDoc.createElement('o:share');\n\t\toShare.setAttribute('xmlns:d', 'DAV:');\n\t\toShare.setAttribute('xmlns:o', 'http://owncloud.org/ns');\n\t\txmlDoc.appendChild(oShare);\n\n\t\tvar oRemove = xmlDoc.createElement('o:remove');\n\t\toShare.appendChild(oRemove);\n\n\t\tvar dHref = xmlDoc.createElement('d:href');\n\t\tif (shareType === OC.Share.SHARE_TYPE_USER) {\n\t\t\tdHref.textContent = 'principal:principals/users/';\n\t\t} else if (shareType === OC.Share.SHARE_TYPE_GROUP) {\n\t\t\tdHref.textContent = 'principal:principals/groups/';\n\t\t}\n\t\tdHref.textContent += shareWith;\n\t\toRemove.appendChild(dHref);\n\n\t\tvar headers = {\n\t\t\t'Content-Type': 'application/xml; charset=utf-8',\n\t\t\trequesttoken: oc_requesttoken\n\t\t};\n\t\tvar body = oShare.outerHTML;\n\t\treturn DavClient.request('POST', calendar.url, headers, body).then(function (response) {\n\t\t\tif (response.status === 200) {\n\t\t\t\tif (shareType === OC.Share.SHARE_TYPE_USER) {\n\t\t\t\t\tcalendar.sharedWith.users = calendar.sharedWith.users.filter(function (user) {\n\t\t\t\t\t\treturn user.id !== shareWith;\n\t\t\t\t\t});\n\t\t\t\t} else if (shareType === OC.Share.SHARE_TYPE_GROUP) {\n\t\t\t\t\tcalendar.sharedWith.groups = calendar.sharedWith.groups.filter(function (groups) {\n\t\t\t\t\t\treturn groups.id !== shareWith;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t//todo - remove entry from calendar object\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t};\n\n\tthis._createXMLForProperty = function (xmlDoc, propName, value) {\n\t\tswitch (propName) {\n\t\t\tcase 'enabled':\n\t\t\t\tvar oEnabled = xmlDoc.createElement('o:calendar-enabled');\n\t\t\t\toEnabled.textContent = value ? '1' : '0';\n\t\t\t\treturn oEnabled;\n\n\t\t\tcase 'displayname':\n\t\t\t\tvar dDisplayname = xmlDoc.createElement('d:displayname');\n\t\t\t\tdDisplayname.textContent = value;\n\t\t\t\treturn dDisplayname;\n\n\t\t\tcase 'order':\n\t\t\t\tvar aOrder = xmlDoc.createElement('a:calendar-color');\n\t\t\t\taOrder.textContent = value;\n\t\t\t\treturn aOrder;\n\n\t\t\tcase 'color':\n\t\t\t\tvar aColor = xmlDoc.createElement('a:calendar-color');\n\t\t\t\taColor.textContent = value;\n\t\t\t\treturn aColor;\n\n\t\t\tcase 'components':\n\t\t\t\tvar cComponents = xmlDoc.createElement('c:supported-calendar-component-set');\n\t\t\t\tfor (var i = 0; i < value.length; i++) {\n\t\t\t\t\tvar cComp = xmlDoc.createElement('c:comp');\n\t\t\t\t\tcComp.setAttribute('name', value[i].toUpperCase());\n\t\t\t\t\tcComponents.appendChild(cComp);\n\t\t\t\t}\n\t\t\t\treturn cComponents;\n\t\t}\n\t};\n\n\tthis._getACLFromResponse = function (body) {\n\t\tvar canWrite = false;\n\t\tvar acl = body.propStat[0].properties['{' + DavClient.NS_DAV + '}acl'];\n\t\tif (acl) {\n\t\t\tfor (var k = 0; k < acl.length; k++) {\n\t\t\t\tvar href = acl[k].getElementsByTagNameNS('DAV:', 'href');\n\t\t\t\tif (href.length === 0) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\thref = href[0].textContent;\n\t\t\t\tif (href !== _this._currentUserPrincipal) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tvar writeNode = acl[k].getElementsByTagNameNS('DAV:', 'write');\n\t\t\t\tif (writeNode.length > 0) {\n\t\t\t\t\tcanWrite = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tbody.propStat[0].properties.canWrite = canWrite;\n\t};\n\n\tthis._isUriAlreadyTaken = function (uri) {\n\t\treturn this._takenUrls.indexOf(this._CALENDAR_HOME + uri + '/') !== -1;\n\t};\n\n\tthis._suggestUri = function (displayname) {\n\t\tvar uri = displayname.toString().toLowerCase().replace(/\\s+/g, '-') // Replace spaces with -\n\t\t.replace(/[^\\w\\-]+/g, '') // Remove all non-word chars\n\t\t.replace(/\\-\\-+/g, '-') // Replace multiple - with single -\n\t\t.replace(/^-+/, '') // Trim - from start of text\n\t\t.replace(/-+$/, ''); // Trim - from end of text\n\n\t\tif (!this._isUriAlreadyTaken(uri)) {\n\t\t\treturn uri;\n\t\t}\n\n\t\tif (uri.indexOf('-') === -1) {\n\t\t\turi = uri + '-1';\n\t\t\tif (!this._isUriAlreadyTaken(uri)) {\n\t\t\t\treturn uri;\n\t\t\t}\n\t\t}\n\n\t\twhile (this._isUriAlreadyTaken(uri)) {\n\t\t\tvar positionLastDash = uri.lastIndexOf('-');\n\t\t\tvar firstPart = uri.substr(0, positionLastDash);\n\t\t\tvar lastPart = uri.substr(positionLastDash + 1);\n\n\t\t\tif (lastPart.match(/^\\d+$/)) {\n\t\t\t\tlastPart = parseInt(lastPart);\n\t\t\t\tlastPart++;\n\n\t\t\t\turi = firstPart + '-' + lastPart;\n\t\t\t} else if (lastPart === '') {\n\t\t\t\turi = uri + '1';\n\t\t\t} else {\n\t\t\t\turi = uri = '-1';\n\t\t\t}\n\t\t}\n\n\t\treturn uri;\n\t};\n}]);","'use strict';\n\nangular.module('Tasks').service('DavClient', [function () {\n\t'use strict';\n\n\tvar client;\n\tclient = new dav.Client({\n\t\tbaseUrl: OC.linkToRemote('dav/calendars'),\n\t\txmlNamespaces: {\n\t\t\t'DAV:': 'd',\n\t\t\t'urn:ietf:params:xml:ns:caldav': 'c',\n\t\t\t'http://apple.com/ns/ical/': 'aapl',\n\t\t\t'http://owncloud.org/ns': 'oc',\n\t\t\t'http://nextcloud.com/ns': 'nc',\n\t\t\t'http://calendarserver.org/ns/': 'cs'\n\t\t}\n\t});\n\tangular.extend(client, {\n\t\tNS_DAV: 'DAV:',\n\t\tNS_IETF: 'urn:ietf:params:xml:ns:caldav',\n\t\tNS_APPLE: 'http://apple.com/ns/ical/',\n\t\tNS_OWNCLOUD: 'http://owncloud.org/ns',\n\t\tNS_NEXTCLOUD: 'http://nextcloud.com/ns',\n\t\tNS_CALENDARSERVER: 'http://calendarserver.org/ns/',\n\t\tbuildUrl: function buildUrl(path) {\n\t\t\treturn window.location.protocol + '//' + window.location.host + path;\n\t\t},\n\t\twasRequestSuccessful: function wasRequestSuccessful(status) {\n\t\t\treturn status >= 200 && status <= 299;\n\t\t}\n\t});\n\treturn client;\n}]);","'use strict';\n\nangular.module('Tasks').service('ICalFactory', [function () {\n  'use strict';\n\n  // creates a new ICAL root element with a product id property\n\n  return {\n    new: function _new() {\n      var root = new ICAL.Component(['vcalendar', [], []]);\n\n      var version = angular.element('#app').attr('data-appVersion');\n      root.updatePropertyWithValue('prodid', '-//Nextcloud Tasks v' + version);\n\n      return root;\n    }\n  };\n}]);","'use strict';\n\nangular.module('Tasks').factory('Loading', [function () {\n\t'use strict';\n\n\tvar Loading = function () {\n\t\tfunction Loading() {\n\t\t\tthis.count = 0;\n\t\t}\n\n\t\tLoading.prototype.increase = function () {\n\t\t\treturn this.count += 1;\n\t\t};\n\n\t\tLoading.prototype.decrease = function () {\n\t\t\treturn this.count -= 1;\n\t\t};\n\n\t\tLoading.prototype.getCount = function () {\n\t\t\treturn this.count;\n\t\t};\n\n\t\tLoading.prototype.isLoading = function () {\n\t\t\treturn this.count > 0;\n\t\t};\n\n\t\treturn Loading;\n\t}();\n\treturn new Loading();\n}]);","'use strict';\n\n(function () {\n\t'use strict';\n\n\tangular.module('Tasks').factory('_Model', [function () {\n\t\tvar Model;\n\t\tModel = function () {\n\t\t\tfunction Model() {\n\t\t\t\tthis._data = [];\n\t\t\t\tthis._dataMap = {};\n\t\t\t\tthis._filterCache = {};\n\t\t\t}\n\n\t\t\tModel.prototype.handle = function (data) {\n\t\t\t\tvar item, _i, _len, _results;\n\t\t\t\t_results = [];\n\t\t\t\tfor (_i = 0, _len = data.length; _i < _len; _i++) {\n\t\t\t\t\titem = data[_i];\n\t\t\t\t\t_results.push(this.add(item));\n\t\t\t\t}\n\t\t\t\treturn _results;\n\t\t\t};\n\n\t\t\tModel.prototype.add = function (data, clearCache) {\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\tif (clearCache) {\n\t\t\t\t\tthis._invalidateCache();\n\t\t\t\t}\n\t\t\t\tif (angular.isDefined(this._dataMap[data.id])) {\n\t\t\t\t\treturn this.update(data, clearCache);\n\t\t\t\t} else {\n\t\t\t\t\tthis._data.push(data);\n\t\t\t\t\tthis._dataMap[data.id] = data;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tModel.prototype.update = function (data, clearCache) {\n\t\t\t\tvar entry, key, value, _results;\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\tif (clearCache) {\n\t\t\t\t\tthis._invalidateCache();\n\t\t\t\t}\n\t\t\t\tentry = this.getById(data.id);\n\t\t\t\t_results = [];\n\t\t\t\tfor (key in data) {\n\t\t\t\t\tvalue = data[key];\n\t\t\t\t\tif (key === 'id') {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_results.push(entry[key] = value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn _results;\n\t\t\t};\n\n\t\t\tModel.prototype.getById = function (id) {\n\t\t\t\treturn this._dataMap[id];\n\t\t\t};\n\n\t\t\tModel.prototype.getAll = function () {\n\t\t\t\treturn this._data;\n\t\t\t};\n\n\t\t\tModel.prototype.removeById = function (id, clearCache) {\n\t\t\t\tvar counter, data, entry, _i, _len, _ref;\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\t_ref = this._data;\n\t\t\t\tfor (counter = _i = 0, _len = _ref.length; _i < _len; counter = ++_i) {\n\t\t\t\t\tentry = _ref[counter];\n\t\t\t\t\tif (entry.id === id) {\n\t\t\t\t\t\tthis._data.splice(counter, 1);\n\t\t\t\t\t\tdata = this._dataMap[id];\n\t\t\t\t\t\tdelete this._dataMap[id];\n\t\t\t\t\t\tif (clearCache) {\n\t\t\t\t\t\t\tthis._invalidateCache();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tModel.prototype.clear = function () {\n\t\t\t\tthis._data.length = 0;\n\t\t\t\tthis._dataMap = {};\n\t\t\t\treturn this._invalidateCache();\n\t\t\t};\n\n\t\t\tModel.prototype._invalidateCache = function () {\n\t\t\t\tthis._filterCache = {};\n\t\t\t};\n\n\t\t\tModel.prototype.get = function (query) {\n\t\t\t\tvar hash;\n\t\t\t\thash = query.hashCode();\n\t\t\t\tif (!angular.isDefined(this._filterCache[hash])) {\n\t\t\t\t\tthis._filterCache[hash] = query.exec(this._data);\n\t\t\t\t}\n\t\t\t\treturn this._filterCache[hash];\n\t\t\t};\n\n\t\t\tModel.prototype.size = function () {\n\t\t\t\treturn this._data.length;\n\t\t\t};\n\n\t\t\treturn Model;\n\t\t}();\n\t\treturn Model;\n\t}]);\n}).call(undefined);","'use strict';\n\nangular.module('Tasks').factory('Persistence', ['Request', 'Loading', '$rootScope', '$q', 'CalendarService', function (Request, Loading, $rootScope, $q, CalendarService) {\n\t'use strict';\n\n\tvar Persistence = function () {\n\t\tfunction Persistence(_request, _Loading, _$rootScope, _CalendarService) {\n\t\t\tthis._request = _request;\n\t\t\tthis._Loading = _Loading;\n\t\t\tthis._$rootScope = _$rootScope;\n\t\t\tthis._CalendarService = _CalendarService;\n\t\t}\n\n\t\tPersistence.prototype.init = function () {\n\t\t\tvar successCallback,\n\t\t\t    _this = this;\n\t\t\tthis.deferred = $q.defer();\n\t\t\tsuccessCallback = function successCallback() {\n\t\t\t\treturn _this.deferred.resolve();\n\t\t\t};\n\t\t\tthis.getCollections();\n\t\t\tthis.getSettings();\n\t\t\treturn this.deferred.promise;\n\t\t};\n\n\t\tPersistence.prototype.getCollections = function (onSuccess, showLoading) {\n\t\t\tvar failureCallbackWrapper,\n\t\t\t    params,\n\t\t\t    successCallbackWrapper,\n\t\t\t    _this = this;\n\t\t\tif (showLoading === null) {\n\t\t\t\tshowLoading = true;\n\t\t\t}\n\t\t\tif (!onSuccess) {\n\t\t\t\tonSuccess = function onSuccess() {};\n\t\t\t}\n\t\t\tif (showLoading) {\n\t\t\t\tthis._Loading.increase();\n\t\t\t\tsuccessCallbackWrapper = function successCallbackWrapper(data) {\n\t\t\t\t\tonSuccess();\n\t\t\t\t\treturn _this._Loading.decrease();\n\t\t\t\t};\n\t\t\t\tfailureCallbackWrapper = function failureCallbackWrapper(data) {\n\t\t\t\t\treturn _this._Loading.decrease();\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tsuccessCallbackWrapper = function successCallbackWrapper(data) {\n\t\t\t\t\treturn onSuccess();\n\t\t\t\t};\n\t\t\t\tfailureCallbackWrapper = function failureCallbackWrapper(data) {};\n\t\t\t}\n\t\t\tparams = {\n\t\t\t\tonSuccess: successCallbackWrapper,\n\t\t\t\tonFailure: failureCallbackWrapper\n\t\t\t};\n\t\t\treturn this._request.get('/apps/tasks/collections', params);\n\t\t};\n\n\t\tPersistence.prototype.getSettings = function (onSuccess, showLoading) {\n\t\t\tvar failureCallbackWrapper,\n\t\t\t    params,\n\t\t\t    successCallbackWrapper,\n\t\t\t    _this = this;\n\t\t\tif (showLoading === null) {\n\t\t\t\tshowLoading = true;\n\t\t\t}\n\t\t\tif (!onSuccess) {\n\t\t\t\tonSuccess = function onSuccess() {};\n\t\t\t}\n\t\t\tif (showLoading) {\n\t\t\t\tthis._Loading.increase();\n\t\t\t\tsuccessCallbackWrapper = function successCallbackWrapper(data) {\n\t\t\t\t\tonSuccess();\n\t\t\t\t\treturn _this._Loading.decrease();\n\t\t\t\t};\n\t\t\t\tfailureCallbackWrapper = function failureCallbackWrapper(data) {\n\t\t\t\t\treturn _this._Loading.decrease();\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tsuccessCallbackWrapper = function successCallbackWrapper(data) {\n\t\t\t\t\treturn onSuccess();\n\t\t\t\t};\n\t\t\t\tfailureCallbackWrapper = function failureCallbackWrapper(data) {};\n\t\t\t}\n\t\t\tparams = {\n\t\t\t\tonSuccess: successCallbackWrapper,\n\t\t\t\tonFailure: failureCallbackWrapper\n\t\t\t};\n\t\t\treturn this._request.get('/apps/tasks/settings', params);\n\t\t};\n\n\t\tPersistence.prototype.setVisibility = function (collectionID, visibility) {\n\t\t\tvar params = {\n\t\t\t\trouteParams: {\n\t\t\t\t\tcollectionID: collectionID,\n\t\t\t\t\tvisibility: visibility\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn this._request.post('/apps/tasks/collection/{collectionID}/visibility/{visibility}', params);\n\t\t};\n\n\t\tPersistence.prototype.setting = function (type, setting, value) {\n\t\t\tvar params = {\n\t\t\t\trouteParams: {\n\t\t\t\t\ttype: type,\n\t\t\t\t\tsetting: setting,\n\t\t\t\t\tvalue: value\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn this._request.post('/apps/tasks/settings/{type}/{setting}/{value}', params);\n\t\t};\n\t\treturn Persistence;\n\t}();\n\treturn new Persistence(Request, Loading, $rootScope, CalendarService);\n}]);","'use strict';\n\nangular.module('Tasks').factory('Publisher', ['CollectionsModel', 'SettingsModel', function (CollectionsModel, SettingsModel) {\n\t'use strict';\n\n\tvar Publisher = function () {\n\t\tfunction Publisher(_$collectionsmodel, _$settingsmodel) {\n\t\t\tthis._$collectionsmodel = _$collectionsmodel;\n\t\t\tthis._$settingsmodel = _$settingsmodel;\n\t\t\tthis._subscriptions = {};\n\t\t\tthis.subscribeObjectTo(this._$collectionsmodel, 'collections');\n\t\t\tthis.subscribeObjectTo(this._$settingsmodel, 'settings');\n\t\t}\n\n\t\tPublisher.prototype.subscribeObjectTo = function (object, name) {\n\t\t\tvar base = this._subscriptions;\n\t\t\tif (!base[name]) {\n\t\t\t\tbase[name] = [];\n\t\t\t}\n\t\t\treturn this._subscriptions[name].push(object);\n\t\t};\n\n\t\tPublisher.prototype.publishDataTo = function (data, name) {\n\t\t\tvar ref, results, subscriber, _i, _len;\n\t\t\tref = this._subscriptions[name] || [];\n\t\t\tresults = [];\n\t\t\tfor (_i = 0, _len = ref.length; _i < _len; _i++) {\n\t\t\t\tsubscriber = ref[_i];\n\t\t\t\tresults.push(subscriber.handle(data));\n\t\t\t}\n\t\t\treturn results;\n\t\t};\n\t\treturn Publisher;\n\t}();\n\treturn new Publisher(CollectionsModel, SettingsModel);\n}]);","'use strict';\n\nangular.module('Tasks').factory('RandomStringService', function () {\n  'use strict';\n\n  return {\n    generate: function generate() {\n      return Math.random().toString(36).substr(2);\n    }\n  };\n});","'use strict';\n\nangular.module('Tasks').factory('Request', ['$http', 'Publisher', function ($http, Publisher) {\n\t'use strict';\n\n\tvar Request = function () {\n\t\tfunction Request($http, publisher) {\n\t\t\tthis.$http = $http;\n\t\t\tthis.publisher = publisher;\n\t\t\tthis.count = 0;\n\t\t\tthis.initialized = false;\n\t\t\tthis.shelvedRequests = [];\n\t\t\tthis.initialized = true;\n\t\t\tthis._executeShelvedRequests();\n\t\t}\n\n\t\tRequest.prototype.request = function (route, data) {\n\t\t\tvar defaultConfig, defaultData, url;\n\t\t\tif (data === null) {\n\t\t\t\tdata = {};\n\t\t\t}\n\t\t\tdefaultData = {\n\t\t\t\trouteParams: {},\n\t\t\t\tdata: {},\n\t\t\t\tonSuccess: function onSuccess() {\n\t\t\t\t\treturn {};\n\t\t\t\t},\n\t\t\t\tonFailure: function onFailure() {\n\t\t\t\t\treturn {};\n\t\t\t\t},\n\t\t\t\tconfig: {}\n\t\t\t};\n\t\t\tangular.extend(defaultData, data);\n\t\t\tif (!this.initialized) {\n\t\t\t\tthis._shelveRequest(route, defaultData);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\turl = OC.generateUrl(route, defaultData.routeParams);\n\t\t\tdefaultConfig = {\n\t\t\t\turl: url,\n\t\t\t\tdata: defaultData.data\n\t\t\t};\n\t\t\tangular.extend(defaultConfig, defaultData.config);\n\t\t\tif (defaultConfig.method === 'GET') {\n\t\t\t\tdefaultConfig.params = defaultConfig.data;\n\t\t\t}\n\t\t\treturn this.$http(defaultConfig).then(function (_this) {\n\t\t\t\treturn function (response) {\n\t\t\t\t\tvar name, ref, value;\n\t\t\t\t\tref = response.data.data;\n\t\t\t\t\tfor (name in ref) {\n\t\t\t\t\t\tvalue = ref[name];\n\t\t\t\t\t\t_this.publisher.publishDataTo(value, name);\n\t\t\t\t\t}\n\t\t\t\t\treturn defaultData.onSuccess(response.data, response.status, response.headers, response.config);\n\t\t\t\t};\n\t\t\t}(this)).catch(function (response) {\n\t\t\t\treturn defaultData.onFailure(response.data, response.status, response.headers, response.config);\n\t\t\t});\n\t\t};\n\n\t\tRequest.prototype.post = function (route, data) {\n\t\t\tif (data === null) {\n\t\t\t\tdata = {};\n\t\t\t}\n\t\t\tif (!data.config) {\n\t\t\t\tdata.config = {};\n\t\t\t}\n\t\t\tdata.config.method = 'POST';\n\t\t\treturn this.request(route, data);\n\t\t};\n\n\t\tRequest.prototype.get = function (route, data) {\n\t\t\tif (data === null) {\n\t\t\t\tdata = {};\n\t\t\t}\n\t\t\tif (!data.config) {\n\t\t\t\tdata.config = {};\n\t\t\t}\n\t\t\tdata.config.method = 'GET';\n\t\t\treturn this.request(route, data);\n\t\t};\n\n\t\tRequest.prototype.put = function (route, data) {\n\t\t\tif (data === null) {\n\t\t\t\tdata = {};\n\t\t\t}\n\t\t\tif (!data.config) {\n\t\t\t\tdata.config = {};\n\t\t\t}\n\t\t\tdata.config.method = 'PUT';\n\t\t\treturn this.request(route, data);\n\t\t};\n\n\t\tRequest.prototype[\"delete\"] = function (route, data) {\n\t\t\tif (data === null) {\n\t\t\t\tdata = {};\n\t\t\t}\n\t\t\tif (!data.config) {\n\t\t\t\tdata.config = {};\n\t\t\t}\n\t\t\tdata.config.method = 'DELETE';\n\t\t\treturn this.request(route, data);\n\t\t};\n\n\t\tRequest.prototype._shelveRequest = function (route, data) {\n\t\t\tvar request = {\n\t\t\t\troute: route,\n\t\t\t\tdata: data\n\t\t\t};\n\t\t\treturn this.shelvedRequests.push(request);\n\t\t};\n\n\t\tRequest.prototype._executeShelvedRequests = function () {\n\t\t\tvar r, ref, results, _i, _len;\n\t\t\tref = this.shelvedRequests;\n\t\t\tresults = [];\n\t\t\tfor (_i = 0, _len = ref.length; _i < _len; _i++) {\n\t\t\t\tr = ref[_i];\n\t\t\t\tresults.push(this.request(r.route, r.data));\n\t\t\t}\n\t\t\treturn results;\n\t\t};\n\t\treturn Request;\n\t}();\n\treturn new Request($http, Publisher);\n}]);","'use strict';\n\nangular.module('Tasks').factory('Status', [function () {\n  'use strict';\n\n  var Status;\n  Status = function () {\n    function Status() {\n      this._$status = {\n        addingList: false,\n        focusTaskInput: false\n      };\n    }\n\n    Status.prototype.getStatus = function () {\n      return this._$status;\n    };\n\n    return Status;\n  }();\n  return new Status();\n}]);","'use strict';\n\nangular.module('Tasks').service('VTodoService', ['DavClient', 'RandomStringService', '$timeout', function (DavClient, RandomStringService, $timeout) {\n\t'use strict';\n\n\tvar _this = this;\n\n\tthis.getAll = function (calendar, completed, parent) {\n\t\tif (completed === null) {\n\t\t\tcompleted = false;\n\t\t}\n\t\tif (parent === null) {\n\t\t\tparent = false;\n\t\t}\n\t\tvar xmlDoc = document.implementation.createDocument('', '', null);\n\t\tvar cCalQuery = xmlDoc.createElement('c:calendar-query');\n\t\tcCalQuery.setAttribute('xmlns:c', 'urn:ietf:params:xml:ns:caldav');\n\t\tcCalQuery.setAttribute('xmlns:d', 'DAV:');\n\t\tcCalQuery.setAttribute('xmlns:a', 'http://apple.com/ns/ical/');\n\t\tcCalQuery.setAttribute('xmlns:o', 'http://owncloud.org/ns');\n\t\txmlDoc.appendChild(cCalQuery);\n\n\t\tvar dProp = xmlDoc.createElement('d:prop');\n\t\tcCalQuery.appendChild(dProp);\n\n\t\tvar dGetEtag = xmlDoc.createElement('d:getetag');\n\t\tdProp.appendChild(dGetEtag);\n\n\t\tvar cCalendarData = xmlDoc.createElement('c:calendar-data');\n\t\tdProp.appendChild(cCalendarData);\n\n\t\tvar cFilter = xmlDoc.createElement('c:filter');\n\t\tcCalQuery.appendChild(cFilter);\n\n\t\tvar cCompFilterVCal = xmlDoc.createElement('c:comp-filter');\n\t\tcCompFilterVCal.setAttribute('name', 'VCALENDAR');\n\t\tcFilter.appendChild(cCompFilterVCal);\n\n\t\tvar cCompFilterVTodo = xmlDoc.createElement('c:comp-filter');\n\t\tcCompFilterVTodo.setAttribute('name', 'VTODO');\n\t\tcCompFilterVCal.appendChild(cCompFilterVTodo);\n\n\t\tvar cPropFilterCompleted = xmlDoc.createElement('c:prop-filter');\n\t\tcPropFilterCompleted.setAttribute('name', 'COMPLETED');\n\t\tcCompFilterVTodo.appendChild(cPropFilterCompleted);\n\n\t\tif (!completed) {\n\t\t\tvar cIsNotDefined = xmlDoc.createElement('c:is-not-defined');\n\t\t\tcPropFilterCompleted.appendChild(cIsNotDefined);\n\t\t}\n\n\t\tif (parent) {\n\t\t\tvar cPropFilterRelated = xmlDoc.createElement('c:prop-filter');\n\t\t\tcPropFilterRelated.setAttribute('name', 'RELATED-TO');\n\t\t\tcCompFilterVTodo.appendChild(cPropFilterRelated);\n\t\t\tvar cTextMatch = xmlDoc.createElement('c:text-match');\n\t\t\tvar cTextMatchValue = xmlDoc.createTextNode(parent.uid);\n\t\t\tcTextMatch.appendChild(cTextMatchValue);\n\t\t\tcPropFilterRelated.appendChild(cTextMatch);\n\t\t}\n\n\t\t// var cPropFilterStatus = xmlDoc.createElement('c:prop-filter');\n\t\t// cPropFilterStatus.setAttribute('name', 'STATUS');\n\t\t// cCompFilterVTodo.appendChild(cPropFilterStatus);\n\n\t\t// var cTextMatch = xmlDoc.createElement('c:text-match');\n\t\t// cTextMatch.setAttribute('negate-condition', 'yes');\n\t\t// var cTextMatchValue = xmlDoc.createTextNode('CANCELLED');\n\t\t// cTextMatch.appendChild(cTextMatchValue);\n\t\t// cPropFilterStatus.appendChild(cTextMatch);\n\n\t\t// var cTimeRange = xmlDoc.createElement('c:time-range');\n\t\t// cTimeRange.setAttribute('start', this._getTimeRangeStamp(start));\n\t\t// cTimeRange.setAttribute('end', this._getTimeRangeStamp(end));\n\t\t// cCompFilterVTodo.appendChild(cTimeRange);\n\n\t\tvar url = calendar.url;\n\t\tvar headers = {\n\t\t\t'Content-Type': 'application/xml; charset=utf-8',\n\t\t\t'Depth': 1,\n\t\t\t'requesttoken': OC.requestToken\n\t\t};\n\t\tvar body = cCalQuery.outerHTML;\n\n\t\treturn DavClient.request('REPORT', url, headers, body).then(function (response) {\n\t\t\tif (!DavClient.wasRequestSuccessful(response.status)) {\n\t\t\t\t//TODO - something went wrong\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar vTodos = [];\n\n\t\t\tfor (var i in response.body) {\n\t\t\t\tvar object = response.body[i];\n\t\t\t\tvar properties = object.propStat[0].properties;\n\n\t\t\t\tvar uri = object.href.substr(object.href.lastIndexOf('/') + 1);\n\n\t\t\t\tvar vTodo = {\n\t\t\t\t\tcalendar: calendar,\n\t\t\t\t\tproperties: properties,\n\t\t\t\t\turi: uri\n\t\t\t\t};\n\t\t\t\tvTodos.push(vTodo);\n\t\t\t}\n\n\t\t\treturn vTodos;\n\t\t});\n\t};\n\n\tthis.get = function (calendar, uri) {\n\t\tvar url = calendar.url + uri;\n\t\treturn DavClient.request('GET', url, { 'requesttoken': OC.requestToken }, '').then(function (response) {\n\t\t\tvar vTodo = {\n\t\t\t\tcalendar: calendar,\n\t\t\t\tproperties: {\n\t\t\t\t\t'{urn:ietf:params:xml:ns:caldav}calendar-data': response.body,\n\t\t\t\t\t'{DAV:}getetag': response.xhr.getResponseHeader('ETag') },\n\t\t\t\turi: uri\n\t\t\t};\n\t\t\treturn vTodo;\n\t\t});\n\t};\n\n\tthis.create = function (calendar, data, returnTodo) {\n\t\tif (typeof returnTodo === 'undefined') {\n\t\t\treturnTodo = true;\n\t\t}\n\n\t\tvar headers = {\n\t\t\t'Content-Type': 'text/calendar; charset=utf-8',\n\t\t\t'requesttoken': OC.requestToken\n\t\t};\n\t\tvar uri = this._generateRandomUri();\n\t\tvar url = calendar.url + uri;\n\n\t\treturn DavClient.request('PUT', url, headers, data).then(function (response) {\n\t\t\tif (!DavClient.wasRequestSuccessful(response.status)) {\n\t\t\t\tconsole.log(response);\n\t\t\t\treturn false;\n\t\t\t\t// TODO - something went wrong, do smth about it\n\t\t\t}\n\n\t\t\treturn returnTodo ? _this.get(calendar, uri) : true;\n\t\t});\n\t};\n\n\tthis.update = function (task) {\n\t\tvar url = task.calendar.url + task.uri;\n\t\tvar headers = {\n\t\t\t'Content-Type': 'text/calendar; charset=utf-8',\n\t\t\t'If-Match': task.etag,\n\t\t\t'requesttoken': OC.requestToken\n\t\t};\n\t\t$timeout.cancel(task.timers.update);\n\t\treturn DavClient.request('PUT', url, headers, task.data).then(function (response) {\n\t\t\ttask.etag = response.xhr.getResponseHeader('ETag');\n\t\t\treturn DavClient.wasRequestSuccessful(response.status);\n\t\t});\n\t};\n\n\tthis.delete = function (task) {\n\t\tvar url = task.calendar.url + task.uri;\n\t\tvar headers = {\n\t\t\t'If-Match': task.etag,\n\t\t\t'requesttoken': OC.requestToken\n\t\t};\n\n\t\treturn DavClient.request('DELETE', url, headers, '').then(function (response) {\n\t\t\treturn DavClient.wasRequestSuccessful(response.status);\n\t\t});\n\t};\n\n\tthis._generateRandomUri = function () {\n\t\tvar uri = 'Nextcloud-';\n\t\turi += RandomStringService.generate();\n\t\turi += RandomStringService.generate();\n\t\turi += '.ics';\n\n\t\treturn uri;\n\t};\n\n\t// this._getTimeRangeStamp = function(momentObject) {\n\t// \treturn momentObject.format('YYYYMMDD') + 'T' + momentObject.format('HHmmss') + 'Z';\n\t// };\n}]);","'use strict';\n\nangular.module('Tasks').factory('ListsBusinessLayer', ['ListsModel', 'Persistence', 'TasksBusinessLayer', 'CalendarService', function (ListsModel, Persistence, TasksBusinessLayer, CalendarService) {\n\t'use strict';\n\n\tvar ListsBusinessLayer;\n\tListsBusinessLayer = function () {\n\t\tfunction ListsBusinessLayer(_$listsmodel, _persistence, _$tasksbusinesslayer, _$calendarservice) {\n\t\t\tthis._$listsmodel = _$listsmodel;\n\t\t\tthis._persistence = _persistence;\n\t\t\tthis._$tasksbusinesslayer = _$tasksbusinesslayer;\n\t\t\tthis._$calendarservice = _$calendarservice;\n\t\t}\n\n\t\tListsBusinessLayer.prototype.init = function () {\n\t\t\treturn this._$calendarservice.getAll().then(function (calendars) {\n\t\t\t\tvar calendar, _i, _len, _results;\n\t\t\t\t_results = [];\n\t\t\t\tfor (_i = 0, _len = calendars.length; _i < _len; _i++) {\n\t\t\t\t\tcalendar = calendars[_i];\n\t\t\t\t\tListsModel.add(calendar);\n\t\t\t\t\t_results.push(TasksBusinessLayer.getAll(calendar));\n\t\t\t\t}\n\t\t\t\treturn _results;\n\t\t\t});\n\t\t};\n\n\t\tListsBusinessLayer.prototype.add = function (calendar, color) {\n\t\t\treturn this._$calendarservice.create(calendar, color, ['vtodo']).then(function (calendar) {\n\t\t\t\tListsModel.add(calendar);\n\t\t\t\treturn calendar;\n\t\t\t});\n\t\t};\n\n\t\tListsBusinessLayer.prototype[\"delete\"] = function (calendar) {\n\t\t\treturn this._$calendarservice[\"delete\"](calendar).then(function () {\n\t\t\t\treturn ListsModel[\"delete\"](calendar);\n\t\t\t});\n\t\t};\n\n\t\tListsBusinessLayer.prototype.rename = function (calendar) {\n\t\t\tthis._$calendarservice.update(calendar).then(function (calendar) {\n\t\t\t\tcalendar.dropPreviousState();\n\t\t\t});\n\t\t};\n\n\t\treturn ListsBusinessLayer;\n\t}();\n\treturn new ListsBusinessLayer(ListsModel, Persistence, TasksBusinessLayer, CalendarService);\n}]);","'use strict';\n\n(function () {\n\t'use strict';\n\n\tvar __bind = function __bind(fn, me) {\n\t\treturn function () {\n\t\t\treturn fn.apply(me, arguments);\n\t\t};\n\t};\n\n\tangular.module('Tasks').factory('SearchBusinessLayer', ['ListsModel', 'Persistence', 'TasksModel', '$rootScope', '$routeParams', '$location', function (ListsModel, Persistence, TasksModel, $rootScope, $routeParams, $location) {\n\t\tvar SearchBusinessLayer;\n\t\tSearchBusinessLayer = function () {\n\t\t\tfunction SearchBusinessLayer(_$listsmodel, _persistence, _$tasksmodel, _$rootScope, _$routeparams, _$location) {\n\t\t\t\tthis._$listsmodel = _$listsmodel;\n\t\t\t\tthis._persistence = _persistence;\n\t\t\t\tthis._$tasksmodel = _$tasksmodel;\n\t\t\t\tthis._$rootScope = _$rootScope;\n\t\t\t\tthis._$routeparams = _$routeparams;\n\t\t\t\tthis._$location = _$location;\n\t\t\t\tthis.getFilter = __bind(this.getFilter, this);\n\t\t\t\tthis.setFilter = __bind(this.setFilter, this);\n\t\t\t\tthis.attach = __bind(this.attach, this);\n\t\t\t\tthis.initialize();\n\t\t\t\tthis._$searchString = '';\n\t\t\t}\n\n\t\t\tSearchBusinessLayer.prototype.attach = function (search) {\n\t\t\t\tvar _this = this;\n\t\t\t\tsearch.setFilter('tasks', function (query) {\n\t\t\t\t\treturn _this._$rootScope.$apply(function () {\n\t\t\t\t\t\treturn _this.setFilter(query);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tsearch.setRenderer('task', this.renderTaskResult.bind(this));\n\t\t\t\treturn search.setHandler('task', this.handleTaskClick.bind(this));\n\t\t\t};\n\n\t\t\tSearchBusinessLayer.prototype.setFilter = function (query) {\n\t\t\t\tthis._$searchString = query;\n\t\t\t};\n\n\t\t\tSearchBusinessLayer.prototype.getFilter = function () {\n\t\t\t\treturn this._$searchString;\n\t\t\t};\n\n\t\t\tSearchBusinessLayer.prototype.initialize = function () {\n\t\t\t\tvar _this = this;\n\t\t\t\tthis.handleTaskClick = function ($row, result, event) {\n\t\t\t\t\treturn _this._$location.path('/lists/' + result.calendarid + '/tasks/' + result.id);\n\t\t\t\t};\n\t\t\t\tthis.renderTaskResult = function ($row, result) {\n\t\t\t\t\tvar $template;\n\t\t\t\t\tif (!_this._$tasksmodel.filterTasks(result, _this._$routeparams.listID) || !_this._$tasksmodel.isLoaded(result)) {\n\t\t\t\t\t\t$template = $('div.task-item.template');\n\t\t\t\t\t\t$template = $template.clone();\n\t\t\t\t\t\t$row = $('<tr class=\"result\"></tr>').append($template.removeClass('template'));\n\t\t\t\t\t\t$row.data('result', result);\n\t\t\t\t\t\t$row.find('span.title').text(result.name);\n\t\t\t\t\t\tif (result.starred) {\n\t\t\t\t\t\t\t$row.find('span.task-star').addClass('task-starred');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (result.completed) {\n\t\t\t\t\t\t\t$row.find('div.task-item').addClass('done');\n\t\t\t\t\t\t\t$row.find('span.task-checkbox').addClass('svg-checkmark');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (result.complete) {\n\t\t\t\t\t\t\t$row.find('div.percentdone').css({\n\t\t\t\t\t\t\t\t'width': result.complete + '%',\n\t\t\t\t\t\t\t\t'background-color': '' + _this._$listsmodel.getColor(result.calendarid)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (result.note) {\n\t\t\t\t\t\t\t$row.find('div.title-wrapper').addClass('attachment');\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn $row;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\treturn OC.Plugins.register('OCA.Search', this);\n\t\t\t};\n\n\t\t\treturn SearchBusinessLayer;\n\t\t}();\n\t\treturn new SearchBusinessLayer(ListsModel, Persistence, TasksModel, $rootScope, $routeParams, $location);\n\t}]);\n}).call(undefined);","'use strict';\n\nangular.module('Tasks').factory('SettingsBusinessLayer', ['Persistence', 'SettingsModel', function (Persistence, SettingsModel) {\n\t'use strict';\n\n\tvar SettingsBusinessLayer = function () {\n\t\tfunction SettingsBusinessLayer(_persistence, _$settingsmodel) {\n\t\t\tthis._persistence = _persistence;\n\t\t\tthis._$settingsmodel = _$settingsmodel;\n\t\t}\n\n\t\tSettingsBusinessLayer.prototype.updateModel = function () {\n\t\t\tvar success,\n\t\t\t    _this = this;\n\t\t\tsuccess = function success() {};\n\t\t\treturn this._persistence.getCollections(success, true);\n\t\t};\n\n\t\tSettingsBusinessLayer.prototype.setVisibility = function (collectionID, visibility) {\n\t\t\treturn this._persistence.setVisibility(collectionID, visibility);\n\t\t};\n\n\t\tSettingsBusinessLayer.prototype.toggle = function (type, setting) {\n\t\t\tthis._$settingsmodel.toggle(type, setting);\n\t\t\tvar value = this._$settingsmodel.getById(type)[setting];\n\t\t\treturn this._persistence.setting(type, setting, +value);\n\t\t};\n\n\t\tSettingsBusinessLayer.prototype.set = function (type, setting, value) {\n\t\t\treturn this._persistence.setting(type, setting, value);\n\t\t};\n\n\t\treturn SettingsBusinessLayer;\n\t}();\n\treturn new SettingsBusinessLayer(Persistence, SettingsModel);\n}]);","'use strict';\n\nangular.module('Tasks').factory('TasksBusinessLayer', ['TasksModel', 'Persistence', 'VTodoService', 'VTodo', '$timeout', function (TasksModel, Persistence, VTodoService, VTodo, $timeout) {\n\t'use strict';\n\n\tvar TasksBusinessLayer;\n\tTasksBusinessLayer = function () {\n\t\tfunction TasksBusinessLayer(_$tasksmodel, _persistence, _$vtodoservice, _$vtodo, $timeout) {\n\t\t\tthis._$tasksmodel = _$tasksmodel;\n\t\t\tthis._persistence = _persistence;\n\t\t\tthis._$vtodoservice = _$vtodoservice;\n\t\t}\n\n\t\tTasksBusinessLayer.prototype.getAll = function (calendar, completed, parent) {\n\t\t\treturn this._$vtodoservice.getAll(calendar, completed, parent).then(function (tasks) {\n\t\t\t\tvar task, _i, _len, _results;\n\t\t\t\t_results = [];\n\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\tvar vTodo = new VTodo(task.calendar, task.properties, task.uri);\n\t\t\t\t\t_results.push(TasksModel.ad(vTodo));\n\t\t\t\t}\n\t\t\t\treturn _results;\n\t\t\t});\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.add = function (task) {\n\t\t\treturn this._$vtodoservice.create(task.calendar, task.data).then(function (task) {\n\t\t\t\tvar vTodo = new VTodo(task.calendar, task.properties, task.uri);\n\t\t\t\tTasksModel.ad(vTodo);\n\t\t\t\treturn vTodo;\n\t\t\t});\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.getTask = function (calendar, uri) {\n\t\t\treturn this._$vtodoservice.get(calendar, uri).then(function (task) {\n\t\t\t\tTasksModel.ad(task);\n\t\t\t\treturn task;\n\t\t\t});\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.setPriority = function (task, priority) {\n\t\t\tif (task.calendar.writable) {\n\t\t\t\ttask.priority = priority;\n\t\t\t\tthis.doUpdate(task);\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.setPercentComplete = function (task, percentComplete) {\n\t\t\tif (task.calendar.writable) {\n\t\t\t\tif (percentComplete < 100) {\n\t\t\t\t\tthis.uncompleteParents(task.related);\n\t\t\t\t} else {\n\t\t\t\t\tthis.completeChildren(task);\n\t\t\t\t}\n\t\t\t\ttask.complete = percentComplete;\n\t\t\t\tthis.triggerUpdate(task);\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.triggerUpdate = function (task, duration) {\n\t\t\tif (!duration) {\n\t\t\t\tduration = 1000;\n\t\t\t}\n\t\t\tif (task.timers.update) {\n\t\t\t\t$timeout.cancel(task.timers.update);\n\t\t\t}\n\t\t\ttask.timers.update = $timeout(function (task) {\n\t\t\t\tVTodoService.update(task);\n\t\t\t}, duration, true, task);\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.doUpdate = function (task) {\n\t\t\treturn this._$vtodoservice.update(task);\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.completeChildren = function (task) {\n\t\t\tvar child, _i, _len;\n\t\t\tvar children = this._$tasksmodel.getChildren(task);\n\t\t\tvar _results = [];\n\t\t\tfor (_i = 0, _len = children.length; _i < _len; _i++) {\n\t\t\t\tchild = children[_i];\n\t\t\t\t_results.push(this.setPercentComplete(child, 100));\n\t\t\t}\n\t\t\treturn _results;\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.uncompleteParents = function (uid) {\n\t\t\tif (uid) {\n\t\t\t\tvar parent = this._$tasksmodel.getByUid(uid);\n\t\t\t\tif (parent.completed) {\n\t\t\t\t\treturn this.setPercentComplete(parent, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.setHideSubtasks = function (task, hide) {\n\t\t\ttask.hideSubtasks = hide;\n\t\t\tif (task.calendar.writable) {\n\t\t\t\tthis.doUpdate(task);\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.setHideCompletedSubtasks = function (task, hide) {\n\t\t\ttask.hideCompletedSubtasks = hide;\n\t\t\tif (task.calendar.writable) {\n\t\t\t\tthis.doUpdate(task);\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.deleteTask = function (task) {\n\t\t\tvar child, children, _i, _len;\n\t\t\tchildren = this._$tasksmodel.getChildren(task);\n\t\t\tfor (_i = 0, _len = children.length; _i < _len; _i++) {\n\t\t\t\tchild = children[_i];\n\t\t\t\tthis.deleteTask(child);\n\t\t\t}\n\t\t\treturn this._$vtodoservice[\"delete\"](task).then(function () {\n\t\t\t\treturn TasksModel[\"delete\"](task);\n\t\t\t});\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.momentToICALTime = function (moment, asDate) {\n\t\t\tif (asDate) {\n\t\t\t\treturn ICAL.Time.fromDateString(moment.format('YYYY-MM-DD'));\n\t\t\t} else {\n\t\t\t\treturn ICAL.Time.fromDateTimeString(moment.format('YYYY-MM-DDTHH:mm:ss'));\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.initDueDate = function (task) {\n\t\t\tvar start = moment(task.start, \"YYYY-MM-DDTHH:mm:ss\");\n\t\t\tvar due = moment(task.due, \"YYYY-MM-DDTHH:mm:ss\");\n\t\t\tif (!due.isValid()) {\n\t\t\t\tvar reference = start.isAfter() ? start : moment();\n\t\t\t\tif (task.allDay) {\n\t\t\t\t\treference.startOf('day').add(1, 'd');\n\t\t\t\t} else {\n\t\t\t\t\treference.startOf('hour').add(1, 'h');\n\t\t\t\t}\n\t\t\t\treturn this.setDue(task, reference, 'all');\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.setDue = function (task, date, type) {\n\t\t\tif (type === null) {\n\t\t\t\ttype = 'day';\n\t\t\t}\n\t\t\tvar allDay = task.allDay;\n\t\t\tvar start = moment(task.start, \"YYYY-MM-DDTHH:mm:ss\");\n\t\t\tvar olddue = moment(task.due, \"YYYY-MM-DDTHH:mm:ss\");\n\t\t\tvar due = olddue.clone();\n\t\t\tif (type === 'day') {\n\t\t\t\tif (moment(due).isValid()) {\n\t\t\t\t\tdue.year(date.year()).month(date.month()).date(date.date());\n\t\t\t\t} else {\n\t\t\t\t\tdue = date.add(12, 'h');\n\t\t\t\t}\n\t\t\t} else if (type === 'time') {\n\t\t\t\tif (moment(due).isValid()) {\n\t\t\t\t\tdue.hour(date.hour()).minute(date.minute());\n\t\t\t\t} else {\n\t\t\t\t\tdue = date;\n\t\t\t\t}\n\t\t\t} else if (type === 'all') {\n\t\t\t\tdue = date;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (due.isBefore(start) || due.isSame(start)) {\n\t\t\t\tstart.subtract(olddue.diff(due), 'ms');\n\t\t\t\ttask.start = this.momentToICALTime(start, allDay);\n\t\t\t}\n\t\t\ttask.due = this.momentToICALTime(due, allDay);\n\t\t\t// this.checkReminderDate(task);\n\t\t\tthis.doUpdate(task);\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.deleteDueDate = function (task) {\n\t\t\t// var reminder = task.reminder;\n\t\t\t//  if (reminder !== null && reminder.type === 'DURATION' && reminder.duration.params.related === 'END') {\n\t\t\t// this.deleteReminderDate(task);\n\t\t\t//  }\n\t\t\ttask.due = null;\n\t\t\tthis.doUpdate(task);\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.initStartDate = function (task) {\n\t\t\tvar start = moment(task.start, \"YYYY-MM-DDTHH:mm:ss\");\n\t\t\tvar due = moment(task.due, \"YYYY-MM-DDTHH:mm:ss\");\n\t\t\tif (!start.isValid()) {\n\t\t\t\tvar reference = moment().add(1, 'h');\n\t\t\t\tif (due.isBefore(reference)) {\n\t\t\t\t\treference = due.subtract(1, 'm');\n\t\t\t\t}\n\t\t\t\treference.startOf(task.allDay ? 'day' : 'hour');\n\t\t\t\treturn this.setStart(task, reference, 'all');\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.setStart = function (task, date, type) {\n\t\t\tif (type === null) {\n\t\t\t\ttype = 'day';\n\t\t\t}\n\t\t\tvar allDay = task.allDay;\n\t\t\tvar due = moment(task.due, \"YYYY-MM-DDTHH:mm:ss\");\n\t\t\tvar oldstart = moment(task.start, \"YYYY-MM-DDTHH:mm:ss\");\n\t\t\tvar start = oldstart.clone();\n\t\t\tif (type === 'day') {\n\t\t\t\tif (moment(start).isValid()) {\n\t\t\t\t\tstart.year(date.year()).month(date.month()).date(date.date());\n\t\t\t\t} else {\n\t\t\t\t\tstart = date.add(12, 'h');\n\t\t\t\t}\n\t\t\t} else if (type === 'time') {\n\t\t\t\tif (moment(start).isValid()) {\n\t\t\t\t\tstart.hour(date.hour()).minute(date.minute());\n\t\t\t\t} else {\n\t\t\t\t\tstart = date;\n\t\t\t\t}\n\t\t\t} else if (type === 'all') {\n\t\t\t\tstart = date;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (start.isAfter(due) || start.isSame(due)) {\n\t\t\t\tdue.add(start.diff(oldstart), 'ms');\n\t\t\t\ttask.due = this.momentToICALTime(due, allDay);\n\t\t\t}\n\t\t\ttask.start = this.momentToICALTime(start, allDay);\n\t\t\t// this.checkReminderDate(taskID);\n\t\t\tthis.doUpdate(task);\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.deleteStartDate = function (task) {\n\t\t\t// var reminder = task.reminder;\n\t\t\t// if (reminder !== null && reminder.type === 'DURATION' && reminder.duration.params.related === 'START') {\n\t\t\t// this.deleteReminderDate(task);\n\t\t\t// }\n\t\t\ttask.start = null;\n\t\t\tthis.doUpdate(task);\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.setAllDay = function (task, allDay) {\n\t\t\ttask.allDay = allDay;\n\t\t\tif (allDay) {\n\t\t\t\tvar due = moment(task.due, \"YYYY-MM-DDTHH:mm:ss\");\n\t\t\t\tvar start = moment(task.start, \"YYYY-MM-DDTHH:mm:ss\");\n\t\t\t\tif (start.isAfter(due) || start.isSame(due)) {\n\t\t\t\t\tstart = moment(due).subtract(1, 'day');\n\t\t\t\t\ttask.start = this.momentToICALTime(start, allDay);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.doUpdate(task);\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.initReminder = function (taskID) {\n\t\t\tvar p, task;\n\t\t\tif (!this.checkReminderDate(taskID)) {\n\t\t\t\ttask = this._$tasksmodel.getById(taskID);\n\t\t\t\ttask.reminder = {\n\t\t\t\t\ttype: 'DURATION',\n\t\t\t\t\taction: 'DISPLAY',\n\t\t\t\t\tduration: {\n\t\t\t\t\t\ttoken: 'week',\n\t\t\t\t\t\tweek: 0,\n\t\t\t\t\t\tday: 0,\n\t\t\t\t\t\thour: 0,\n\t\t\t\t\t\tminute: 0,\n\t\t\t\t\t\tsecond: 0,\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tinvert: true\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (moment(task.start, \"YYYYMMDDTHHmmss\").isValid()) {\n\t\t\t\t\tp = task.reminder.duration.params;\n\t\t\t\t\tp.related = 'START';\n\t\t\t\t\tp.id = '10';\n\t\t\t\t} else if (moment(task.due, \"YYYYMMDDTHHmmss\").isValid()) {\n\t\t\t\t\tp = task.reminder.duration.params;\n\t\t\t\t\tp.related = 'END';\n\t\t\t\t\tp.id = '11';\n\t\t\t\t} else {\n\t\t\t\t\ttask.reminder.type = 'DATE-TIME';\n\t\t\t\t\ttask.reminder.date = moment().startOf('hour').add(1, 'h').format('YYYYMMDDTHHmmss');\n\t\t\t\t}\n\t\t\t\treturn this.setReminder(taskID);\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.setReminderDate = function (taskID, date, type) {\n\t\t\tvar newreminder, reminder, reminderdate;\n\t\t\tif (type === null) {\n\t\t\t\ttype = 'day';\n\t\t\t}\n\t\t\treminder = this._$tasksmodel.getById(taskID).reminder;\n\t\t\tnewreminder = {\n\t\t\t\ttype: 'DATE-TIME',\n\t\t\t\taction: 'DISPLAY',\n\t\t\t\tduration: null\n\t\t\t};\n\t\t\tif (type === 'day') {\n\t\t\t\tif (this.checkReminderDate(taskID) || reminder === null) {\n\t\t\t\t\treminderdate = moment(reminder.date, \"YYYYMMDDTHHmmss\");\n\t\t\t\t\tnewreminder.action = reminder.action;\n\t\t\t\t\tif (reminderdate.isValid() && reminder.type === 'DATE-TIME') {\n\t\t\t\t\t\treminderdate.year(date.year()).month(date.month()).date(date.date());\n\t\t\t\t\t} else {\n\t\t\t\t\t\treminderdate = date.add(12, 'h');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treminderdate = date.add(12, 'h');\n\t\t\t\t}\n\t\t\t} else if (type === 'time') {\n\t\t\t\tif (this.checkReminderDate(taskID) || reminder === null) {\n\t\t\t\t\treminderdate = moment(reminder.date, \"YYYYMMDDTHHmmss\");\n\t\t\t\t\tnewreminder.action = reminder.action;\n\t\t\t\t\tif (reminderdate.isValid() && reminder.type === 'DATE-TIME') {\n\t\t\t\t\t\treminderdate.hour(date.hour()).minute(date.minute());\n\t\t\t\t\t} else {\n\t\t\t\t\t\treminderdate = date;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treminderdate = date;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnewreminder.date = reminderdate.format('YYYYMMDDTHHmmss');\n\t\t\tthis._$tasksmodel.setReminder(taskID, newreminder);\n\t\t\treturn this._persistence.setReminder(taskID, newreminder);\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.setReminder = function (taskID) {\n\t\t\tvar reminder;\n\t\t\tif (this.checkReminderDate(taskID)) {\n\t\t\t\treminder = this._$tasksmodel.getById(taskID).reminder;\n\t\t\t\treturn this._persistence.setReminder(taskID, reminder);\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.checkReminderDate = function (taskID) {\n\t\t\tvar d, date, duration, rel, related, reminder, seg, task, token;\n\t\t\ttask = this._$tasksmodel.getById(taskID);\n\t\t\treminder = task.reminder;\n\t\t\tif (reminder !== null && reminder.type === 'DURATION') {\n\t\t\t\tif (!reminder.duration) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else if (reminder.duration.params.related === 'START') {\n\t\t\t\t\ttoken = 'start';\n\t\t\t\t} else if (reminder.duration.params.related === 'END') {\n\t\t\t\t\ttoken = 'due';\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tdate = moment(task[token], \"YYYYMMDDTHHmmss\");\n\t\t\t\tduration = reminder.duration;\n\t\t\t\td = {\n\t\t\t\t\tw: duration.week,\n\t\t\t\t\td: duration.day,\n\t\t\t\t\th: duration.hour,\n\t\t\t\t\tm: duration.minute,\n\t\t\t\t\ts: duration.second\n\t\t\t\t};\n\t\t\t\tif (duration.params.invert) {\n\t\t\t\t\tdate = date.subtract(d);\n\t\t\t\t} else {\n\t\t\t\t\tdate = date.add(d);\n\t\t\t\t}\n\t\t\t\ttask.reminder.date = date.format('YYYYMMDDTHHmmss');\n\t\t\t} else if (reminder !== null && reminder.type === 'DATE-TIME') {\n\t\t\t\tduration = reminder.duration;\n\t\t\t\tdate = moment(reminder.date, \"YYYYMMDDTHHmmss\");\n\t\t\t\tif (!date.isValid()) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (duration) {\n\t\t\t\t\tif (duration.params.related === 'START') {\n\t\t\t\t\t\trelated = moment(task.start, \"YYYYMMDDTHHmmss\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\trelated = moment(task.due, \"YYYYMMDDTHHmmss\");\n\t\t\t\t\t}\n\t\t\t\t\tseg = this.secondsToSegments(date.diff(related, 'seconds'));\n\t\t\t\t\tduration.params.invert = seg.invert;\n\t\t\t\t\tduration.token = 'week';\n\t\t\t\t\tduration.week = seg.week;\n\t\t\t\t\tduration.day = seg.day;\n\t\t\t\t\tduration.hour = seg.hour;\n\t\t\t\t\tduration.minute = seg.minute;\n\t\t\t\t\tduration.second = seg.second;\n\t\t\t\t} else {\n\t\t\t\t\tif (task.start) {\n\t\t\t\t\t\trelated = moment(task.start, \"YYYYMMDDTHHmmss\");\n\t\t\t\t\t\trel = 'START';\n\t\t\t\t\t\td = 0;\n\t\t\t\t\t} else if (task.due) {\n\t\t\t\t\t\trelated = moment(task.due, \"YYYYMMDDTHHmmss\");\n\t\t\t\t\t\trel = 'END';\n\t\t\t\t\t\td = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tseg = this.secondsToSegments(date.diff(related, 'seconds'));\n\t\t\t\t\treminder.duration = {\n\t\t\t\t\t\ttoken: 'week',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\trelated: rel,\n\t\t\t\t\t\t\tinvert: seg.invert,\n\t\t\t\t\t\t\tid: +seg.invert + '' + d\n\t\t\t\t\t\t},\n\t\t\t\t\t\tweek: seg.week,\n\t\t\t\t\t\tday: seg.day,\n\t\t\t\t\t\thour: seg.hour,\n\t\t\t\t\t\tminute: seg.minute,\n\t\t\t\t\t\tsecond: seg.second\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.secondsToSegments = function (s) {\n\t\t\tvar d, h, i, m, w;\n\t\t\tif (s < 0) {\n\t\t\t\ts *= -1;\n\t\t\t\ti = true;\n\t\t\t} else {\n\t\t\t\ti = false;\n\t\t\t}\n\t\t\tw = Math.floor(s / 604800);\n\t\t\ts -= w * 604800;\n\t\t\td = Math.floor(s / 86400);\n\t\t\ts -= d * 86400;\n\t\t\th = Math.floor(s / 3600);\n\t\t\ts -= h * 3600;\n\t\t\tm = Math.floor(s / 60);\n\t\t\ts -= m * 60;\n\t\t\treturn {\n\t\t\t\tweek: w,\n\t\t\t\tday: d,\n\t\t\t\thour: h,\n\t\t\t\tminute: m,\n\t\t\t\tsecond: s,\n\t\t\t\tinvert: i\n\t\t\t};\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.deleteReminderDate = function (taskID) {\n\t\t\tthis._$tasksmodel.setReminder(taskID, null);\n\t\t\treturn this._persistence.setReminder(taskID, false);\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.changeCalendar = function (task, newCalendar) {\n\t\t\tif (task.calendar !== newCalendar && newCalendar.writable) {\n\t\t\t\tvar newTask = angular.copy(task);\n\t\t\t\tnewTask.calendar = newCalendar;\n\t\t\t\tif (!TasksModel.hasNoParent(newTask)) {\n\t\t\t\t\tvar parent = TasksModel.getByUid(newTask.related);\n\t\t\t\t\tif (parent.calendar.uri !== newTask.calendar.uri) {\n\t\t\t\t\t\tnewTask.related = null;\n\t\t\t\t\t\tTasksBusinessLayer.prototype.setPercentComplete(newTask, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn VTodoService.create(newCalendar, newTask.data).then(function (newVTodo) {\n\t\t\t\t\tvar vTodo = new VTodo(newVTodo.calendar, newVTodo.properties, newVTodo.uri);\n\t\t\t\t\tTasksModel.ad(vTodo);\n\t\t\t\t\treturn VTodoService[\"delete\"](task).then(function () {\n\t\t\t\t\t\tTasksModel[\"delete\"](task);\n\t\t\t\t\t\tvar queries = [];\n\t\t\t\t\t\tvar children = TasksModel.getChildren(newTask);\n\t\t\t\t\t\tvar _i, _len, child;\n\t\t\t\t\t\tfor (_i = 0, _len = children.length; _i < _len; _i++) {\n\t\t\t\t\t\t\tchild = children[_i];\n\t\t\t\t\t\t\tif (child.calendar.uri !== newTask.calendar.uri) {\n\t\t\t\t\t\t\t\tqueries.push(TasksBusinessLayer.prototype.changeCalendar(child, newTask.calendar));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn Promise.all(queries);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn Promise.resolve(true);\n\t\t\t}\n\t\t};\n\n\t\t// called from outside\n\t\tTasksBusinessLayer.prototype.changeCollection = function (taskID, collectionID) {\n\t\t\tvar task = this._$tasksmodel.getById(taskID);\n\t\t\tswitch (collectionID) {\n\t\t\t\tcase 'starred':\n\t\t\t\t\ttask.priority = 9;\n\t\t\t\t\treturn this.doUpdate(task);\n\t\t\t\tcase 'completed':\n\t\t\t\t\treturn this.setPercentComplete(task, 100);\n\t\t\t\tcase 'uncompleted':\n\t\t\t\t\tif (task.completed) {\n\t\t\t\t\t\treturn this.setPercentComplete(task, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'today':\n\t\t\t\t\treturn this.setDue(task, moment().startOf('day').add(12, 'h'), 'all');\n\t\t\t\tcase 'week':\n\t\t\t\tcase 'all':\n\t\t\t\t\treturn false;\n\t\t\t\tdefault:\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.changeParent = function (task, parent) {\n\t\t\tif (parent.calendar.writable) {\n\t\t\t\ttask.related = parent.uid;\n\t\t\t\tparent.hideSubtasks = 0;\n\t\t\t\tif (parent.completed && !task.completed) {\n\t\t\t\t\tthis.setPercentComplete(parent, 0);\n\t\t\t\t} else {\n\t\t\t\t\tthis.doUpdate(parent);\n\t\t\t\t}\n\t\t\t\tif (parent.calendar.uri !== task.calendar.uri) {\n\t\t\t\t\tthis.changeCalendar(task, parent.calendar);\n\t\t\t\t} else {\n\t\t\t\t\tthis.doUpdate(task);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.makeRootTask = function (task, newCalendar, collectionID) {\n\t\t\tif (newCalendar.writable) {\n\t\t\t\tvar requests = [];\n\t\t\t\ttask.related = null;\n\t\t\t\tif (collectionID !== \"completed\" && task.completed) {\n\t\t\t\t\ttask.complete = 0;\n\t\t\t\t}\n\t\t\t\trequests.push(this.changeCollection(task.uri, collectionID));\n\t\t\t\tif (task.calendar !== newCalendar) {\n\t\t\t\t\trequests.push(this.changeCalendar(task, newCalendar));\n\t\t\t\t} else {\n\t\t\t\t\trequests.push(this.doUpdate(task));\n\t\t\t\t}\n\t\t\t\treturn requests;\n\t\t\t}\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.addComment = function (comment, onSuccess, onFailure) {\n\t\t\tvar success,\n\t\t\t    _this = this;\n\t\t\tif (!onSuccess) {\n\t\t\t\tonSuccess = function onSuccess() {};\n\t\t\t}\n\t\t\tif (!onFailure) {\n\t\t\t\tonFailure = function onFailure() {};\n\t\t\t}\n\t\t\tthis._$tasksmodel.addComment(comment);\n\t\t\tsuccess = function success(response) {\n\t\t\t\tif (response.status === 'error') {\n\t\t\t\t\treturn onFailure();\n\t\t\t\t} else {\n\t\t\t\t\treturn onSuccess(response.data);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn this._persistence.addComment(comment, success);\n\t\t};\n\n\t\tTasksBusinessLayer.prototype.deleteComment = function (taskID, commentID) {\n\t\t\tthis._$tasksmodel.deleteComment(taskID, commentID);\n\t\t\treturn this._persistence.deleteComment(taskID, commentID);\n\t\t};\n\n\t\treturn TasksBusinessLayer;\n\t}();\n\treturn new TasksBusinessLayer(TasksModel, Persistence, VTodoService, VTodo, $timeout);\n}]);","'use strict';\n\nangular.module('Tasks').factory('Calendar', ['$rootScope', '$filter', '$window', function ($rootScope, $filter, $window) {\n\t'use strict';\n\n\tfunction Calendar(url, props, uri) {\n\t\tvar _this = this;\n\n\t\tprops.color = props['{http://apple.com/ns/ical/}calendar-color'];\n\t\tif (typeof props.color !== 'undefined') {\n\t\t\tif (props.color.length === 9) {\n\t\t\t\tprops.color = props.color.substr(0, 7);\n\t\t\t}\n\t\t} else {\n\t\t\tprops.color = '#1d2d44';\n\t\t}\n\n\t\tangular.extend(this, {\n\t\t\t_propertiesBackup: {},\n\t\t\t_properties: {\n\t\t\t\turl: url,\n\t\t\t\turi: uri,\n\t\t\t\tenabled: props['{http://owncloud.org/ns}calendar-enabled'] === '1',\n\t\t\t\tdisplayname: props['{DAV:}displayname'] || t('tasks', 'Unnamed'),\n\t\t\t\tcolor: props.color,\n\t\t\t\torder: parseInt(props['{http://apple.com/ns/ical/}calendar-order']) || 0,\n\t\t\t\tcomponents: {\n\t\t\t\t\tvevent: false,\n\t\t\t\t\tvjournal: false,\n\t\t\t\t\tvtodo: false\n\t\t\t\t},\n\t\t\t\twritable: props.canWrite,\n\t\t\t\tshareable: props.canWrite,\n\t\t\t\tsharedWith: {\n\t\t\t\t\tusers: [],\n\t\t\t\t\tgroups: []\n\t\t\t\t},\n\t\t\t\towner: '',\n\t\t\t\tloadedCompleted: false\n\t\t\t},\n\t\t\t_updatedProperties: []\n\t\t});\n\t\tthis._propertiesBackup = angular.copy(this._properties);\n\n\t\t// angular.extend(this, {\n\t\t// \ttmpId: null,\n\t\t// \tfcEventSource: {\n\t\t// \t\tevents: function (start, end, timezone, callback) {\n\t\t// \t\t\t// console.log('querying events ...');\n\t\t// \t\t\t// TimezoneService.get(timezone).then(function(tz) {\n\t\t// \t\t\t// \t_this.list.loading = true;\n\t\t// \t\t\t// \t$rootScope.$broadcast('reloadCalendarList');\n\n\t\t// \t\t\t// \tVEventService.getAll(_this, start, end).then(function(events) {\n\t\t// \t\t\t// \t\tvar vevents = [];\n\t\t// \t\t\t// \t\tfor (var i = 0; i < events.length; i++) {\n\t\t// \t\t\t// \t\t\tvevents = vevents.concat(events[i].getFcEvent(start, end, tz));\n\t\t// \t\t\t// \t\t}\n\n\t\t// \t\t\t// \t\tcallback(vevents);\n\n\t\t// \t\t\t// \t\t_this.list.loading = false;\n\t\t// \t\t\t// \t\t$rootScope.$broadcast('reloadCalendarList');\n\t\t// \t\t\t// \t});\n\t\t// \t\t\t// });\n\t\t// \t\t},\n\t\t// \t\teditable: this._properties.writable,\n\t\t// \t\tcalendar: this\n\t\t// \t},\n\t\t// \tlist: {\n\t\t// \t\tedit: false,\n\t\t// \t\tloading: this.enabled,\n\t\t// \t\tlocked: false,\n\t\t// \t\teditingShares: false\n\t\t// \t}\n\t\t// });\n\n\t\tvar components = props['{urn:ietf:params:xml:ns:caldav}supported-calendar-component-set'];\n\t\tfor (var i = 0; i < components.length; i++) {\n\t\t\tvar name = components[i].attributes.getNamedItem('name').textContent.toLowerCase();\n\t\t\tif (this._properties.components.hasOwnProperty(name)) {\n\t\t\t\tthis._properties.components[name] = true;\n\t\t\t}\n\t\t}\n\n\t\tvar shares = props['{http://owncloud.org/ns}invite'];\n\t\tif (typeof shares !== 'undefined') {\n\t\t\tfor (var j = 0; j < shares.length; j++) {\n\t\t\t\tvar href = shares[j].getElementsByTagNameNS('DAV:', 'href');\n\t\t\t\tif (href.length === 0) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\thref = href[0].textContent;\n\n\t\t\t\tvar access = shares[j].getElementsByTagNameNS('http://owncloud.org/ns', 'access');\n\t\t\t\tif (access.length === 0) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\taccess = access[0];\n\n\t\t\t\tvar readWrite = access.getElementsByTagNameNS('http://owncloud.org/ns', 'read-write');\n\t\t\t\treadWrite = readWrite.length !== 0;\n\n\t\t\t\tif (href.startsWith('principal:principals/users/')) {\n\t\t\t\t\tthis._properties.sharedWith.users.push({\n\t\t\t\t\t\tid: href.substr(27),\n\t\t\t\t\t\tdisplayname: href.substr(27),\n\t\t\t\t\t\twritable: readWrite\n\t\t\t\t\t});\n\t\t\t\t} else if (href.startsWith('principal:principals/groups/')) {\n\t\t\t\t\tthis._properties.sharedWith.groups.push({\n\t\t\t\t\t\tid: href.substr(28),\n\t\t\t\t\t\tdisplayname: href.substr(28),\n\t\t\t\t\t\twritable: readWrite\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar owner = props['{DAV:}owner'];\n\t\tif (typeof owner !== 'undefined' && owner.length !== 0) {\n\t\t\towner = owner[0].textContent.slice(0, -1);\n\t\t\tif (owner.startsWith('/remote.php/dav/principals/users/')) {\n\t\t\t\tthis._properties.owner = owner.substr(33);\n\t\t\t}\n\t\t}\n\n\t\t// this.tmpId = RandomStringService.generate();\n\t}\n\n\tCalendar.prototype = {\n\t\tget url() {\n\t\t\treturn this._properties.url;\n\t\t},\n\t\tget caldav() {\n\t\t\treturn $window.location.origin + this.url;\n\t\t},\n\t\tget exportUrl() {\n\t\t\tvar url = this.url;\n\t\t\t// cut off last slash to have a fancy name for the ics\n\t\t\tif (url.slice(url.length - 1) === '/') {\n\t\t\t\turl = url.slice(0, url.length - 1);\n\t\t\t}\n\t\t\turl += '?export';\n\t\t\treturn url;\n\t\t},\n\t\tget enabled() {\n\t\t\treturn this._properties.enabled;\n\t\t},\n\t\tget uri() {\n\t\t\treturn this._properties.uri;\n\t\t},\n\t\tget components() {\n\t\t\treturn this._properties.components;\n\t\t},\n\t\tset enabled(enabled) {\n\t\t\tthis._properties.enabled = enabled;\n\t\t\tthis._setUpdated('enabled');\n\t\t},\n\t\tget displayname() {\n\t\t\treturn this._properties.displayname;\n\t\t},\n\t\tset displayname(displayname) {\n\t\t\tthis._properties.displayname = displayname;\n\t\t\tthis._setUpdated('displayname');\n\t\t},\n\t\tget color() {\n\t\t\treturn this._properties.color;\n\t\t},\n\t\tset color(color) {\n\t\t\tthis._properties.color = color;\n\t\t\tthis._setUpdated('color');\n\t\t},\n\t\tget sharedWith() {\n\t\t\treturn this._properties.sharedWith;\n\t\t},\n\t\tset sharedWith(sharedWith) {\n\t\t\tthis._properties.sharedWith = sharedWith;\n\t\t},\n\t\tget textColor() {\n\t\t\tvar color = this.color;\n\t\t\tvar fallbackColor = '#fff';\n\t\t\tvar c;\n\t\t\tswitch (color.length) {\n\t\t\t\tcase 4:\n\t\t\t\t\tc = color.match(/^#([0-9a-f]{3})$/i)[1];\n\t\t\t\t\tif (c) {\n\t\t\t\t\t\treturn this._generateTextColor(parseInt(c.charAt(0), 16) * 0x11, parseInt(c.charAt(1), 16) * 0x11, parseInt(c.charAt(2), 16) * 0x11);\n\t\t\t\t\t}\n\t\t\t\t\treturn fallbackColor;\n\n\t\t\t\tcase 7:\n\t\t\t\tcase 9:\n\t\t\t\t\tvar regex = new RegExp('^#([0-9a-f]{' + (color.length - 1) + '})$', 'i');\n\t\t\t\t\tc = color.match(regex)[1];\n\t\t\t\t\tif (c) {\n\t\t\t\t\t\treturn this._generateTextColor(parseInt(c.substr(0, 2), 16), parseInt(c.substr(2, 2), 16), parseInt(c.substr(4, 2), 16));\n\t\t\t\t\t}\n\t\t\t\t\treturn fallbackColor;\n\n\t\t\t\tdefault:\n\t\t\t\t\treturn fallbackColor;\n\t\t\t}\n\t\t},\n\t\tget order() {\n\t\t\treturn this._properties.order;\n\t\t},\n\t\tset order(order) {\n\t\t\tthis._properties.order = order;\n\t\t\tthis._setUpdated('order');\n\t\t},\n\t\tget writable() {\n\t\t\treturn this._properties.writable;\n\t\t},\n\t\tget shareable() {\n\t\t\treturn this._properties.shareable;\n\t\t},\n\t\tget owner() {\n\t\t\treturn this._properties.owner;\n\t\t},\n\t\tget loadedCompleted() {\n\t\t\treturn this._properties.loadedCompleted;\n\t\t},\n\t\tset loadedCompleted(loadedCompleted) {\n\t\t\tthis._properties.loadedCompleted = loadedCompleted;\n\t\t},\n\t\t_setUpdated: function _setUpdated(propName) {\n\t\t\tif (this._updatedProperties.indexOf(propName) === -1) {\n\t\t\t\tthis._updatedProperties.push(propName);\n\t\t\t}\n\t\t},\n\t\tget updatedProperties() {\n\t\t\treturn this._updatedProperties;\n\t\t},\n\t\tresetUpdatedProperties: function resetUpdatedProperties() {\n\t\t\tthis._updatedProperties = [];\n\t\t},\n\t\tprepareUpdate: function prepareUpdate() {\n\t\t\tthis._propertiesBackup = angular.copy(this._properties);\n\t\t},\n\t\tresetToPreviousState: function resetToPreviousState() {\n\t\t\tthis._properties = angular.copy(this._propertiesBackup);\n\t\t\tthis._propertiesBackup = {};\n\t\t},\n\t\tdropPreviousState: function dropPreviousState() {\n\t\t\tthis._propertiesBackup = {};\n\t\t},\n\t\ttoggleSharesEditor: function toggleSharesEditor() {\n\t\t\tthis.list.editingShares = !this.list.editingShares;\n\t\t},\n\t\t_generateTextColor: function _generateTextColor(r, g, b) {\n\t\t\tvar brightness = (r * 299 + g * 587 + b * 114) / 1000;\n\t\t\treturn brightness > 130 ? '#000000' : '#FAFAFA';\n\t\t}\n\t};\n\n\treturn Calendar;\n}]);","'use strict';\n\n(function () {\n\t'use strict';\n\n\tvar __hasProp = {}.hasOwnProperty,\n\t    __extends = function __extends(child, parent) {\n\t\tfor (var key in parent) {\n\t\t\tif (__hasProp.call(parent, key)) child[key] = parent[key];\n\t\t}function ctor() {\n\t\t\tthis.constructor = child;\n\t\t}ctor.prototype = parent.prototype;child.prototype = new ctor();child.__super__ = parent.prototype;return child;\n\t};\n\n\tangular.module('Tasks').factory('CollectionsModel', ['TasksModel', '_Model', function (TasksModel, _Model) {\n\t\tvar CollectionsModel;\n\t\tCollectionsModel = function (_super) {\n\t\t\t__extends(CollectionsModel, _super);\n\n\t\t\tfunction CollectionsModel(_$tasksmodel) {\n\t\t\t\tthis._$tasksmodel = _$tasksmodel;\n\t\t\t\tthis._nameCache = {};\n\t\t\t\tCollectionsModel.__super__.constructor.call(this);\n\t\t\t}\n\n\t\t\tCollectionsModel.prototype.add = function (data, clearCache) {\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\tthis._nameCache[data.displayname] = data;\n\t\t\t\tif (angular.isDefined(data.id)) {\n\t\t\t\t\treturn CollectionsModel.__super__.add.call(this, data, clearCache);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tCollectionsModel.prototype.getCount = function (collectionID, filter) {\n\t\t\t\tvar count, task, tasks, _i, _len;\n\t\t\t\tif (filter === null) {\n\t\t\t\t\tfilter = '';\n\t\t\t\t}\n\t\t\t\tcount = 0;\n\t\t\t\ttasks = this._$tasksmodel.filteredTasks(filter);\n\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\tcount += this._$tasksmodel.filterTasks(task, collectionID) && !task.related;\n\t\t\t\t}\n\t\t\t\treturn count;\n\t\t\t};\n\n\t\t\treturn CollectionsModel;\n\t\t}(_Model);\n\t\treturn new CollectionsModel(TasksModel);\n\t}]);\n}).call(undefined);","'use strict';\n\n(function () {\n\t'use strict';\n\n\tvar __hasProp = {}.hasOwnProperty,\n\t    __extends = function __extends(child, parent) {\n\t\tfor (var key in parent) {\n\t\t\tif (__hasProp.call(parent, key)) child[key] = parent[key];\n\t\t}function ctor() {\n\t\t\tthis.constructor = child;\n\t\t}ctor.prototype = parent.prototype;child.prototype = new ctor();child.__super__ = parent.prototype;return child;\n\t};\n\n\tangular.module('Tasks').factory('ListsModel', ['TasksModel', '_Model', function (TasksModel, _Model) {\n\t\tvar ListsModel;\n\t\tListsModel = function (_super) {\n\t\t\t__extends(ListsModel, _super);\n\n\t\t\tfunction ListsModel(_$tasksmodel) {\n\t\t\t\tthis._$tasksmodel = _$tasksmodel;\n\t\t\t\tthis._tmpUriCache = {};\n\t\t\t\tthis._data = [];\n\t\t\t\tthis._dataMap = {};\n\t\t\t\tthis._filterCache = {};\n\t\t\t}\n\n\t\t\tListsModel.prototype.add = function (calendar, clearCache) {\n\t\t\t\tvar updateByUri;\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\tupdateByUri = angular.isDefined(calendar.uri) && angular.isDefined(this.getByUri(calendar.uri));\n\t\t\t\tif (updateByUri) {\n\t\t\t\t\treturn this.update(calendar, clearCache);\n\t\t\t\t} else {\n\t\t\t\t\tif (angular.isDefined(calendar.uri)) {\n\t\t\t\t\t\tif (clearCache) {\n\t\t\t\t\t\t\tthis._invalidateCache();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!angular.isDefined(this._dataMap[calendar.uri])) {\n\t\t\t\t\t\t\tthis._data.push(calendar);\n\t\t\t\t\t\t\tthis._dataMap[calendar.uri] = calendar;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tListsModel.prototype.getByUri = function (uri) {\n\t\t\t\treturn this._dataMap[uri];\n\t\t\t};\n\n\t\t\tListsModel.prototype.update = function (list, clearCache) {\n\t\t\t\tvar tmplist;\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\ttmplist = this._tmpIdCache[list.tmpID];\n\t\t\t\tif (angular.isDefined(list.id) && angular.isDefined(tmplist) && angular.isUndefined(tmplist.id)) {\n\t\t\t\t\ttmplist.id = list.id;\n\t\t\t\t\tthis._dataMap[list.id] = tmplist;\n\t\t\t\t}\n\t\t\t\tlist[\"void\"] = false;\n\t\t\t\treturn ListsModel.__super__.update.call(this, list, clearCache);\n\t\t\t};\n\n\t\t\tListsModel.prototype[\"delete\"] = function (calendar, clearCache) {\n\t\t\t\tvar counter, data, entry, _i, _len, _ref;\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\t_ref = this._data;\n\t\t\t\tfor (counter = _i = 0, _len = _ref.length; _i < _len; counter = ++_i) {\n\t\t\t\t\tentry = _ref[counter];\n\t\t\t\t\tif (entry === calendar) {\n\t\t\t\t\t\tthis._data.splice(counter, 1);\n\t\t\t\t\t\tdata = this._dataMap[calendar.uri];\n\t\t\t\t\t\tdelete this._dataMap[calendar.uri];\n\t\t\t\t\t\tif (clearCache) {\n\t\t\t\t\t\t\tthis._invalidateCache();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tListsModel.prototype.getStandardList = function () {\n\t\t\t\tvar calendars;\n\t\t\t\tif (this.size()) {\n\t\t\t\t\tcalendars = this.getAll();\n\t\t\t\t\treturn calendars[0];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tListsModel.prototype.isNameAlreadyTaken = function (displayname, uri) {\n\t\t\t\tvar calendar, calendars, ret, _i, _len;\n\t\t\t\tcalendars = this.getAll();\n\t\t\t\tret = false;\n\t\t\t\tfor (_i = 0, _len = calendars.length; _i < _len; _i++) {\n\t\t\t\t\tcalendar = calendars[_i];\n\t\t\t\t\tif (calendar.displayname === displayname && calendar.uri !== uri) {\n\t\t\t\t\t\tret = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t};\n\n\t\t\tListsModel.prototype.getCount = function (calendarID, collectionID, filter) {\n\t\t\t\tvar count, task, tasks, _i, _len;\n\t\t\t\tif (filter === null) {\n\t\t\t\t\tfilter = '';\n\t\t\t\t}\n\t\t\t\tcount = 0;\n\t\t\t\ttasks = this._$tasksmodel.filteredTasks(filter);\n\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\tcount += this._$tasksmodel.filterTasks(task, collectionID) && task.calendar.uri === calendarID && !task.related;\n\t\t\t\t}\n\t\t\t\t//  if (collectionID === 'completed' && filter === '') {\n\t\t\t\t// count += this.notLoaded(calendarID);\n\t\t\t\t//  }\n\t\t\t\treturn count;\n\t\t\t};\n\n\t\t\tListsModel.prototype.loadedCompleted = function (calendarID) {\n\t\t\t\tif (angular.isUndefined(this.getById(calendarID))) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\treturn this.getById(calendarID).loadedCompleted;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tListsModel.prototype.setLoadedCompleted = function (calendarID) {\n\t\t\t\tthis.getById(calendarID).loadedCompleted = true;\n\t\t\t};\n\n\t\t\tListsModel.prototype.getColor = function (calendarID) {\n\t\t\t\tif (angular.isUndefined(this.getById(calendarID))) {\n\t\t\t\t\treturn '#CCCCCC';\n\t\t\t\t} else {\n\t\t\t\t\treturn this.getById(calendarID).calendarcolor;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tListsModel.prototype.getName = function (calendarID) {\n\t\t\t\tif (angular.isUndefined(this.getById(calendarID))) {\n\t\t\t\t\treturn '';\n\t\t\t\t} else {\n\t\t\t\t\treturn this.getById(calendarID).displayname;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn ListsModel;\n\t\t}(_Model);\n\t\treturn new ListsModel(TasksModel);\n\t}]);\n}).call(undefined);","'use strict';\n\n(function () {\n\t'use strict';\n\n\tvar __hasProp = {}.hasOwnProperty,\n\t    __extends = function __extends(child, parent) {\n\t\tfor (var key in parent) {\n\t\t\tif (__hasProp.call(parent, key)) child[key] = parent[key];\n\t\t}function ctor() {\n\t\t\tthis.constructor = child;\n\t\t}ctor.prototype = parent.prototype;child.prototype = new ctor();child.__super__ = parent.prototype;return child;\n\t};\n\n\tangular.module('Tasks').factory('SettingsModel', ['_Model', function (_Model) {\n\t\tvar SettingsModel;\n\t\tSettingsModel = function (_super) {\n\t\t\t__extends(SettingsModel, _super);\n\n\t\t\tfunction SettingsModel() {\n\t\t\t\tthis._nameCache = {};\n\t\t\t\tSettingsModel.__super__.constructor.call(this);\n\t\t\t}\n\n\t\t\tSettingsModel.prototype.add = function (data, clearCache) {\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\tthis._nameCache[data.displayname] = data;\n\t\t\t\tif (angular.isDefined(data.id)) {\n\t\t\t\t\treturn SettingsModel.__super__.add.call(this, data, clearCache);\n\t\t\t\t} else {\n\t\t\t\t\treturn this._data.push(data);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tSettingsModel.prototype.toggle = function (type, setting) {\n\t\t\t\tvar set;\n\t\t\t\tset = this.getById(type);\n\t\t\t\tthis.getById(type)[setting] = !set[setting];\n\t\t\t};\n\n\t\t\treturn SettingsModel;\n\t\t}(_Model);\n\t\treturn new SettingsModel();\n\t}]);\n}).call(undefined);","'use strict';\n\n(function () {\n\t'use strict';\n\n\tvar __hasProp = {}.hasOwnProperty,\n\t    __extends = function __extends(child, parent) {\n\t\tfor (var key in parent) {\n\t\t\tif (__hasProp.call(parent, key)) child[key] = parent[key];\n\t\t}function ctor() {\n\t\t\tthis.constructor = child;\n\t\t}ctor.prototype = parent.prototype;child.prototype = new ctor();child.__super__ = parent.prototype;return child;\n\t},\n\t    __indexOf = [].indexOf || function (item) {\n\t\tfor (var i = 0, l = this.length; i < l; i++) {\n\t\t\tif (i in this && this[i] === item) return i;\n\t\t}return -1;\n\t};\n\n\tangular.module('Tasks').factory('TasksModel', ['_Model', function (_Model) {\n\t\tvar TasksModel = function (_super) {\n\t\t\t__extends(TasksModel, _super);\n\n\t\t\tfunction TasksModel() {\n\t\t\t\tthis._tmpIdCache = {};\n\t\t\t\tTasksModel.__super__.constructor.call(this);\n\t\t\t}\n\n\t\t\tTasksModel.prototype.ad = function (task, clearCache) {\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\tvar updateByUri = angular.isDefined(task.uri) && angular.isDefined(this.getByUri(task.uri));\n\t\t\t\tif (updateByUri) {\n\t\t\t\t\treturn this.update(task, clearCache);\n\t\t\t\t} else {\n\t\t\t\t\tif (angular.isDefined(task.uri)) {\n\t\t\t\t\t\tif (clearCache) {\n\t\t\t\t\t\t\tthis._invalidateCache();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!angular.isDefined(this._dataMap[task.uri])) {\n\t\t\t\t\t\t\tthis._data.push(task);\n\t\t\t\t\t\t\tthis._dataMap[task.uri] = task;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tTasksModel.prototype.getByUri = function (uri) {\n\t\t\t\treturn this._dataMap[uri];\n\t\t\t};\n\n\t\t\tTasksModel.prototype.update = function (task, clearCache) {\n\n\t\t\t\tvar entry, key, value, _results;\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\tif (clearCache) {\n\t\t\t\t\tthis._invalidateCache();\n\t\t\t\t}\n\t\t\t\tentry = this.getByUri(task.uri);\n\t\t\t\tentry.components = task.components;\n\t\t\t\tentry.components.toString();\n\t\t\t\treturn entry;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.removeById = function (taskID) {\n\t\t\t\treturn TasksModel.__super__.removeById.call(this, taskID);\n\t\t\t};\n\n\t\t\tTasksModel.prototype[\"delete\"] = function (task, clearCache) {\n\t\t\t\tvar counter, data, entry, _i, _len, _ref;\n\t\t\t\tif (clearCache === null) {\n\t\t\t\t\tclearCache = true;\n\t\t\t\t}\n\t\t\t\t_ref = this._data;\n\t\t\t\tfor (counter = _i = 0, _len = _ref.length; _i < _len; counter = ++_i) {\n\t\t\t\t\tentry = _ref[counter];\n\t\t\t\t\tif (entry === task) {\n\t\t\t\t\t\tthis._data.splice(counter, 1);\n\t\t\t\t\t\tdata = this._dataMap[task.uri];\n\t\t\t\t\t\tdelete this._dataMap[task.uri];\n\t\t\t\t\t\tif (clearCache) {\n\t\t\t\t\t\t\tthis._invalidateCache();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tTasksModel.prototype.removeByList = function (listID) {\n\t\t\t\tvar id, task, taskIDs, tasks, _i, _j, _len, _len1, _results;\n\t\t\t\ttasks = this.getAll();\n\t\t\t\ttaskIDs = [];\n\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\tif (task.calendarid === listID) {\n\t\t\t\t\t\ttaskIDs.push(task.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t_results = [];\n\t\t\t\tfor (_j = 0, _len1 = taskIDs.length; _j < _len1; _j++) {\n\t\t\t\t\tid = taskIDs[_j];\n\t\t\t\t\t_results.push(this.removeById(id));\n\t\t\t\t}\n\t\t\t\treturn _results;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.taskAtDay = function (task, date) {\n\t\t\t\tvar diff, due, duediff, start, startdiff;\n\t\t\t\tstart = moment(task.start, \"YYYYMMDDTHHmmss\");\n\t\t\t\tdue = moment(task.due, \"YYYYMMDDTHHmmss\");\n\t\t\t\tif (start.isValid() && !due.isValid()) {\n\t\t\t\t\tdiff = start.diff(moment().startOf('day'), 'days', true);\n\t\t\t\t\tif (!date && diff < date + 1) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if (diff < date + 1 && diff >= date) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (due.isValid() && !start.isValid()) {\n\t\t\t\t\tdiff = due.diff(moment().startOf('day'), 'days', true);\n\t\t\t\t\tif (!date && diff < date + 1) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if (diff < date + 1 && diff >= date) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (start.isValid() && due.isValid()) {\n\t\t\t\t\tstartdiff = start.diff(moment().startOf('day'), 'days', true);\n\t\t\t\t\tduediff = due.diff(moment().startOf('day'), 'days', true);\n\t\t\t\t\tif (!date && (startdiff < date + 1 || duediff < date + 1)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if (startdiff < date + 1 && startdiff >= date && duediff >= date) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if (duediff < date + 1 && duediff >= date && startdiff >= date) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.isLoaded = function (task) {\n\t\t\t\tif (this.getById(task.id)) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tTasksModel.prototype.hasSubtasks = function (uid) {\n\t\t\t\tvar task, tasks, _i, _len;\n\t\t\t\ttasks = this.getAll();\n\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\tif (task.related === uid) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.hasCompletedSubtasks = function (uid) {\n\t\t\t\tvar task, tasks, _i, _len;\n\t\t\t\ttasks = this.getAll();\n\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\tif (task.related === uid && task.completed) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.hasNoParent = function (task) {\n\t\t\t\tvar t, tasks, _i, _len;\n\t\t\t\tif (!task.related) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\ttasks = this.getAll();\n\t\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\t\tt = tasks[_i];\n\t\t\t\t\t\tif (task.related === t.uid && task !== t) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tTasksModel.prototype.getIdByUid = function (uid) {\n\t\t\t\tvar task, tasks, _i, _len;\n\t\t\t\ttasks = this.getAll();\n\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\tif (task.uid === uid) {\n\t\t\t\t\t\treturn task.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.getByUid = function (uid) {\n\t\t\t\tvar task, tasks, _i, _len;\n\t\t\t\ttasks = this.getAll();\n\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\tif (task.uid === uid) {\n\t\t\t\t\t\treturn task;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.getChildren = function (task) {\n\t\t\t\tvar children, t, tasks, _i, _len;\n\t\t\t\ttasks = this.getAll();\n\t\t\t\tchildren = [];\n\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\tt = tasks[_i];\n\t\t\t\t\tif (t.related === task.uid && t !== task) {\n\t\t\t\t\t\tchildren.push(t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn children;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.getDescendantIDs = function (task) {\n\t\t\t\tvar child, children, descendantIDs, _i, _len;\n\t\t\t\tchildren = this.getChildren(task);\n\t\t\t\tdescendantIDs = [];\n\t\t\t\tfor (_i = 0, _len = children.length; _i < _len; _i++) {\n\t\t\t\t\tchild = children[_i];\n\t\t\t\t\tdescendantIDs = descendantIDs.concat(child.uri);\n\t\t\t\t\tdescendantIDs = descendantIDs.concat(this.getDescendantIDs(child));\n\t\t\t\t}\n\t\t\t\treturn descendantIDs;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.filterTasks = function (task, filter) {\n\t\t\t\tswitch (filter) {\n\t\t\t\t\tcase 'completed':\n\t\t\t\t\t\treturn task.completed === true;\n\t\t\t\t\tcase 'all':\n\t\t\t\t\t\treturn task.completed === false;\n\t\t\t\t\tcase 'current':\n\t\t\t\t\t\treturn task.completed === false && this.current(task.start, task.due);\n\t\t\t\t\tcase 'starred':\n\t\t\t\t\t\treturn task.completed === false && task.priority > 5;\n\t\t\t\t\tcase 'today':\n\t\t\t\t\t\treturn task.completed === false && (this.today(task.start) || this.today(task.due));\n\t\t\t\t\tcase 'week':\n\t\t\t\t\t\treturn task.completed === false && (this.week(task.start) || this.week(task.due));\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn '' + task.calendar.uri === '' + filter;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tTasksModel.prototype.filteredTasks = function (needle) {\n\t\t\t\tvar ancestors, parentID, ret, task, tasks, _i, _len;\n\t\t\t\tret = [];\n\t\t\t\ttasks = this.getAll();\n\t\t\t\tif (!needle) {\n\t\t\t\t\tret = tasks;\n\t\t\t\t} else {\n\t\t\t\t\tfor (_i = 0, _len = tasks.length; _i < _len; _i++) {\n\t\t\t\t\t\ttask = tasks[_i];\n\t\t\t\t\t\tif (this.filterTasksByString(task, needle)) {\n\t\t\t\t\t\t\tif (this.objectExists(task, ret)) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tret.push(task);\n\t\t\t\t\t\t\tparentID = this.getIdByUid(task.related);\n\t\t\t\t\t\t\tancestors = this.getAncestor(parentID, ret);\n\t\t\t\t\t\t\tif (ancestors) {\n\t\t\t\t\t\t\t\tret = ret.concat(ancestors);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.objectExists = function (task, ret) {\n\t\t\t\tvar re, _i, _len;\n\t\t\t\tfor (_i = 0, _len = ret.length; _i < _len; _i++) {\n\t\t\t\t\tre = ret[_i];\n\t\t\t\t\tif (re.id === task.id) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.filterTasksByString = function (task, filter) {\n\t\t\t\tvar category, comment, key, keys, value, _i, _j, _len, _len1, _ref, _ref1;\n\t\t\t\tkeys = ['name', 'note', 'location', 'categories', 'comments'];\n\t\t\t\tfilter = filter.toLowerCase();\n\t\t\t\tfor (key in task) {\n\t\t\t\t\tvalue = task[key];\n\t\t\t\t\tif (__indexOf.call(keys, key) >= 0) {\n\t\t\t\t\t\tif (key === 'comments') {\n\t\t\t\t\t\t\t_ref = task.comments;\n\t\t\t\t\t\t\tfor (_i = 0, _len = _ref.length; _i < _len; _i++) {\n\t\t\t\t\t\t\t\tcomment = _ref[_i];\n\t\t\t\t\t\t\t\tif (comment.comment.toLowerCase().indexOf(filter) !== -1) {\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (key === 'categories') {\n\t\t\t\t\t\t\t_ref1 = task.categories;\n\t\t\t\t\t\t\tfor (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n\t\t\t\t\t\t\t\tcategory = _ref1[_j];\n\t\t\t\t\t\t\t\tif (category.toLowerCase().indexOf(filter) !== -1) {\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (value.toLowerCase().indexOf(filter) !== -1) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.setReminder = function (taskID, reminder) {\n\t\t\t\treturn this.update({\n\t\t\t\t\tid: taskID,\n\t\t\t\t\treminder: reminder\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tTasksModel.prototype.overdue = function (due) {\n\t\t\t\treturn moment(due, \"YYYYMMDDTHHmmss\").isValid() && moment(due, \"YYYYMMDDTHHmmss\").diff(moment()) < 0;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.due = function (due) {\n\t\t\t\treturn moment(due, 'YYYYMMDDTHHmmss').isValid();\n\t\t\t};\n\n\t\t\tTasksModel.prototype.today = function (due) {\n\t\t\t\treturn moment(due, \"YYYYMMDDTHHmmss\").isValid() && moment(due, \"YYYYMMDDTHHmmss\").diff(moment().startOf('day'), 'days', true) < 1;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.week = function (due) {\n\t\t\t\treturn moment(due, \"YYYYMMDDTHHmmss\").isValid() && moment(due, \"YYYYMMDDTHHmmss\").diff(moment().startOf('day'), 'days', true) < 7;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.current = function (start, due) {\n\t\t\t\treturn !moment(start, \"YYYYMMDDTHHmmss\").isValid() || moment(start, \"YYYYMMDDTHHmmss\").diff(moment(), 'days', true) < 0 || moment(due, \"YYYYMMDDTHHmmss\").diff(moment(), 'days', true) < 0;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.addComment = function (comment) {\n\t\t\t\tvar task;\n\t\t\t\ttask = this.getById(comment.taskID);\n\t\t\t\tif (task.comments) {\n\t\t\t\t\ttask.comments.push(comment);\n\t\t\t\t} else {\n\t\t\t\t\ttask.comments = [comment];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tTasksModel.prototype.updateComment = function (comment) {\n\t\t\t\tvar com, i, task, _i, _len, _ref, _results;\n\t\t\t\ttask = this.getById(comment.taskID);\n\t\t\t\ti = 0;\n\t\t\t\t_ref = task.comments;\n\t\t\t\t_results = [];\n\t\t\t\tfor (_i = 0, _len = _ref.length; _i < _len; _i++) {\n\t\t\t\t\tcom = _ref[_i];\n\t\t\t\t\tif (com.tmpID === comment.tmpID) {\n\t\t\t\t\t\ttask.comments[i] = comment;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t_results.push(i++);\n\t\t\t\t}\n\t\t\t\treturn _results;\n\t\t\t};\n\n\t\t\tTasksModel.prototype.deleteComment = function (taskID, commentID) {\n\t\t\t\tvar comment, i, task, _i, _len, _ref, _results;\n\t\t\t\ttask = this.getById(taskID);\n\t\t\t\ti = 0;\n\t\t\t\t_ref = task.comments;\n\t\t\t\t_results = [];\n\t\t\t\tfor (_i = 0, _len = _ref.length; _i < _len; _i++) {\n\t\t\t\t\tcomment = _ref[_i];\n\t\t\t\t\tif (comment.id === commentID) {\n\t\t\t\t\t\ttask.comments.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t_results.push(i++);\n\t\t\t\t}\n\t\t\t\treturn _results;\n\t\t\t};\n\n\t\t\treturn TasksModel;\n\t\t}(_Model);\n\t\treturn new TasksModel();\n\t}]);\n}).call(undefined);","'use strict';\n\nangular.module('Tasks').factory('VTodo', ['$filter', 'ICalFactory', 'RandomStringService', function ($filter, icalfactory, RandomStringService) {\n\t'use strict';\n\n\tfunction VTodo(calendar, props, uri) {\n\t\tvar _this = this;\n\n\t\tangular.extend(this, {\n\t\t\tcalendar: calendar,\n\t\t\tdata: props['{urn:ietf:params:xml:ns:caldav}calendar-data'],\n\t\t\turi: uri,\n\t\t\tetag: props['{DAV:}getetag'] || null,\n\t\t\ttimers: [],\n\t\t\tloaded: false\n\t\t});\n\n\t\tthis.jCal = ICAL.parse(this.data);\n\t\tthis.components = new ICAL.Component(this.jCal);\n\n\t\tif (this.components.jCal.length === 0) {\n\t\t\tthrow \"invalid calendar\";\n\t\t}\n\t}\n\n\tVTodo.prototype = {\n\t\tget summary() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\treturn vtodos[0].getFirstPropertyValue('summary');\n\t\t},\n\t\tset summary(summary) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvtodos[0].updatePropertyWithValue('summary', summary);\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget priority() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvar priority = vtodos[0].getFirstPropertyValue('priority');\n\t\t\treturn (10 - priority) % 10;\n\t\t},\n\t\tset priority(priority) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvtodos[0].updatePropertyWithValue('priority', (10 - priority) % 10);\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget complete() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\treturn vtodos[0].getFirstPropertyValue('percent-complete') || 0;\n\t\t},\n\t\tset complete(complete) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvtodos[0].updatePropertyWithValue('percent-complete', complete);\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t\tif (complete < 100) {\n\t\t\t\tthis.completed = null;\n\t\t\t\tif (complete === 0) {\n\t\t\t\t\tthis.status = 'NEEDS-ACTION';\n\t\t\t\t} else {\n\t\t\t\t\tthis.status = 'IN-PROCESS';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.completed = ICAL.Time.now();\n\t\t\t\tthis.status = 'COMPLETED';\n\t\t\t}\n\t\t},\n\t\tget completed() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvar comp = vtodos[0].getFirstPropertyValue('completed');\n\t\t\tif (comp) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tset completed(completed) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tif (completed) {\n\t\t\t\tvtodos[0].updatePropertyWithValue('completed', completed);\n\t\t\t} else {\n\t\t\t\tvtodos[0].removeProperty('completed');\n\t\t\t}\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget completed_date() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvar comp = vtodos[0].getFirstPropertyValue('completed');\n\t\t\tif (comp) {\n\t\t\t\treturn comp.toJSDate();\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\tget status() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\treturn vtodos[0].getFirstPropertyValue('status');\n\t\t},\n\t\tset status(status) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvtodos[0].updatePropertyWithValue('status', status);\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget note() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\treturn vtodos[0].getFirstPropertyValue('description') || '';\n\t\t},\n\t\tset note(note) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvtodos[0].updatePropertyWithValue('description', note);\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget uid() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\treturn vtodos[0].getFirstPropertyValue('uid') || '';\n\t\t},\n\t\tget related() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\treturn vtodos[0].getFirstPropertyValue('related-to') || null;\n\t\t},\n\t\tset related(related) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tif (related) {\n\t\t\t\tvtodos[0].updatePropertyWithValue('related-to', related);\n\t\t\t} else {\n\t\t\t\tvtodos[0].removeProperty('related-to');\n\t\t\t}\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget hideSubtasks() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\treturn +vtodos[0].getFirstPropertyValue('x-oc-hidesubtasks') || 0;\n\t\t},\n\t\tset hideSubtasks(hide) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvtodos[0].updatePropertyWithValue('x-oc-hidesubtasks', +hide);\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget hideCompletedSubtasks() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\treturn +vtodos[0].getFirstPropertyValue('x-oc-hidecompletedsubtasks') || 0;\n\t\t},\n\t\tset hideCompletedSubtasks(hide) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvtodos[0].updatePropertyWithValue('x-oc-hidecompletedsubtasks', +hide);\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget reminder() {\n\t\t\treturn null;\n\t\t},\n\t\tget categories() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvar categories = vtodos[0].getFirstProperty('categories');\n\t\t\tif (categories) {\n\t\t\t\treturn categories.getValues();\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t},\n\t\tset categories(cats) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvar categories = vtodos[0].getFirstProperty('categories');\n\t\t\tif (cats.length > 0) {\n\t\t\t\tif (categories) {\n\t\t\t\t\tcategories.setValues(cats);\n\t\t\t\t} else {\n\t\t\t\t\tvar prop = new ICAL.Property('categories');\n\t\t\t\t\tprop.setValues(cats);\n\t\t\t\t\tcategories = vtodos[0].addProperty(prop);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvtodos[0].removeProperty('categories');\n\t\t\t}\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget start() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\treturn vtodos[0].getFirstPropertyValue('dtstart');\n\t\t},\n\t\tset start(start) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tif (start) {\n\t\t\t\tvtodos[0].updatePropertyWithValue('dtstart', start);\n\t\t\t} else {\n\t\t\t\tvtodos[0].removeProperty('dtstart');\n\t\t\t}\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget due() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\treturn vtodos[0].getFirstPropertyValue('due');\n\t\t},\n\t\tset due(due) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tif (due) {\n\t\t\t\tvtodos[0].updatePropertyWithValue('due', due);\n\t\t\t} else {\n\t\t\t\tvtodos[0].removeProperty('due');\n\t\t\t}\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget allDay() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvar start = vtodos[0].getFirstPropertyValue('dtstart');\n\t\t\tvar due = vtodos[0].getFirstPropertyValue('due');\n\t\t\tvar d = due ? due : start;\n\t\t\treturn d != null && d.isDate;\n\t\t},\n\t\tset allDay(allDay) {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvar start = vtodos[0].getFirstPropertyValue('dtstart');\n\t\t\tif (start) {\n\t\t\t\tstart.isDate = allDay;\n\t\t\t\tvtodos[0].updatePropertyWithValue('dtstart', start);\n\t\t\t}\n\t\t\tvar due = vtodos[0].getFirstPropertyValue('due');\n\t\t\tif (due) {\n\t\t\t\tdue.isDate = allDay;\n\t\t\t\tvtodos[0].updatePropertyWithValue('due', due);\n\t\t\t}\n\t\t\tthis.updateLastModified();\n\t\t\tthis.data = this.components.toString();\n\t\t},\n\t\tget comments() {\n\t\t\treturn null;\n\t\t},\n\t\tget loadedCompleted() {\n\t\t\treturn this.loaded;\n\t\t},\n\t\tset loadedCompleted(loadedCompleted) {\n\t\t\tthis.loaded = loadedCompleted;\n\t\t},\n\t\tupdateLastModified: function updateLastModified() {\n\t\t\tvar vtodos = this.components.getAllSubcomponents('vtodo');\n\t\t\tvtodos[0].updatePropertyWithValue('last-modified', ICAL.Time.now());\n\t\t\tvtodos[0].updatePropertyWithValue('dtstamp', ICAL.Time.now());\n\t\t}\n\t};\n\n\tVTodo.create = function (task) {\n\t\tvar comp = icalfactory.new();\n\n\t\tvar vtodo = new ICAL.Component('vtodo');\n\t\tcomp.addSubcomponent(vtodo);\n\t\tvtodo.updatePropertyWithValue('created', ICAL.Time.now());\n\t\tvtodo.updatePropertyWithValue('dtstamp', ICAL.Time.now());\n\t\tvtodo.updatePropertyWithValue('last-modified', ICAL.Time.now());\n\t\tvtodo.updatePropertyWithValue('uid', RandomStringService.generate());\n\t\tvtodo.updatePropertyWithValue('summary', task.summary);\n\t\tvtodo.updatePropertyWithValue('priority', task.priority);\n\t\tvtodo.updatePropertyWithValue('percent-complete', task.complete);\n\t\tvtodo.updatePropertyWithValue('x-oc-hidesubtasks', 0);\n\t\tif (task.related) {\n\t\t\tvtodo.updatePropertyWithValue('related-to', task.related);\n\t\t}\n\t\tif (task.note) {\n\t\t\tvtodo.updatePropertyWithValue('description', task.note);\n\t\t}\n\t\tif (task.due) {\n\t\t\tvtodo.updatePropertyWithValue('due', task.due);\n\t\t}\n\t\tif (task.start) {\n\t\t\tvtodo.updatePropertyWithValue('dtstart', task.start);\n\t\t}\n\n\t\treturn new VTodo(task.calendar, {\n\t\t\t'{urn:ietf:params:xml:ns:caldav}calendar-data': comp.toString(),\n\t\t\t'{DAV:}getetag': null\n\t\t}, null);\n\t};\n\n\treturn VTodo;\n}]);"]}